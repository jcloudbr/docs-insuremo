{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Documenta\u00e7\u00e3o \u2014 Coinsurance","text":"<p>Bem-vindo(a) ao reposit\u00f3rio de documenta\u00e7\u00e3o do fluxo de Coinsurance.</p>"},{"location":"#onde-comecar","title":"Onde come\u00e7ar","text":"<ul> <li>Coinsurance \u2192 Vis\u00e3o geral do fluxo: vis\u00e3o macro dos arquivos e etapas</li> <li>Coinsurance \u2192 Ap\u00f3lice: emiss\u00e3o/endosso (PREMIT, PREMREC, PREMRECEB, RESPREM)</li> <li>Coinsurance \u2192 Sinistro: aviso, pend\u00eancia e pagamento (SINAV, SINPEND, SINPAG)</li> </ul>"},{"location":"#convencoes-do-repositorios","title":"Conven\u00e7\u00f5es do reposit\u00f3rios","text":"<ul> <li>Este reposit\u00f3rio n\u00e3o inclui os validadores OPA/Velora (mantidos em outro repo).</li> <li>Sempre que poss\u00edvel, o De/Para \u00e9 gerado a partir do c\u00f3digo-fonte (services + entities).</li> </ul>"},{"location":"coinsurance/","title":"Coinsurance \u2014 Vis\u00e3o geral do fluxo","text":""},{"location":"coinsurance/#estrutura-macro-dos-arquivos","title":"Estrutura macro dos arquivos","text":"<ul> <li>Ap\u00f3lice: PREMIT, PREMREC, PREMRECEB, RESPREM</li> <li>Sinistro: SINAV, SINPEND, SINPAG</li> <li>Retornos (RO BMG): PREMAC, PREMRECAC, PREMRECEBC, SINAVAC, SINPENDAC, SINPAGAC</li> </ul>"},{"location":"coinsurance/apolice/","title":"Ap\u00f3lice \u2014 Vis\u00e3o geral (Coinsurance)","text":"<p>Esta se\u00e7\u00e3o descreve o ciclo de Pr\u00eamio do cosseguro, do ponto de vista do aceito (BMG), desde a emiss\u00e3o/endosso da ap\u00f3lice definitiva at\u00e9 recebimento e reserva mensal (PPNG).</p>"},{"location":"coinsurance/apolice/#o-que-entra-e-o-que-sai","title":"O que entra e o que sai","text":""},{"location":"coinsurance/apolice/#entradas-do-lider","title":"Entradas (do l\u00edder)","text":"<ul> <li>PREMIT: movimento \u201cmacro\u201d (emiss\u00e3o/endosso) com valores consolidados</li> <li>PREMREC: detalhamento por parcelas (cronograma / valores por parcela)</li> <li>PREMRECEB: recebimento efetivo (baixa banc\u00e1ria)</li> <li>RESPREM: reserva/PPNG do m\u00eas (posi\u00e7\u00e3o de fechamento)</li> </ul>"},{"location":"coinsurance/apolice/#saidas-bmg-aceito","title":"Sa\u00eddas (BMG / aceito)","text":"<ul> <li>Retornos/RO com vis\u00e3o proporcional e enriquecida (ex.: PREMAC, PREMRECAC, PREMRECEBC, RESPREMC)</li> </ul>"},{"location":"coinsurance/apolice/#fluxos-do-dominio-apolice","title":"Fluxos do dom\u00ednio (Ap\u00f3lice)","text":""},{"location":"coinsurance/apolice/#fluxo-principal-emissao-da-apolice-definitiva-mastercertificate","title":"Fluxo principal: Emiss\u00e3o da Ap\u00f3lice Definitiva (Master/Certificate)","text":"<p>\u27a1\ufe0f Emiss\u00e3o da Ap\u00f3lice (Master/Certificate) \u2014 PREMIT + PREMREC</p>"},{"location":"coinsurance/apolice/#fluxo-financeiro-recebimento-do-premio-baixapagamento","title":"Fluxo financeiro: Recebimento do Pr\u00eamio (baixa/pagamento)","text":"<p>\u27a1\ufe0f Recebimento do Pr\u00eamio \u2014 PREMRECEB</p>"},{"location":"coinsurance/apolice/#eventos-do-fluxo-gatilho-arquivo-efeito","title":"Eventos do Fluxo (Gatilho \u2192 Arquivo \u2192 Efeito)","text":""},{"location":"coinsurance/apolice/#evento-1-emissao-criacao-do-mastercertificate","title":"Evento 1 \u2014 Emiss\u00e3o (cria\u00e7\u00e3o do Master/Certificate)","text":"<ul> <li>Gatilho: emiss\u00e3o inicial da ap\u00f3lice/certificado pelo l\u00edder.</li> <li>Arquivo: <code>PREMIT</code> + <code>PREMREC</code></li> <li>Regras de Neg\u00f3cio (vis\u00e3o operacional):<ul> <li><code>PREMIT</code> registra o movimento macro (o \u201co que aconteceu\u201d).</li> <li><code>PREMREC</code> traz o parcelamento e habilita o processamento que cria a ap\u00f3lice definitiva.</li> </ul> </li> <li>O processamento cria/atualiza Master Policy e emite Certificate Policy (m\u00f3dulo Policy).</li> <li>Transi\u00e7\u00e3o de Estado: N\u00e3o existente \u2192 Emitida (Master + Certificate)</li> <li>Impacto financeiro: (+) Emiss\u00e3o (gera base para cobran\u00e7a/parcelas)</li> </ul>"},{"location":"coinsurance/apolice/#evento-2-endosso-com-cobranca-adicional-de-premio","title":"Evento 2 \u2014 Endosso com cobran\u00e7a adicional de pr\u00eamio","text":"<ul> <li>Gatilho: altera\u00e7\u00e3o que aumenta o pr\u00eamio (cobran\u00e7a complementar).</li> <li>Arquivo: <code>PREMIT</code> + <code>PREMREC</code></li> <li>Tipo de Movimento (TIPO_MOV): 102</li> <li>Regras de Neg\u00f3cio:</li> <li>Atualiza a ap\u00f3lice/certificado com novo movimento e repercute no parcelamento (quando aplic\u00e1vel).</li> <li>Continua usando <code>PREMIT</code> como registro pai e <code>PREMREC</code> como execu\u00e7\u00e3o (parcelas).</li> <li>Transi\u00e7\u00e3o de Estado: Emitida \u2192 Endossada (pr\u00eamio aumentado)</li> <li>Impacto financeiro: (+) (aumenta base de cobran\u00e7a)</li> </ul>"},{"location":"coinsurance/apolice/#evento-3-endosso-de-restituicao-de-premio","title":"Evento 3 \u2014 Endosso de restitui\u00e7\u00e3o de pr\u00eamio","text":"<ul> <li>Gatilho: altera\u00e7\u00e3o que reduz o pr\u00eamio e gera restitui\u00e7\u00e3o.</li> <li>Arquivo: <code>PREMIT</code> + <code>PREMREC</code></li> <li>Tipo de Movimento (TIPO_MOV): 103</li> <li>Regras de Neg\u00f3cio:</li> <li>Movimento representa redu\u00e7\u00e3o/restitui\u00e7\u00e3o; operacionalmente pode gerar ajustes nas parcelas/valores (dependendo da regra do produto).</li> <li>Transi\u00e7\u00e3o de Estado: Emitida \u2192 Endossada (pr\u00eamio reduzido)</li> <li>Impacto financeiro: (-) (reduz base de cobran\u00e7a / pode gerar estorno)</li> </ul>"},{"location":"coinsurance/apolice/#evento-4-cancelamento-da-apolice-com-ou-sem-restituicao","title":"Evento 4 \u2014 Cancelamento da Ap\u00f3lice (com ou sem restitui\u00e7\u00e3o)","text":"<ul> <li>Gatilho: cancelamento do contrato (ap\u00f3lice/certificado).</li> <li>Arquivo: <code>PREMIT</code> + <code>PREMREC</code></li> <li>Tipos de Movimento (TIPO_MOV):<ul> <li>104: Cancelamento com restitui\u00e7\u00e3o</li> <li>106: Cancelamento sem restitui\u00e7\u00e3o</li> </ul> </li> <li>Regras de Neg\u00f3cio:</li> <li>Cancela a ap\u00f3lice/certificado e encerra o ciclo de cobran\u00e7a (podendo haver restitui\u00e7\u00e3o, conforme TIPO_MOV).</li> <li>Transi\u00e7\u00e3o de Estado: Emitida/Endossada \u2192 Cancelada</li> <li>Impacto financeiro:</li> <li>104: (-) (reduz/estorna pr\u00eamio)</li> <li>106: (0/-) (sem restitui\u00e7\u00e3o; efeito depende de parcelas j\u00e1 recebidas e compet\u00eancia)</li> </ul>"},{"location":"coinsurance/apolice/#evento-5-endosso-sem-movimentacao-de-premio","title":"Evento 5 \u2014 Endosso sem movimenta\u00e7\u00e3o de pr\u00eamio","text":"<ul> <li>Gatilho: altera\u00e7\u00e3o de condi\u00e7\u00f5es sem mexer em valores de pr\u00eamio.</li> <li>Arquivo: <code>PREMIT</code> + <code>PREMREC</code></li> <li>Tipo de Movimento (TIPO_MOV): 108</li> <li>Regras de Neg\u00f3cio:</li> <li>Atualiza dados/condi\u00e7\u00f5es (ex.: par\u00e2metros, informa\u00e7\u00f5es cadastrais/contratuais) sem alterar pr\u00eamio.</li> <li>Transi\u00e7\u00e3o de Estado: Emitida \u2192 Endossada (sem efeito financeiro)</li> <li>Impacto financeiro: (0) (n\u00e3o altera cobran\u00e7a)</li> </ul>"},{"location":"coinsurance/apolice/#evento-6-recebimento-do-premio-baixa-de-parcela","title":"Evento 6 \u2014 Recebimento do pr\u00eamio (baixa de parcela)","text":"<ul> <li>Gatilho: pagamento efetivo (ex.: boleto liquidado / comprovante de recebimento).</li> <li>Arquivo: <code>PREMRECEB</code></li> <li>Campos chave (vis\u00e3o de neg\u00f3cio):</li> <li>Identificadores do movimento (ramo/ap\u00f3lice/endosso/proposta)</li> <li>Parcela (<code>PRESTACAO</code>, vencimento e data de recebimento)</li> <li>Valores do t\u00edtulo (<code>VAL_DOC</code>, <code>VAL_COB</code>, desconto, multa etc.)</li> <li>Regras de Neg\u00f3cio:</li> <li>PREMRECEB representa o realizado (recebido) e \u00e9 base de concilia\u00e7\u00e3o com o emitido/parcelado.</li> <li>Operacionalmente, o sistema pode registrar o pagamento como Payment Paid (quando integrado).</li> <li>Transi\u00e7\u00e3o de Estado: Parcela em aberto \u2192 Parcela recebida</li> <li>Impacto financeiro: (+) Caixa / Liquida\u00e7\u00e3o (confirma recebimento)</li> </ul>"},{"location":"coinsurance/apolice/#evento-7-reserva-mensal-resprem-ppng","title":"Evento 7 \u2014 Reserva mensal (RESPREM / PPNG)","text":"<ul> <li>Gatilho: fechamento mensal / apura\u00e7\u00e3o de compet\u00eancia do pr\u00eamio (risco decorrido vs n\u00e3o decorrido).</li> <li>Arquivo: <code>RESPREM</code></li> <li>Regras de Neg\u00f3cio:</li> <li>Representa a posi\u00e7\u00e3o mensal de pr\u00eamio n\u00e3o ganho (PPNG) e ajustes de compet\u00eancia.</li> <li>Usado para controle/regulat\u00f3rios e concilia\u00e7\u00e3o de resultado por compet\u00eancia.</li> <li>Transi\u00e7\u00e3o de Estado: Compet\u00eancia (m\u00eas) \u2192 Reserva apurada/atualizada</li> <li>Impacto financeiro: (+/-) (ajuste de compet\u00eancia/reserva \u2014 n\u00e3o \u00e9 \u201ccaixa\u201d)</li> </ul>"},{"location":"coinsurance/apolice/#tabela-resumo-apolice","title":"Tabela-resumo (Ap\u00f3lice)","text":"Evento (vis\u00e3o de ap\u00f3lice) Arquivos TIPO_MOV (SUSEP) Impacto principal Transi\u00e7\u00e3o principal 1. Emiss\u00e3o <code>PREMIT</code> + <code>PREMREC</code> 101 (+) cria base de cobran\u00e7a N\u00e3o existente \u2192 Emitida (Master/Certificate) 2. Endosso adicional <code>PREMIT</code> + <code>PREMREC</code> 102 (+) aumenta pr\u00eamio Emitida \u2192 Endossada (+) 3. Restitui\u00e7\u00e3o <code>PREMIT</code> + <code>PREMREC</code> 103 (-) reduz pr\u00eamio Emitida \u2192 Endossada (-) 4. Cancelamento <code>PREMIT</code> + <code>PREMREC</code> 104 / 106 (-)/(0) depende restitui\u00e7\u00e3o Emitida/Endossada \u2192 Cancelada 5. Endosso sem pr\u00eamio <code>PREMIT</code> + <code>PREMREC</code> 108 (0) sem efeito financeiro Emitida \u2192 Endossada (0) 6. Recebimento (baixa) <code>PREMRECEB</code> \u2014 (+) caixa/liquida\u00e7\u00e3o Parcela em aberto \u2192 Recebida 7. Reserva mensal (PPNG) <code>RESPREM</code> \u2014 (+/-) compet\u00eancia/reserva Compet\u00eancia \u2192 Reserva apurada <p>Observa\u00e7\u00e3o importante</p> <p>Os eventos 1\u20135 (em \u201cEmiss\u00e3o/Endosso\u201d) dependem do processamento que cria/atualiza a ap\u00f3lice definitiva (Master/Certificate). O evento 6 (Recebimento) representa o realizado e pode integrar com o motor operacional de pagamentos. O evento 7 (Reserva) \u00e9 compet\u00eancia/regulat\u00f3rio e n\u00e3o representa \u201ccaixa\u201d.</p>"},{"location":"coinsurance/apolice/arquivos/","title":"Arquivos \u2014 Ap\u00f3lice (Coinsurance)","text":"<p>Esta se\u00e7\u00e3o descreve cada arquivo SUSEP do dom\u00ednio Ap\u00f3lice em linguagem de neg\u00f3cio: o que representa, para que serve e como se conecta aos fluxos.</p>"},{"location":"coinsurance/apolice/arquivos/#lista-de-arquivos","title":"Lista de arquivos","text":"<ul> <li>PREMIT \u2014 Movimento consolidado (evento macro)</li> <li>PREMREC \u2014 Detalhamento por parcelas (motor operacional)</li> <li>PREMRECEB \u2014 Recebimento efetivo (baixa financeira)</li> <li>RESPREM \u2014 Posi\u00e7\u00e3o mensal / PPNG (compet\u00eancia e reserva)</li> </ul>"},{"location":"coinsurance/apolice/arquivos/#como-usar","title":"Como usar","text":"<p>1) Comece pelos fluxos para entender o \u201cmotor\u201d do processo. 2) Depois consulte o arquivo espec\u00edfico para entender:    - significado negocial    - campos e inten\u00e7\u00f5es    - pontos de concilia\u00e7\u00e3o com outros arquivoss</p>"},{"location":"coinsurance/apolice/arquivos/premit/","title":"PREMIT \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>Defini\u00e7\u00e3o curta: PREMIT \u00e9 o registro mestre do movimento de pr\u00eamio (emiss\u00e3o/endosso/cancelamento) no cosseguro \u2014 um \u201cespelho consolidado\u201d do evento no n\u00edvel ap\u00f3lice/certificado, com as chaves e totalizadores que amarram o movimento.</p>"},{"location":"coinsurance/apolice/arquivos/premit/#o-que-ele-representa-no-negocio","title":"O que ele representa no neg\u00f3cio","text":"<p>O PREMIT representa o evento macro que aconteceu com a ap\u00f3lice/certificado naquele ciclo. Ele descreve qual movimento ocorreu, em que compet\u00eancia esse movimento \u00e9 reportado, qual ap\u00f3lice/proposta/endosso foi afetado e quais totalizadores financeiros comp\u00f5em esse movimento.</p>"},{"location":"coinsurance/apolice/arquivos/premit/#1-identidade-do-movimento-chaves","title":"1) Identidade do movimento (chaves)","text":"<p>O PREMIT traz as chaves que identificam univocamente o movimento:</p> <ul> <li> <p>Companhia / origem</p> <ul> <li><code>COD_CIA</code> (companhia de refer\u00eancia do arquivo)</li> <li><code>DS_ORIGEM</code> (origem do dado/canal)</li> </ul> </li> <li> <p>Chaves do contrato</p> <ul> <li><code>COD_RAMO</code> (ramo SUSEP)</li> <li><code>NUM_APOL</code> (ap\u00f3lice)</li> <li><code>NUM_END</code> (endosso)</li> <li><code>NUM_PROP</code> (proposta)</li> </ul> </li> <li> <p>Natureza do evento</p> <ul> <li><code>TIPO_MOV</code> (emiss\u00e3o/endosso/cancelamento etc.)</li> </ul> </li> </ul> <p>Leitura de neg\u00f3cio: com esses campos voc\u00ea consegue responder \u201co que aconteceu?\u201d e \u201cqual contrato foi impactado?\u201d.</p>"},{"location":"coinsurance/apolice/arquivos/premit/#2-contexto-temporal-datas","title":"2) Contexto temporal (datas)","text":"<p>O PREMIT \u00e9 fortemente \u201ctemporal\u201d: ele diz quando (compet\u00eancia e vig\u00eancia) o movimento vale.</p> <ul> <li> <p>Compet\u00eancia / base</p> <ul> <li><code>DT_BASE</code> \u2192 \u201cm\u00eas base\u201d/compet\u00eancia que organiza fechamento, concilia\u00e7\u00e3o e relat\u00f3rios.</li> </ul> </li> <li> <p>Lifecycle comercial</p> <ul> <li><code>DT_PROP</code> (data da proposta)</li> <li><code>DT_EMIS</code> (data de emiss\u00e3o do movimento)</li> </ul> </li> <li> <p>Vig\u00eancia do risco</p> <ul> <li><code>DT_INI_VIG</code> (in\u00edcio vig\u00eancia)</li> <li><code>DT_FIM_VIG</code> (fim vig\u00eancia)</li> </ul> </li> </ul> <p>Leitura de neg\u00f3cio: PREMIT separa bem compet\u00eancia (<code>DT_BASE</code>) de vig\u00eancia de risco (<code>DT_INI_VIG/DT_FIM_VIG</code>). Isso \u00e9 importante porque: o caixa pode acontecer em data diferente da compet\u00eancia, e a compet\u00eancia pode acontecer em data diferente da vig\u00eancia do risco.</p>"},{"location":"coinsurance/apolice/arquivos/premit/#3-totalizadores-financeiros-do-movimento-consolidado","title":"3) Totalizadores financeiros do movimento (consolidado)","text":"<p>O PREMIT carrega os valores consolidados do evento. Ele \u00e9 a \u201cfoto\u201d do movimento na vis\u00e3o macro.</p> <p>Valores t\u00edpicos (exemplos do seu OPA/layout):</p> <ul> <li> <p><code>PR_EMIT</code> \u2192 pr\u00eamio emitido do movimento</p> </li> <li> <p><code>PR_COS_CED</code> \u2192 pr\u00eamio cedido no cosseguro (parcela cedida)</p> </li> <li> <p><code>AD_FRAC</code> \u2192 adicional fracionamento</p> </li> <li> <p><code>CUST_APOL</code> \u2192 custo ap\u00f3lice</p> </li> <li> <p><code>IOF</code> \u2192 imposto</p> </li> <li> <p><code>COMIS</code> / <code>COMIS_COSS</code> \u2192 comiss\u00f5es</p> </li> <li> <p><code>PRO_LAB</code> \u2192 pr\u00f3-labore</p> </li> </ul> <p>Leitura de neg\u00f3cio: s\u00e3o totalizadores usados para: - comparar com o detalhamento (<code>PREMREC</code>) - conciliar com o recebido (<code>PREMRECEB</code>) - explicar diverg\u00eancia de saldo / diferen\u00e7a de fechamento</p>"},{"location":"coinsurance/apolice/arquivos/premit/#4-identidade-do-segurado-e-contexto-comercial","title":"4) Identidade do segurado e contexto comercial","text":"<p>Al\u00e9m do movimento e valores, o PREMIT ancora quem \u00e9 o contrato e \u201cqual produto\u201d.</p> <ul> <li> <p>Segurado</p> <ul> <li><code>CPF_SEG</code> (CPF/CNPJ do segurado)</li> <li><code>QTD_SEG</code> (quantidade de segurados quando aplic\u00e1vel)</li> <li><code>QTD_TOM</code> (indicador de tomador quando aplic\u00e1vel)</li> </ul> </li> <li> <p>Produto e canal (enriquecimento de neg\u00f3cio)</p> <ul> <li><code>DS_GRUPO_RAMO</code> (grupo de ramo)</li> <li><code>CD_PRODUTO</code> / <code>DS_PRODUTO</code></li> <li><code>CD_BU</code> / <code>DS_BU</code></li> <li><code>CD_OPERACAO</code> / <code>DCR_TIP_OPER</code></li> <li><code>CD_CARTEIRA</code> / <code>DS_CARTEIRA</code></li> <li><code>CD_SUCURSAL</code></li> <li><code>FG_GEB</code> (flag operacional)</li> </ul> </li> </ul> <p>Leitura de neg\u00f3cio: esses campos permitem classifica\u00e7\u00e3o, segmenta\u00e7\u00e3o e valida\u00e7\u00f5es de consist\u00eancia (produto, BU, opera\u00e7\u00e3o, carteira).</p>"},{"location":"coinsurance/apolice/arquivos/premit/#para-que-serve-no-fluxo-operacional","title":"Para que serve no fluxo operacional","text":""},{"location":"coinsurance/apolice/arquivos/premit/#1-rastreabilidade-o-que-aconteceu","title":"1) Rastreabilidade (\u201co que aconteceu\u201d)","text":"<p>O PREMIT responde rapidamente:</p> <ul> <li> <p>Qual evento (TIPO_MOV) ocorreu</p> </li> <li> <p>Em qual contrato (ramo/ap\u00f3lice/endosso/proposta)</p> </li> <li> <p>Em qual compet\u00eancia (DT_BASE)</p> </li> <li> <p>Com quais totalizadores (pr\u00eamio, IOF, comiss\u00e3o, custos\u2026)</p> </li> </ul> <p>Isso \u00e9 usado para:</p> <ul> <li> <p>auditoria e trilha regulat\u00f3ria</p> </li> <li> <p>concilia\u00e7\u00e3o por compet\u00eancia</p> </li> <li> <p>investiga\u00e7\u00e3o de diverg\u00eancias (emitido x parcelado x recebido)</p> </li> </ul>"},{"location":"coinsurance/apolice/arquivos/premit/#2-registro-pai-do-detalhamento-premrec","title":"2) Registro \u201cpai\u201d do detalhamento (PREMREC)","text":"<p>No seu fluxo de Coinsurance, o PREMIT funciona como \u201cpai\u201d do PREMREC:</p> <ul> <li>PREMIT consolida o movimento</li> <li>PREMREC detalha a cobran\u00e7a (parcelas) e viabiliza a execu\u00e7\u00e3o operacional</li> </ul> <p>Na pr\u00e1tica:</p> <ul> <li> <p>o sistema ingere PREMIT e guarda <code>PENDING</code></p> </li> <li> <p>depois usa PREMIT como base para correlacionar e processar PREMREC</p> </li> </ul>"},{"location":"coinsurance/apolice/arquivos/premit/#3-validacoes-de-consistencia-e-governanca-do-lote","title":"3) Valida\u00e7\u00f5es de consist\u00eancia e governan\u00e7a do lote","text":"<p>Mesmo sem colocar OPA no repo, o conceito de neg\u00f3cio \u00e9:</p> <ul> <li>PREMIT garante que o movimento possui:</li> <li>chaves m\u00ednimas</li> <li>datas obrigat\u00f3rias</li> <li>c\u00f3digos de ramo coerentes</li> <li>segurado identificado</li> <li>totalizadores presentes</li> </ul> <p>Por que isso importa? - evita criar \u201cap\u00f3lice definitiva\u201d com dados incompletos - garante que o lote de integra\u00e7\u00e3o tem consist\u00eancia regulat\u00f3ria m\u00ednima</p>"},{"location":"coinsurance/apolice/arquivos/premit/#como-o-premit-se-complementa-com-premrec","title":"Como o PREMIT se complementa com PREMREC","text":""},{"location":"coinsurance/apolice/arquivos/premit/#relacao-paifilho-visao-de-dominio","title":"Rela\u00e7\u00e3o pai/filho (vis\u00e3o de dom\u00ednio)","text":"<ul> <li>PREMIT (pai): 1 registro por movimento macro (evento + totalizadores)</li> <li>PREMREC (filhos): N registros por movimento (parcelas / plano de cobran\u00e7a)</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premit/#o-que-cada-um-resolve","title":"O que cada um resolve","text":"<ul> <li>PREMIT responde: \u201cqual foi o movimento e qual o total?\u201d</li> <li>PREMREC responde: \u201ccomo esse total foi parcelado/cobrado?\u201d</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premit/#o-que-da-errado-se-um-faltar","title":"O que d\u00e1 errado se um faltar","text":"<ul> <li>Sem PREMIT: voc\u00ea perde o \u201ccontexto do evento\u201d e os totalizadores para auditoria/concilia\u00e7\u00e3o.</li> <li>Sem PREMREC: voc\u00ea tem o evento, mas n\u00e3o consegue operar o ciclo de cobran\u00e7a/parcelas com consist\u00eancia.</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premit/#relacoes-importantes-com-outros-arquivos-visao-de-negocio","title":"Rela\u00e7\u00f5es importantes com outros arquivos (vis\u00e3o de neg\u00f3cio)","text":""},{"location":"coinsurance/apolice/arquivos/premit/#premreceb-recebido","title":"PREMRECEB (recebido)","text":"<ul> <li>PREMREC define o \u201cplanejado/parcelado\u201d</li> <li>PREMRECEB confirma o \u201crealizado/recebido\u201d</li> <li>PREMIT ancora o \u201cevento macro\u201d que d\u00e1 contexto aos dois</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premit/#resprem-competenciappng","title":"RESPREM (compet\u00eancia/PPNG)","text":"<ul> <li>RESPREM usa o universo de ap\u00f3lices e vig\u00eancias para apurar compet\u00eancia/reserva.</li> <li>O PREMIT fornece parte do contexto (movimento + vig\u00eancia + compet\u00eancia) para rastreabilidade.</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premit/#status-no-fluxo-interno-visao-operacional","title":"Status no fluxo interno (vis\u00e3o operacional)","text":"<ul> <li>Entrada: PREMIT normalmente \u00e9 gravado como <code>PENDING</code>.</li> <li>Processamento real (emiss\u00e3o/endosso da ap\u00f3lice definitiva): acontece no motor do PREMREC.</li> <li>Sa\u00edda esperada: quando o movimento \u00e9 processado com sucesso, PREMIT tende a ir para <code>COMPLETED</code> junto dos PREMREC relacionados (quando a atualiza\u00e7\u00e3o de status est\u00e1 ativa).</li> </ul> <p>Nota operacional</p> <p>O PREMIT n\u00e3o \u201cemite\u201d ap\u00f3lice sozinho. Ele \u00e9 o registro mestre do movimento, usado para correla\u00e7\u00e3o e concilia\u00e7\u00e3o. A cria\u00e7\u00e3o/altera\u00e7\u00e3o da ap\u00f3lice definitiva (Master/Certificate) ocorre via processamento do PREMREC.</p>"},{"location":"coinsurance/apolice/arquivos/premit/#checklist-de-entendimento-traducao-bem-objetiva","title":"Checklist de entendimento (tradu\u00e7\u00e3o bem objetiva)","text":"<ul> <li>PREMIT = evento macro + totalizadores + vig\u00eancia + compet\u00eancia</li> <li>Ele responde: \u201co que aconteceu e qual o total do movimento?\u201d</li> <li>Ele ancora: auditoria, concilia\u00e7\u00e3o e correla\u00e7\u00e3o com PREMREC/PREMRECEB</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premrec/","title":"PREMREC \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>Defini\u00e7\u00e3o curta: PREMREC \u00e9 o detalhe operacional do movimento de pr\u00eamio, normalmente no n\u00edvel de parcelas, que materializa como o pr\u00eamio foi (ou ser\u00e1) cobrado e viabiliza o processamento real de emiss\u00e3o/endosso da ap\u00f3lice definitiva (Master/Certificate).</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#o-que-ele-representa-no-negocio","title":"O que ele representa no neg\u00f3cio","text":"<p>O PREMREC representa o desdobramento do movimento (registrado no PREMIT) em informa\u00e7\u00f5es que suportam a opera\u00e7\u00e3o de cobran\u00e7a e consist\u00eancia financeira.</p> <p>Em linguagem de neg\u00f3cio, ele descreve: - Qual contrato/movimento est\u00e1 sendo processado (mesmas chaves do PREMIT) - Como o pr\u00eamio se distribui por parcela (n\u00famero e quantidade de parcelas) - Quais datas e valores comp\u00f5em cada parcela (compet\u00eancia, emiss\u00e3o, vig\u00eancia e valores por parcela)</p> <p>Leitura de neg\u00f3cio: se o PREMIT diz \u201co que aconteceu e quanto totaliza\u201d, o PREMREC diz \u201ccomo isso vira cobran\u00e7a, parcela a parcela\u201d.</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#o-que-ele-contem-visao-conceitual","title":"O que ele cont\u00e9m (vis\u00e3o conceitual)","text":""},{"location":"coinsurance/apolice/arquivos/premrec/#1-identidade-do-movimento-chaves","title":"1) Identidade do movimento (chaves)","text":"<p>O PREMREC repete as chaves que conectam o detalhe ao movimento macro:</p> <ul> <li><code>COD_CIA</code> (companhia)</li> <li><code>DT_BASE</code> (compet\u00eancia/base)</li> <li><code>TIPO_MOV</code> (tipo de movimento)</li> <li><code>COD_RAMO</code> (ramo SUSEP)</li> <li><code>NUM_APOL</code> (ap\u00f3lice)</li> <li><code>NUM_END</code> (endosso)</li> <li><code>NUM_PROP</code> (proposta)</li> <li><code>DT_PROP</code> (data proposta)</li> </ul> <p>Por que repetir? Para o arquivo ser autocontido e para garantir correla\u00e7\u00e3o com PREMIT e demais fluxos.</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#2-parcelamento-o-plano-de-cobranca","title":"2) Parcelamento (o \u201cplano de cobran\u00e7a\u201d)","text":"<p>Este \u00e9 o cora\u00e7\u00e3o do PREMREC no neg\u00f3cio:</p> <ul> <li><code>PRESTACAO</code> \u2192 n\u00famero da parcela (ex.: 1, 2, 3\u2026)</li> <li><code>QTDE_PREST</code> \u2192 quantidade total de parcelas (ex.: 12)</li> </ul> <p>Leitura de neg\u00f3cio: \u201ceste movimento ser\u00e1 cobrado em N parcelas e esta linha \u00e9 a parcela X\u201d.</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#3-datas-operacionais-por-parcela","title":"3) Datas operacionais por parcela","text":"<p>O PREMREC traz datas usadas para cobran\u00e7a, vig\u00eancia e concilia\u00e7\u00e3o:</p> <ul> <li><code>DT_EMIS_PR</code> (data de emiss\u00e3o do pr\u00eamio/parcela)</li> <li><code>DT_INI_VIG</code> / <code>DT_FIM_VIG</code> (vig\u00eancia do risco)</li> </ul> <p>Dependendo do desenho do produto, tamb\u00e9m pode ser interpretado como: - refer\u00eancia para c\u00e1lculo de proporcionalidade/compet\u00eancia - valida\u00e7\u00e3o \u201cn\u00e3o cobrar fora da vig\u00eancia\u201d</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#4-valores-por-parcela-micro-totalizadores","title":"4) Valores por parcela (micro totalizadores)","text":"<p>O PREMREC traz valores no n\u00edvel de parcela, que explicam e sustentam o consolidado do PREMIT:</p> <p>Exemplos comuns no layout/valida\u00e7\u00f5es: - <code>PR_EMIT</code> (pr\u00eamio emitido da parcela) - <code>AD_FRAC</code> (adicional fracionamento) - <code>CUS_APOL</code> / <code>CUST_APOL</code> (custo ap\u00f3lice) - <code>IOF</code> (imposto) - <code>OFER</code> (quando aplic\u00e1vel) - <code>PERC_COSS</code> (percentual de cosseguro, quando informado)</p> <p>Leitura de neg\u00f3cio: esses valores, somados, devem bater com o PREMIT (ou pelo menos permitir explicar diferen\u00e7as).</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#5-contexto-de-produtocanal-enriquecimento","title":"5) Contexto de produto/canal (enriquecimento)","text":"<p>Assim como no PREMIT, o PREMREC normalmente carrega tamb\u00e9m:</p> <ul> <li><code>DS_GRUPO_RAMO</code></li> <li><code>CD_PRODUTO</code> / <code>DS_PRODUTO</code></li> <li><code>CD_BU</code> / <code>DS_BU</code></li> <li><code>CD_OPERACAO</code> / <code>DCR_TIP_OPER</code></li> <li><code>CD_CARTEIRA</code> / <code>DS_CARTEIRA</code></li> <li><code>CD_SUCURSAL</code></li> <li><code>FG_GEB</code></li> <li><code>DS_ORIGEM</code></li> </ul> <p>Uso negocial: classifica\u00e7\u00e3o, roteamento, valida\u00e7\u00e3o de consist\u00eancia e auditoria.</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#para-que-serve-no-fluxo-operacional","title":"Para que serve no fluxo operacional","text":""},{"location":"coinsurance/apolice/arquivos/premrec/#1-materializar-o-parcelamento-para-cobranca-e-conciliacao","title":"1) Materializar o parcelamento para cobran\u00e7a e concilia\u00e7\u00e3o","text":"<p>O PREMREC habilita: - confer\u00eancia do \u201cplanejado\u201d (parcelas) versus \u201crealizado\u201d (PREMRECEB) - an\u00e1lise de inadimpl\u00eancia (se existir) - reprocessamento e controle por parcela (quando aplic\u00e1vel)</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#2-viabilizar-a-emissaoendosso-da-apolice-definitiva-mastercertificate","title":"2) Viabilizar a emiss\u00e3o/endosso da ap\u00f3lice definitiva (Master/Certificate)","text":"<p>No fluxo interno de Coinsurance, o PREMREC \u00e9 o motor operacional:</p> <ul> <li>ele \u00e9 processado correlacionado ao PREMIT (pai)</li> <li>executa as valida\u00e7\u00f5es operacionais (party/produto/ap\u00f3lice existente)</li> <li>cria/atualiza a ap\u00f3lice definitiva no m\u00f3dulo Policy:</li> <li>Master Policy (pr\u00e9-condi\u00e7\u00e3o)</li> <li>Certificate Policy (o certificado emitido)</li> <li>processa endossos (quando <code>TIPO_MOV</code> indicar)</li> </ul> <p>Em linguagem de neg\u00f3cio: o PREMREC \u00e9 \u201co arquivo que faz a ap\u00f3lice acontecer\u201d no sistema.</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#3-base-para-downstream-financeiro-fees-integracoes","title":"3) Base para downstream financeiro (fees / integra\u00e7\u00f5es)","text":"<p>Como o PREMREC \u00e9 o que \u201cconstr\u00f3i\u201d a ap\u00f3lice e define o parcelamento, ele tamb\u00e9m suporta: - integra\u00e7\u00e3o de p\u00f3s-emiss\u00e3o (ex.: taxas/fees) - consist\u00eancia de dados para etapas posteriores (recebimento, reserva)</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#relacao-com-premit-pai-e-premreceb-recebido","title":"Rela\u00e7\u00e3o com PREMIT (pai) e PREMRECEB (recebido)","text":""},{"location":"coinsurance/apolice/arquivos/premrec/#premit-x-premrec","title":"PREMIT x PREMREC","text":"<ul> <li>PREMIT: movimento macro (evento + totalizadores)</li> <li>PREMREC: detalhamento (parcelas + valores por parcela)</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premrec/#premrec-x-premreceb","title":"PREMREC x PREMRECEB","text":"<ul> <li>PREMREC: diz \u201ccomo foi parcelado/cobrado\u201d</li> <li>PREMRECEB: diz \u201co que foi efetivamente recebido\u201d</li> </ul> <p>Concilia\u00e7\u00e3o natural: parcela X do PREMREC deve ter correspond\u00eancia no PREMRECEB quando liquidada.</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#leitura-de-tipo_mov-no-contexto-do-premrec-negocio","title":"Leitura de TIPO_MOV no contexto do PREMREC (neg\u00f3cio)","text":"<p>O <code>TIPO_MOV</code> influencia o sentido do movimento e como tratar o evento:</p> TIPO_MOV Significado negocial Efeito t\u00edpico 101 Emiss\u00e3o Cria Master/Certificate e estrutura base 102 Cobran\u00e7a adicional Aumenta pr\u00eamio (ajuste para cima) 103 Restitui\u00e7\u00e3o Reduz pr\u00eamio (ajuste para baixo) 104 / 106 Cancelamento ap\u00f3lice Encerra contrato (com/sem restitui\u00e7\u00e3o) 105 / 107 Cancelamento endosso Reverte um endosso (com/sem restitui\u00e7\u00e3o) 108 Endosso sem pr\u00eamio Ajuste cadastral/contratual sem efeito financeiro <p>Nota</p> <p>A leitura acima \u00e9 negocial (layout). O comportamento exato depende do motor de endosso/integra\u00e7\u00e3o no sistema.</p>"},{"location":"coinsurance/apolice/arquivos/premrec/#como-identificar-o-premrec-no-dia-a-dia-traducao-objetiva","title":"Como identificar o PREMREC no dia a dia (tradu\u00e7\u00e3o objetiva)","text":"<ul> <li>PREMREC = \u201cparcela + valores da parcela\u201d para um movimento de ap\u00f3lice</li> <li>Responde: \u201ccomo o pr\u00eamio foi parcelado?\u201d</li> <li>Serve para:</li> <li>emitir/endossar ap\u00f3lice definitiva (Master/Certificate)</li> <li>operar cobran\u00e7a e conciliar com recebimento (PREMRECEB)</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premrec/#checklist-de-entendimento-rapido","title":"Checklist de entendimento r\u00e1pido","text":"<ul> <li>PREMREC repete as chaves do PREMIT para correla\u00e7\u00e3o</li> <li>PREMREC traz o parcelamento (<code>PRESTACAO</code>, <code>QTDE_PREST</code>)</li> <li>PREMREC traz valores por parcela (micro totalizadores)</li> <li>PREMREC \u00e9 o motor operacional da emiss\u00e3o/endosso no fluxo interno</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premreceb/","title":"PREMRECEB \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>Defini\u00e7\u00e3o curta: PREMRECEB \u00e9 o arquivo de recebimento efetivo do pr\u00eamio (baixa financeira), normalmente no n\u00edvel de parcela/t\u00edtulo, registrando quando e quanto foi pago e os identificadores banc\u00e1rios do recebimento.</p>"},{"location":"coinsurance/apolice/arquivos/premreceb/#o-que-ele-representa-no-negocio","title":"O que ele representa no neg\u00f3cio","text":"<p>O PREMRECEB representa o fato gerador de caixa no ciclo de pr\u00eamio do cosseguro: a parcela do pr\u00eamio foi liquidada (ex.: boleto pago).</p> <p>Ele descreve, em linguagem de neg\u00f3cio: - Qual contrato/movimento est\u00e1 sendo baixado (ramo/ap\u00f3lice/endosso/proposta e tipo de movimento) - Qual parcela foi paga (n\u00famero da parcela e datas) - Como foi pago (identificadores banc\u00e1rios do t\u00edtulo/boleto) - Quais valores foram liquidados (valor do documento, desconto, multa, valor cobrado)</p> <p>Leitura de neg\u00f3cio: se o PREMREC \u00e9 o \u201cplanejado/cobrado (parcelas)\u201d, o PREMRECEB \u00e9 o \u201crealizado/recebido\u201d.</p>"},{"location":"coinsurance/apolice/arquivos/premreceb/#o-que-ele-contem-visao-conceitual","title":"O que ele cont\u00e9m (vis\u00e3o conceitual)","text":""},{"location":"coinsurance/apolice/arquivos/premreceb/#1-identidade-do-movimento-chaves","title":"1) Identidade do movimento (chaves)","text":"<p>O PREMRECEB traz as chaves que ligam o recebimento ao contrato e ao evento:</p> <ul> <li><code>COD_CIA</code> (companhia)</li> <li><code>DT_BASE</code> (compet\u00eancia/base do registro)</li> <li><code>TIPO_MOV</code> (tipo do movimento relacionado)</li> <li><code>COD_RAMO</code> (ramo SUSEP)</li> <li><code>NUM_APOL</code> (ap\u00f3lice)</li> <li><code>NUM_END</code> (endosso)</li> <li><code>NUM_PROP</code> (proposta)</li> <li><code>DT_PROP</code> (data da proposta)</li> </ul> <p>Uso negocial: correla\u00e7\u00e3o com PREMIT/PREMREC e rastreabilidade do recebimento por movimento.</p>"},{"location":"coinsurance/apolice/arquivos/premreceb/#2-identificacao-da-parcela-e-datas-de-baixa","title":"2) Identifica\u00e7\u00e3o da parcela e datas de baixa","text":"<p>O PREMRECEB identifica a parcela liquidada e suas datas:</p> <ul> <li><code>PRESTACAO</code> \u2192 n\u00famero da parcela (ex.: 1/12, 2/12\u2026)</li> <li><code>DT_VEN_PRE</code> \u2192 data de vencimento</li> <li><code>DT_REC_PRE</code> \u2192 data de recebimento (liquida\u00e7\u00e3o)</li> </ul> <p>Leitura de neg\u00f3cio: \u201cparcela X venceu em Y e foi paga/liquidada em Z\u201d.</p>"},{"location":"coinsurance/apolice/arquivos/premreceb/#3-identificadores-bancarios-do-titulo-boleto","title":"3) Identificadores banc\u00e1rios do t\u00edtulo (boleto)","text":"<p>Elementos que permitem concilia\u00e7\u00e3o com cobran\u00e7a e auditoria:</p> <ul> <li><code>NUM_BOL</code> \u2192 n\u00famero do boleto (quando existente)</li> <li><code>NUM_DOC</code> \u2192 n\u00famero do documento/t\u00edtulo</li> <li><code>NUM_NOS</code> \u2192 nosso n\u00famero</li> <li><code>NUM_BAN</code> \u2192 c\u00f3digo/n\u00famero do banco</li> <li><code>NUM_AGE</code> \u2192 ag\u00eancia</li> <li><code>CNPJ_BAN</code> \u2192 documento do banco (CNPJ)</li> </ul> <p>Uso negocial: conciliar com a baixa banc\u00e1ria e garantir unicidade do recebimento (evitar duplicidade).</p>"},{"location":"coinsurance/apolice/arquivos/premreceb/#4-valores-do-recebimento-caixa","title":"4) Valores do recebimento (caixa)","text":"<p>O PREMRECEB registra valores relacionados \u00e0 liquida\u00e7\u00e3o do t\u00edtulo:</p> <ul> <li><code>VAL_DOC</code> \u2192 valor do documento</li> <li><code>VAL_DESC</code> \u2192 valor de desconto</li> <li><code>VAL_MUL</code> \u2192 valor de multa</li> <li><code>VAL_COB</code> \u2192 valor cobrado/recebido (valor efetivamente liquidado)</li> </ul> <p>Leitura de neg\u00f3cio: o que interessa para o \u201ccaixa\u201d normalmente \u00e9 <code>VAL_COB</code> (ou a combina\u00e7\u00e3o de doc+ajustes conforme regra).</p>"},{"location":"coinsurance/apolice/arquivos/premreceb/#5-contexto-de-produtocanal-enriquecimento","title":"5) Contexto de produto/canal (enriquecimento)","text":"<p>Tamb\u00e9m aparecem campos de categoriza\u00e7\u00e3o do neg\u00f3cio:</p> <ul> <li><code>DS_GRUPO_RAMO</code></li> <li><code>CD_PRODUTO</code> / <code>DS_PRODUTO</code></li> <li><code>CD_BU</code> / <code>DS_BU</code></li> <li><code>CD_OPERACAO</code> / <code>DCR_TIP_OPER</code></li> <li><code>CD_CARTEIRA</code> / <code>DS_CARTEIRA</code></li> <li><code>CD_SUCURSAL</code></li> <li><code>FG_GEB</code></li> <li><code>DS_ORIGEM</code></li> </ul> <p>Uso negocial: classifica\u00e7\u00e3o, roteamento, relat\u00f3rios e concilia\u00e7\u00e3o por produto/canal.</p>"},{"location":"coinsurance/apolice/arquivos/premreceb/#para-que-serve-no-fluxo-operacional","title":"Para que serve no fluxo operacional","text":""},{"location":"coinsurance/apolice/arquivos/premreceb/#1-confirmar-a-liquidacao-do-premio-evento-de-caixa","title":"1) Confirmar a liquida\u00e7\u00e3o do pr\u00eamio (evento de caixa)","text":"<p>No ciclo de vida de pr\u00eamio, PREMRECEB \u00e9 o que permite afirmar: - \u201co dinheiro entrou\u201d (ou foi liquidado no agente arrecadador)</p> <p>Isso habilita: - concilia\u00e7\u00e3o emitido x recebido - controle de inadimpl\u00eancia (quando comparado ao PREMREC) - base para repasses, comissionamentos e controles internos (conforme desenho do produto)</p>"},{"location":"coinsurance/apolice/arquivos/premreceb/#2-conciliacao-com-premrec-planejadocobrado","title":"2) Concilia\u00e7\u00e3o com PREMREC (planejado/cobrado)","text":"<p>O caso cl\u00e1ssico de uso:</p> <ul> <li>PREMREC diz: \u201cparcela X existe, vence em Y, vale Z\u201d</li> <li>PREMRECEB diz: \u201cparcela X foi recebida em W, valor liquidado foi V\u201d</li> </ul> <p>Conceito-chave: PREMRECEB \u00e9 o \u201cespelho do extrato/baixa\u201d, e PREMREC \u00e9 o \u201cespelho do plano de cobran\u00e7a\u201d.</p>"},{"location":"coinsurance/apolice/arquivos/premreceb/#3-materializacao-do-recebimento-em-sistemas-operacionais-pagamento","title":"3) Materializa\u00e7\u00e3o do recebimento em sistemas operacionais (pagamento)","text":"<p>Operacionalmente, o PREMRECEB pode ser usado para: - registrar o recebimento como um pagamento efetivo (ex.: <code>Payment</code> com status Paid) - vinculado \u00e0 ap\u00f3lice/certificado e, quando aplic\u00e1vel, ao endosso</p> <p>Leitura de neg\u00f3cio: PREMRECEB vira o \u201cregistro de pagamento\u201d no sistema operacional.</p>"},{"location":"coinsurance/apolice/arquivos/premreceb/#relacoes-importantes-com-outros-arquivos-visao-de-negocio","title":"Rela\u00e7\u00f5es importantes com outros arquivos (vis\u00e3o de neg\u00f3cio)","text":""},{"location":"coinsurance/apolice/arquivos/premreceb/#premit-movimento-macro","title":"PREMIT (movimento macro)","text":"<ul> <li>PREMIT ancora \u201co evento\u201d (emiss\u00e3o/endosso/cancelamento) e seus totalizadores.</li> <li>PREMRECEB ancora \u201co caixa\u201d decorrente daquele universo de cobran\u00e7a.</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premreceb/#premrec-parcelas","title":"PREMREC (parcelas)","text":"<ul> <li>PREMREC define o parcelamento e valores planejados.</li> <li>PREMRECEB confirma o pagamento/baixa por parcela.</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premreceb/#resprem-competencia-ppng","title":"RESPREM (compet\u00eancia / PPNG)","text":"<ul> <li>RESPREM trata a reserva/compet\u00eancia.</li> <li>PREMRECEB \u00e9 caixa (pode acontecer em data diferente da compet\u00eancia do pr\u00eamio).</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premreceb/#como-identificar-o-premreceb-no-dia-a-dia-traducao-objetiva","title":"Como identificar o PREMRECEB no dia a dia (tradu\u00e7\u00e3o objetiva)","text":"<ul> <li>PREMRECEB = \u201cparcela paga\u201d + \u201cdados banc\u00e1rios do t\u00edtulo\u201d + \u201cvalor liquidado\u201d</li> <li>Responde:</li> <li>\u201cqual parcela foi paga?\u201d</li> <li>\u201cquando foi paga?\u201d</li> <li>\u201cquanto foi liquidado?\u201d</li> <li>\u201cqual t\u00edtulo/boleto foi baixado?\u201d</li> </ul>"},{"location":"coinsurance/apolice/arquivos/premreceb/#checklist-de-entendimento-rapido","title":"Checklist de entendimento r\u00e1pido","text":"<ul> <li>Tem as chaves do contrato/movimento (ramo/ap\u00f3lice/endosso/proposta)</li> <li>Tem a parcela (<code>PRESTACAO</code>) e datas (<code>DT_VEN_PRE</code>, <code>DT_REC_PRE</code>)</li> <li>Tem dados banc\u00e1rios do t\u00edtulo (nosso n\u00famero, doc, boleto, banco, ag\u00eancia)</li> <li>Tem os valores do recebimento (<code>VAL_DOC</code>, <code>VAL_DESC</code>, <code>VAL_MUL</code>, <code>VAL_COB</code>)</li> <li>\u00c9 o evento que fecha a pergunta: \u201co pr\u00eamio foi recebido?\u201d</li> </ul>"},{"location":"coinsurance/apolice/arquivos/resprem/","title":"RESPREM \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>Defini\u00e7\u00e3o curta: RESPREM \u00e9 o arquivo de reserva/compet\u00eancia do pr\u00eamio no fechamento mensal \u2014 a \u201cposi\u00e7\u00e3o do m\u00eas\u201d que indica quanto do pr\u00eamio est\u00e1 ganho vs n\u00e3o ganho (PPNG), suportando apura\u00e7\u00e3o cont\u00e1bil/regulat\u00f3ria no contexto de cosseguro.</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#o-que-ele-representa-no-negocio","title":"O que ele representa no neg\u00f3cio","text":"<p>O RESPREM representa a fotografia mensal do pr\u00eamio em termos de compet\u00eancia (resultado) e reserva t\u00e9cnica.</p> <p>Em linguagem de neg\u00f3cio, ele responde: - \u201cQuanto do pr\u00eamio j\u00e1 foi ganho at\u00e9 o m\u00eas-base?\u201d - \u201cQuanto ainda est\u00e1 n\u00e3o ganho (risco a decorrer) e precisa ficar como reserva?\u201d - \u201cQual a posi\u00e7\u00e3o consolidada por ap\u00f3lice/certificado e suas chaves?\u201d</p> <p>Leitura de neg\u00f3cio: diferente de PREMRECEB (caixa) e PREMREC (parcelamento), o RESPREM \u00e9 compet\u00eancia: ele existe para refletir o risco decorrido e a PPNG no m\u00eas.</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#por-que-ele-existe-visao-regulatoria-e-operacional","title":"Por que ele existe (vis\u00e3o regulat\u00f3ria e operacional)","text":""},{"location":"coinsurance/apolice/arquivos/resprem/#competencia-caixa","title":"Compet\u00eancia \u2260 Caixa","text":"<p>No seguro, o resultado \u00e9 reconhecido por compet\u00eancia (risco ao longo do tempo), e n\u00e3o apenas pelo recebimento.</p> <ul> <li>Voc\u00ea pode ter pr\u00eamio recebido (caixa) sem estar totalmente ganho (risco ainda n\u00e3o decorrido).</li> <li>Voc\u00ea pode ter pr\u00eamio emitido sem ter sido recebido ainda.</li> </ul> <p>O RESPREM \u00e9 a pe\u00e7a que amarra: - vig\u00eancia do risco (tempo decorrido) - pr\u00eamio relacionado - posi\u00e7\u00e3o de reserva no m\u00eas-base</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#o-que-ele-contem-visao-conceitual","title":"O que ele cont\u00e9m (vis\u00e3o conceitual)","text":""},{"location":"coinsurance/apolice/arquivos/resprem/#1-identidade-da-posicao-mes-base","title":"1) Identidade da posi\u00e7\u00e3o (m\u00eas-base)","text":"<p>O RESPREM sempre est\u00e1 associado a um m\u00eas-base (compet\u00eancia):</p> <ul> <li><code>DT_BASE</code> (ou equivalente) \u2192 m\u00eas de refer\u00eancia do fechamento</li> </ul> <p>Uso negocial: \u00e9 o \u201ccarimbo\u201d do fechamento: posi\u00e7\u00e3o do pr\u00eamio no m\u00eas X.</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#2-chaves-do-contrato-apolicecertificado","title":"2) Chaves do contrato (ap\u00f3lice/certificado)","text":"<p>Para identificar sobre qual contrato a posi\u00e7\u00e3o est\u00e1 sendo calculada, tipicamente inclui:</p> <ul> <li>ramo (<code>COD_RAMO</code>)</li> <li>ap\u00f3lice (<code>NUM_APOL</code>)</li> <li>endosso (<code>NUM_END</code>) quando aplic\u00e1vel</li> <li>proposta/certificado (<code>NUM_PROP</code>)</li> <li>segurado / produto (dependendo do layout do seu caso)</li> </ul> <p>Uso negocial: permite \u201cposicionar\u201d a reserva por contrato e cruzar com PREMIT/PREMREC.</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#3-vigencia-e-parametros-de-competencia","title":"3) Vig\u00eancia e par\u00e2metros de compet\u00eancia","text":"<p>RESPREM costuma trazer: - in\u00edcio e fim de vig\u00eancia (base para c\u00e1lculo de risco decorrido) - datas/indicadores necess\u00e1rios para determinar o \u201cquanto do risco j\u00e1 passou\u201d</p> <p>Leitura de neg\u00f3cio: sem vig\u00eancia, n\u00e3o existe \u201cn\u00e3o ganho\u201d; o tempo \u00e9 o motor.</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#4-valores-de-reserva-e-competencia-ppng","title":"4) Valores de reserva e compet\u00eancia (PPNG)","text":"<p>O arquivo expressa valores como: - Pr\u00eamio ganho no m\u00eas / acumulado - Pr\u00eamio n\u00e3o ganho (PPNG) - ajustes (quando h\u00e1 mudan\u00e7as de vig\u00eancia, cancelamentos, endossos etc.)</p> <p>Leitura de neg\u00f3cio: o RESPREM \u00e9 a vis\u00e3o do \u201cquanto ainda est\u00e1 a decorrer\u201d e por isso deve ficar reservado.</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#para-que-serve-no-fluxo-operacional","title":"Para que serve no fluxo operacional","text":""},{"location":"coinsurance/apolice/arquivos/resprem/#1-fechamento-mensal-e-base-de-relatorios","title":"1) Fechamento mensal e base de relat\u00f3rios","text":"<p>O RESPREM \u00e9 o insumo para: - fechamento por compet\u00eancia (m\u00eas-base) - relat\u00f3rios regulat\u00f3rios/cont\u00e1beis - concilia\u00e7\u00e3o de saldo e consist\u00eancia com outras posi\u00e7\u00f5es (emitido, recebido, cancelado)</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#2-consistencia-entre-movimento-e-posicao","title":"2) Consist\u00eancia entre \u201cmovimento\u201d e \u201cposi\u00e7\u00e3o\u201d","text":"<p>Enquanto PREMIT/PREMREC descrevem movimentos (eventos): - emiss\u00e3o - endosso - cancelamento</p> <p>o RESPREM descreve posi\u00e7\u00e3o: - \u201ccomo ficou a reserva no m\u00eas X considerando todos os eventos e a vig\u00eancia\u201d</p> <p>Regra mental: movimentos mudam o estado; RESPREM mostra o resultado consolidado do m\u00eas.</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#3-integracao-com-geracao-de-ro-mensal","title":"3) Integra\u00e7\u00e3o com gera\u00e7\u00e3o de RO mensal","text":"<p>No seu fluxo Coinsurance, o RESPREM normalmente: - alimenta o c\u00e1lculo/gera\u00e7\u00e3o de retorno mensal (RO BMG) - e serve como base de consist\u00eancia para o aceito reportar a posi\u00e7\u00e3o proporcional.</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#relacoes-importantes-com-outros-arquivos-visao-de-negocio","title":"Rela\u00e7\u00f5es importantes com outros arquivos (vis\u00e3o de neg\u00f3cio)","text":""},{"location":"coinsurance/apolice/arquivos/resprem/#premit-premrec-emitido-e-parcelado","title":"PREMIT / PREMREC (emitido e parcelado)","text":"<ul> <li>PREMIT/PREMREC dizem \u201co que foi emitido e como foi parcelado\u201d</li> <li>RESPREM diz \u201cquanto desse pr\u00eamio est\u00e1 ganho vs n\u00e3o ganho no m\u00eas-base\u201d</li> </ul> <p>Um cancelamento/endosso (movimento) altera a base do RESPREM daquele m\u00eas e dos seguintes.</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#premreceb-recebido-caixa","title":"PREMRECEB (recebido / caixa)","text":"<ul> <li>PREMRECEB diz \u201co que entrou de caixa\u201d</li> <li>RESPREM diz \u201co que pode ser reconhecido como resultado (compet\u00eancia)\u201d</li> </ul> <p>Pode haver caixa sem compet\u00eancia (ainda n\u00e3o ganhou) e compet\u00eancia sem caixa (emitido a receber).</p>"},{"location":"coinsurance/apolice/arquivos/resprem/#como-interpretar-resprem-no-dia-a-dia-traducao-objetiva","title":"Como interpretar RESPREM no dia a dia (tradu\u00e7\u00e3o objetiva)","text":"<ul> <li>RESPREM = \u201cposi\u00e7\u00e3o do pr\u00eamio no m\u00eas\u201d (compet\u00eancia/reserva)</li> <li>Responde:</li> <li>\u201cqual \u00e9 a PPNG da ap\u00f3lice/certificado no m\u00eas-base?\u201d</li> <li>\u201cqual parte do pr\u00eamio j\u00e1 pode ser reconhecida como ganha?\u201d</li> <li>N\u00e3o responde \u201cpagou?\u201d (isso \u00e9 PREMRECEB)</li> </ul>"},{"location":"coinsurance/apolice/arquivos/resprem/#checklist-de-entendimento-rapido","title":"Checklist de entendimento r\u00e1pido","text":"<ul> <li>Sempre ligado a um m\u00eas-base (fechamento)</li> <li>Reflete compet\u00eancia e PPNG (reserva), n\u00e3o caixa</li> <li>Amarra contrato + vig\u00eancia + valores de posi\u00e7\u00e3o</li> <li>Serve para fechamento, regulat\u00f3rio e concilia\u00e7\u00e3o</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/","title":"Emiss\u00e3o da Ap\u00f3lice (Master/Certificate) \u2014 PREMIT + PREMREC (Coinsurance)","text":"<p>Escopo: fluxo de cria\u00e7\u00e3o/atualiza\u00e7\u00e3o da Ap\u00f3lice Definitiva no m\u00f3dulo Policy (Master Policy + Certificate Policy), a partir de PREMIT (pai) e PREMREC (parcelas/motor). Refer\u00eancias de c\u00f3digo: <code>CoinsurancePremitService.groovy</code>, <code>CoinsurancePremRecService.groovy</code> Entidades: <code>CnsPremit</code>, <code>CnsPremRec</code> Links r\u00e1pidos: PREMIT \u00b7 PREMREC \u00b7 De/Para PREMIT \u00b7 De/Para PREMREC</p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#visao-geral","title":"Vis\u00e3o geral","text":"<ul> <li>PREMIT entra como registro \u201cpai\u201d (fotografia da emiss\u00e3o/movimento) e fica PENDING.</li> <li>PREMREC entra como filho/parcelas e \u00e9 o motor operacional que:<ul> <li>Cria/atualiza Master Policy e Certificate Policy (ap\u00f3lice definitiva no m\u00f3dulo Policy)</li> <li>Processa endossos</li> <li>Dispara integra\u00e7\u00e3o BCP no p\u00f3s-emiss\u00e3o</li> <li>Atualiza status para COMPLETED quando sucesso</li> </ul> </li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#31-premit-registro-mestre-do-movimento-base-da-emissao","title":"3.1 PREMIT \u2014 Registro mestre do movimento (base da emiss\u00e3o)","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#codigo-e-entidade","title":"C\u00f3digo e entidade","text":"<ul> <li>Service: <code>CoinsurancePremitService.groovy</code></li> <li>Entidade: <code>CnsPremit</code></li> <li>Campos principais (exemplos):<ul> <li><code>BaseDate</code>, <code>MovementType</code>, <code>BranchCode</code></li> <li><code>PolicyNumber</code>, <code>EndorsementNumber</code>, <code>ProposalNumber</code></li> <li>datas de vig\u00eancia</li> <li>pr\u00eamios, comiss\u00f5es etc.</li> </ul> </li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#fluxo-real-no-codigo","title":"Fluxo real no c\u00f3digo","text":"<p>1) Ingest\u00e3o do arquivo - L\u00ea <code>PREMIT.CSV</code> em <code>uploaded/</code></p> <p>2) Valida\u00e7\u00e3o - Valida\u00e7\u00e3o de entrada (OPA/Velora) \u2014 Valida cada linha do arquivo</p> <p>3) Persist\u00eancia</p> <ul> <li><code>Salva cada linha do arquivo na estrutura CoinsurancePremit</code> com <code>Status = PENDING</code></li> </ul> <p>Comportamento importante</p> <p>O PREMIT n\u00e3o emite ap\u00f3lice sozinho. Ele funciona como registro mestre (pai) para correlacionar e orientar o processamento do PREMREC, que \u00e9 quem efetivamente cria/atualiza a ap\u00f3lice definitiva (Master/Certificate).</p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#papel-negocial-susep-operacional","title":"Papel negocial (SUSEP / operacional)","text":"<ul> <li>PREMIT representa a \u201cfotografia\u201d do movimento macro (emiss\u00e3o/endosso) com totalizadores e vig\u00eancia.</li> <li>No fluxo interno, \u00e9 a refer\u00eancia pai para o processamento de emiss\u00e3o/endosso no m\u00f3dulo Policy via PREMREC.</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#32-premrec-motor-de-emissao-mastercertificate-e-endosso","title":"3.2 PREMREC \u2014 Motor de emiss\u00e3o (Master/Certificate) e endosso","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#codigo-e-entidade_1","title":"C\u00f3digo e entidade","text":"<ul> <li>Service: <code>CoinsurancePremRecService.groovy</code></li> <li>Entidade: <code>CnsPremRec</code> (parcelas)</li> <li>Campos principais (exemplos):</li> <li><code>InstallmentNumber</code>, <code>InstallmentQuantity</code></li> <li>datas e valores por parcela</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#a-ingestao-do-premrec","title":"A) Ingest\u00e3o do PREMREC","text":"<p>1) Leitura - L\u00ea <code>PREMREC.CSV</code></p> <p>2) Valida\u00e7\u00e3o - Valida\u00e7\u00e3o de entrada (OPA/Velora) \u2014 fora deste reposit\u00f3rio</p> <p>3) Persist\u00eancia - Persiste <code>CnsPremRec</code> com <code>Status = PENDING</code></p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#b-processamento-criacaoalteracao-da-apolice-definitiva","title":"B) Processamento (cria\u00e7\u00e3o/altera\u00e7\u00e3o da ap\u00f3lice definitiva)","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#b1-selecao-do-pai-premit-e-dos-filhos-premrec","title":"B.1 Sele\u00e7\u00e3o do \u201cpai\u201d (PREMIT) e dos \u201cfilhos\u201d (PREMREC)","text":"<p>O service busca PREMIT pendentes e, para cada pai, busca os PREMREC pendentes correspondentes usando a chave:</p> <ul> <li>Chave de correla\u00e7\u00e3o (no pr\u00f3prio c\u00f3digo):</li> <li><code>MovementType + PolicyNumber + EndorsementNumber + ProposalNumber + Status = PENDING</code></li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#validacoes-e-decisoes-como-o-codigo-decide","title":"Valida\u00e7\u00f5es e decis\u00f5es (como o c\u00f3digo decide)","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#1-segurado-party-precisa-existir","title":"1) Segurado (Party) precisa existir","text":"<ul> <li>Antes de emitir, o fluxo busca party no cadastro por documento (CPF/CNPJ).</li> <li>Se n\u00e3o existir: falha (gera erro no fluxo).</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#2-produto-precisa-existir-na-rate-table","title":"2) Produto precisa existir na rate table","text":"<ul> <li>Lookup em <code>BMG_PolicyProduct</code> por:</li> <li><code>LeaderPolicyNo (PolicyNumber)</code> + <code>CdProduto (ProductCode)</code></li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#3-master-policy-apolice-master-pre-condicao-para-o-certificate","title":"3) Master Policy (ap\u00f3lice master) \u2014 pr\u00e9-condi\u00e7\u00e3o para o Certificate","text":"<ul> <li><code>fetchMasterPolicy(leaderPolicyNo)</code> busca <code>Policy</code> no m\u00f3dulo \u201cPolicy\u201d por:</li> <li><code>LeaderPolicyNo</code></li> <li><code>PolicyType = MASTER</code></li> <li><code>PolicyStatus = ISSUED</code></li> <li><code>FullOrgCode = tenant</code></li> <li>Se movimento for de emiss\u00e3o e master n\u00e3o existir: cria master (issuance)</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#4-certificate-policy-certificado-apolice-definitiva-emitida-para-o-segurado","title":"4) Certificate Policy (certificado) \u2014 ap\u00f3lice definitiva emitida para o segurado","text":"<ul> <li>Checa se certificado j\u00e1 existe: <code>existPolicyIssued(...)</code></li> <li>Se existe: trata como duplicado</li> <li>Se n\u00e3o existe: cria certificate e integra BCP</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#5-endosso","title":"5) Endosso","text":"<ul> <li>Para <code>MovementType &gt; 102</code>, usa <code>processEndorsementIssuance(...)</code></li> <li>Mapeamento de movimentos (101\u2013108) para <code>endoType</code> via <code>CnsPremRec.getEndoType()</code>:</li> </ul> MovementType (TIPO_MOV) Descri\u00e7\u00e3o (SUSEP / Layout) O que significa na pr\u00e1tica endoType (se aplic\u00e1vel) 101 Emiss\u00e3o de Ap\u00f3lice Cria\u00e7\u00e3o da ap\u00f3lice/certificado (emiss\u00e3o inicial) \u2014 102 Endosso de cobran\u00e7a adicional de pr\u00eamio Endosso que aumenta pr\u00eamio (cobran\u00e7a complementar) \u2014 103 Endosso de restitui\u00e7\u00e3o de pr\u00eamio Endosso que reduz pr\u00eamio e gera restitui\u00e7\u00e3o 37 104 Cancelamento de Ap\u00f3lice com restitui\u00e7\u00e3o de pr\u00eamio Cancela a ap\u00f3lice e devolve pr\u00eamio 51 105 Cancelamento de Endosso com restitui\u00e7\u00e3o de pr\u00eamio Cancela um endosso e devolve pr\u00eamio 17 106 Cancelamento de Ap\u00f3lice sem restitui\u00e7\u00e3o de pr\u00eamio Cancela a ap\u00f3lice sem devolu\u00e7\u00e3o de pr\u00eamio 50 107 Cancelamento de Endosso sem restitui\u00e7\u00e3o de pr\u00eamio Cancela um endosso sem devolu\u00e7\u00e3o de pr\u00eamio 3 108 Endosso sem movimenta\u00e7\u00e3o de pr\u00eamio Endosso que altera condi\u00e7\u00f5es sem mexer no pr\u00eamio 20 109 Transfer\u00eancia de carteira Movimenta\u00e7\u00e3o para transfer\u00eancia de carteira (quando aplic\u00e1vel no layout) \u2014 <p>Nota importante (layout x implementa\u00e7\u00e3o)</p> <p>A tabela acima reflete a leitura negocial (layout SUSEP). O <code>endoType</code> reflete o que o c\u00f3digo implementa em <code>getEndoType()</code> e pode n\u00e3o cobrir todos os cen\u00e1rios como o layout descreve.</p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#integracao-com-bcp-pos-emissao","title":"Integra\u00e7\u00e3o com BCP (p\u00f3s-emiss\u00e3o)","text":"<p>Ap\u00f3s emiss\u00e3o, executa <code>integrateBcpAfterPolicyIssuance(policy)</code>:</p> <p>1) Gera taxa/fee: <code>GenerateFeeService</code> 2) Carrega <code>PolicyFeeInfo</code> 3) Monta payload 4) Envia via <code>DirectPostFeeReceiver</code></p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#atualizacao-de-status-sucesso-vs-erro","title":"Atualiza\u00e7\u00e3o de status (sucesso vs erro)","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#sucesso","title":"Sucesso","text":"<ul> <li>Se processou OK:</li> <li>Atualiza PREMREC e PREMIT relacionados para <code>COMPLETED</code></li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#erro","title":"Erro","text":"<ul> <li><code>processParentAndChildrenAsError(...)</code> monta erro e grava <code>CnsError</code></li> <li>Ponto cr\u00edtico: as linhas que atualizariam PREMREC/PREMIT para <code>ERROR/DUPLICATED</code> est\u00e3o comentadas (TODO)</li> </ul> <p>Risco operacional</p> <p>Se o update para <code>ERROR/DUPLICATED</code> est\u00e1 comentado, registros podem ficar eternamente <code>PENDING</code> e serem reprocessados continuamente.</p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#tabelas-de-decisao-resumo-do-motor-premrec","title":"Tabelas de decis\u00e3o (resumo do motor PREMREC)","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#a-emissao-master-certificate","title":"A) Emiss\u00e3o / Master / Certificate","text":"Condi\u00e7\u00e3o A\u00e7\u00e3o principal Resultado esperado Party n\u00e3o existe Bloqueia emiss\u00e3o Erro registrado (<code>CnsError</code>) Produto n\u00e3o existe em rate table Bloqueia emiss\u00e3o Erro registrado (<code>CnsError</code>) Emiss\u00e3o + Master n\u00e3o existe Criar Master <code>Policy (MASTER)</code> emitida Certificate j\u00e1 existe (ISSUED) Tratar como duplicado (deveria marcar DUPLICATED, mas pode ficar PENDING) Certificate n\u00e3o existe Criar Certificate + integrar BCP Ap\u00f3lice emitida + fee/p\u00f3s-issue"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate/#b-endosso","title":"B) Endosso","text":"Condi\u00e7\u00e3o A\u00e7\u00e3o principal <code>MovementType &gt; 102</code> <code>processEndorsementIssuance(...)</code> <code>MovementType 101\u2013108</code> <code>getEndoType()</code> define <code>endoType</code>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/","title":"Recebimento de Pr\u00eamio \u2014 PREMRECEB (Coinsurance)","text":"<p>Escopo: registrar o pr\u00eamio recebido (por parcela) e materializar o recebimento no BCP como Payment (boleto pago), amarrado \u00e0 ap\u00f3lice Certificate (e ao Endorsement, quando aplic\u00e1vel). Refer\u00eancias de c\u00f3digo: <code>CoinsurancePremRecebService</code> Entidades: <code>CnsPremReceb</code> (ingest\u00e3o) + integra\u00e7\u00e3o BCP (<code>Payment</code>, <code>PaymentDetail</code>)</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#visao-geral","title":"Vis\u00e3o geral","text":"<ul> <li>PREMRECEB representa, no neg\u00f3cio, o evento de recebimento do pr\u00eamio (normalmente por boleto) \u2014 isto \u00e9: pagou.</li> <li>No fluxo interno, ele funciona como \u201cponte\u201d entre:</li> <li>o mundo SUSEP/arquivo (parcela recebida + dados banc\u00e1rios + valores)</li> <li>e o mundo operacional (registrar no BCP como <code>Payment</code> com status Paid).</li> <li>Diferente do PREMREC (parcelamento/cronograma), o PREMRECEB \u00e9 o realizado: comprova\u00e7\u00e3o/registro de recebimento.</li> </ul>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#o-que-e-o-premreceb-no-negocio-susep-operacional","title":"O que \u00e9 o PREMRECEB no neg\u00f3cio (SUSEP / operacional)","text":""},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#o-que-ele-representa","title":"O que ele representa","text":"<p>Um registro de pr\u00eamio efetivamente recebido, por parcela, contendo:</p> <ul> <li> <p>a chave de neg\u00f3cio (ramo, ap\u00f3lice, endosso, proposta, movimento)</p> </li> <li> <p>dados de parcela (n\u00famero, vencimento, data de recebimento)</p> </li> <li> <p>dados de cobran\u00e7a (boleto, nosso n\u00famero, documento, ag\u00eancia, banco)</p> </li> <li> <p>valores do t\u00edtulo (valor do documento, desconto, multa, valor cobrado)</p> </li> </ul>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#para-que-ele-serve","title":"Para que ele serve","text":"<p>Negocialmente, serve para:</p> <ul> <li> <p>dar baixa financeira (parcela paga)</p> </li> <li> <p>permitir concilia\u00e7\u00e3o entre:</p> <ul> <li> <p>emitido/parcelado (PREMREC)</p> </li> <li> <p>recebido (PREMRECEB)</p> </li> </ul> </li> <li> <p>acionar a camada operacional (no seu caso, BCP) para registrar o pagamento como Payment Paid.</p> </li> </ul>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#41-premreceb-recebimento-do-premio-por-parcela","title":"4.1 PREMRECEB \u2014 Recebimento do pr\u00eamio (por parcela)","text":""},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#codigo-e-entidade","title":"C\u00f3digo e entidade","text":"<ul> <li>Service: <code>CoinsurancePremRecebService</code></li> <li>Entidade: <code>CnsPremReceb</code></li> </ul> <p>Valida\u00e7\u00e3o de entrada (OPA/Velora)</p> <p>O service chama <code>veloraService.validate(\"bmg_prereceb\", mapData)</code>. As policies OPA/Velora ficam fora deste reposit\u00f3rio.</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#a-ingestao-do-premreceb","title":"A) Ingest\u00e3o do PREMRECEB","text":""},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#1-leitura-do-arquivo-s3","title":"1) Leitura do arquivo (S3)","text":"<p>O service lista arquivos pendentes via: - <code>s3FileService.listPendingProcessFiles(s3FileService.PREMRECEB)</code></p> <p>Para cada arquivo: - l\u00ea o conte\u00fado (<code>getResponseBundleFromKey</code>) - transforma em bytes UTF-8 - faz parse CSV com delimitador <code>|</code>:   - <code>csvReader.readFile(\"|\", bytes)</code></p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#2-mapeamento-csv-entidade-cnspremreceb","title":"2) Mapeamento CSV \u2192 Entidade (<code>CnsPremReceb</code>)","text":"<p>O mapeamento \u00e9 feito por <code>mapper</code> no c\u00f3digo (tabela completa em De/Para).</p> <p>Al\u00e9m disso, o c\u00f3digo: - carrega <code>declaredFields</code> da entidade para cast tipado (<code>castValue(...)</code>) - injeta defaults (Status, FileId, FileName)</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#3-validacao-de-entrada","title":"3) Valida\u00e7\u00e3o de entrada","text":"<p>Para cada linha do arquivo (<code>mapData</code>): - <code>veloraService.validate(\"bmg_prereceb\", mapData)</code> - Se v\u00e1lido: <code>coinsuranceRepository.insertPremReceb(entity)</code> - Se inv\u00e1lido: <code>processAsError(...)</code> (gera <code>CnsError</code>)</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#4-pos-processamento-do-arquivo-movedelete","title":"4) P\u00f3s-processamento do arquivo (move/delete)","text":"<p>Depois de processar o arquivo: - move para:   - <code>processed/</code> se n\u00e3o houve erro   - <code>error/</code> se houve erro - e apaga o original (<code>deleteFile(key)</code>)</p> <p>Risco operacional (marca\u00e7\u00e3o de erro do arquivo)</p> <p>No c\u00f3digo atual, a vari\u00e1vel <code>hasError</code> depende do resultado de valida\u00e7\u00e3o ao longo do loop. Se houver mistura de linhas v\u00e1lidas e inv\u00e1lidas, a decis\u00e3o de mover o arquivo inteiro para <code>processed/</code> ou <code>error/</code> pode ficar inconsistente.</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#b-processamento-dos-registros-pendentes-materializar-pagamento","title":"B) Processamento dos registros pendentes (materializar pagamento)","text":"<p>Ap\u00f3s a ingest\u00e3o, o service processa registros <code>PENDING</code> a partir do \u00edndice: - <code>coinsuranceRepository.searchByModuleAndStatusFromIndex(CnsPremRecebEntity, PENDING)</code> - para cada registro: <code>processEntity(entity)</code></p> <p>O objetivo dessa etapa \u00e9:</p> <p>1) localizar a ap\u00f3lice definitiva (Master/Certificate) no m\u00f3dulo Policy</p> <p>2) localizar endosso (quando aplic\u00e1vel)</p> <p>3) registrar o recebimento no BCP como Payment Paid</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#validacoes-e-decisoes-como-o-codigo-decide","title":"Valida\u00e7\u00f5es e decis\u00f5es (como o c\u00f3digo decide)","text":""},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#1-master-policy-precisa-existir","title":"1) Master Policy precisa existir","text":"<p>O c\u00f3digo tenta localizar a master: - <code>fetchMasterPolicy(entity.PolicyNumber)</code></p> <p>Se n\u00e3o existir: - erro: \u201cN\u00e3o existe uma Master Policy para a ap\u00f3lice \u2026\u201d - <code>processAsError(entity, ERROR, ...)</code></p> <p>Ponto cr\u00edtico do c\u00f3digo (TODO/hardcode)</p> <p>No c\u00f3digo atual, <code>fetchMasterPolicy(...)</code> est\u00e1 com TODO e usa <code>LeaderPolicyNo</code> hardcoded, em vez de usar plenamente o <code>entity.PolicyNumber</code>.</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#2-certificate-policy-emitida-precisa-existir","title":"2) Certificate Policy emitida precisa existir","text":"<p>O c\u00f3digo valida se existe certificate emitida (no contexto da master): - <code>existPolicyIssued(masterPolicy, entity)</code></p> <p>Se n\u00e3o existir: - erro: \u201cN\u00e3o existe uma ap\u00f3lice criada para o ramo\u2026, ap\u00f3lice\u2026, proposta\u2026\u201d - <code>processAsError(entity, ERROR, ...)</code></p> <p>Ponto cr\u00edtico do c\u00f3digo (TODO/hardcode)</p> <p><code>existPolicyIssued(...)</code> tamb\u00e9m cont\u00e9m TODO e, no estado atual, utiliza valores hardcoded para busca (ex.: ramo e leader policy).</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#3-carrega-a-primeira-certificate-para-obter-policyno","title":"3) Carrega a primeira Certificate (para obter PolicyNo)","text":"<ul> <li><code>fetchFirstCertificate(masterPolicy, entity)</code></li> </ul> <p>Se n\u00e3o achar: - erro de \u201cN\u00e3o encontrada ap\u00f3lice para o ramo\u2026, ap\u00f3lice\u2026, proposta\u2026\u201d</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#4-endorsement-para-obter-endono","title":"4) Endorsement (para obter EndoNo)","text":"<ul> <li><code>fetchFirstEndorsement(certificatePolicy, entity)</code></li> </ul> <p>Ponto cr\u00edtico do c\u00f3digo (TODO/hardcode)</p> <p><code>fetchFirstEndorsement(...)</code> est\u00e1 com TODO e faz buscas com IDs/PolicyNo hardcoded. Isso impacta diretamente a capacidade de amarrar o recebimento ao endosso correto.</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#integracao-com-bcp-registro-do-pagamento","title":"Integra\u00e7\u00e3o com BCP (registro do pagamento)","text":"<p>Se passou nas valida\u00e7\u00f5es, o c\u00f3digo monta um <code>Payment</code> e envia para o BCP: - <code>paymentApi().newSinglePaymentRequestBuilder().payment(payments).doRequest()</code></p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#como-o-premreceb-vira-payment-no-bcp","title":"Como o PREMRECEB vira <code>Payment</code> no BCP","text":"<ul> <li><code>Payment.paymentMethod = \"70\"</code> \u2192 boleto</li> <li><code>Payment.paymentStatus = \"3\"</code> \u2192 Paid</li> <li><code>Payment.paymentType = \"1\"</code> \u2192 Direct Billing</li> <li><code>Payment.currencyCode = \"BRL\"</code></li> <li><code>Payment.policyNo = certificatePolicy.policyNo</code></li> <li><code>Payment.endoNo = endo.endoNo</code> (se encontrado)</li> </ul>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#atualizacao-de-status-sucesso-vs-erro","title":"Atualiza\u00e7\u00e3o de status (sucesso vs erro)","text":""},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#sucesso","title":"Sucesso","text":"<ul> <li>O c\u00f3digo retorna <code>processedSuccessfully = true</code>.</li> <li>Mas o registro <code>CnsPremReceb</code> n\u00e3o \u00e9 marcado como <code>COMPLETED</code> (n\u00e3o h\u00e1 update efetivo persistido nessa etapa).</li> </ul>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#erro","title":"Erro","text":"<ul> <li><code>processAsError(...)</code>:</li> <li>seta <code>entity.Status = ERROR</code></li> <li>n\u00e3o persiste a mudan\u00e7a (update est\u00e1 comentado): <code>// TODO coinsuranceRepository.updatePremReceb(entity)</code></li> <li>grava <code>CnsError</code> (com <code>Status = COMPLETED</code>)</li> </ul> <p>Risco operacional (reprocessamento infinito)</p> <p>Como o <code>updatePremReceb(...)</code> est\u00e1 comentado, registros podem permanecer PENDING no \u00edndice e serem reprocessados continuamente, mesmo ap\u00f3s erro/sucesso.</p>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#depara-csv-arquivo-fisico-entidade-cnspremreceb","title":"De/Para \u2014 CSV (arquivo f\u00edsico) \u2192 Entidade (<code>CnsPremReceb</code>)","text":"<p>Fonte: <code>Map&lt;String, String&gt; mapper</code> no <code>CoinsurancePremRecebService</code></p> Campo no arquivo (CSV) Campo salvo na entidade <code>SEQUENCIA</code> <code>RecordNo</code> <code>COD_CIA</code> <code>CompanyCode</code> <code>DT_BASE</code> <code>BaseDate</code> <code>TIPO_MOV</code> <code>MovementType</code> <code>COD_RAMO</code> <code>BranchCode</code> <code>NUM_APOL</code> <code>PolicyNumber</code> <code>NUM_END</code> <code>EndorsementNumber</code> <code>NUM_PROP</code> <code>ProposalNumber</code> <code>DT_PROP</code> <code>ProposalDate</code> <code>PRESTACAO</code> <code>InstallmentNumber</code> <code>DT_REC_PRE</code> <code>InstallmentReceiptDate</code> <code>DT_VEN_PRE</code> <code>InstallmentDueDate</code> <code>NUM_BAN</code> <code>BankNumber</code> <code>CNPJ_BAN</code> <code>BankDocumentId</code> <code>NUM_BOL</code> <code>TicketNumber</code> <code>NUM_DOC</code> <code>DocumentNumber</code> <code>NUM_AGE</code> <code>AgencyNumber</code> <code>NUM_NOS</code> <code>OurNumber</code> <code>VAL_DOC</code> <code>DocumentValue</code> <code>VAL_DESC</code> <code>DiscountValue</code> <code>VAL_MUL</code> <code>FineValue</code> <code>VAL_COB</code> <code>ChargedValue</code> <code>DS_GRUPO_RAMO</code> <code>BranchGroupDescription</code> <code>CD_PRODUTO</code> <code>ProductCode</code> <code>DS_PRODUTO</code> <code>ProductDescription</code> <code>CD_BU</code> <code>BusinessUnitCode</code> <code>DS_BU</code> <code>BusinessUnitDescription</code> <code>CD_OPERACAO</code> <code>OperationCode</code> <code>CD_CARTEIRA</code> <code>WalletCode</code> <code>DS_CARTEIRA</code> <code>WalletDescription</code> <code>CD_SUCURSAL</code> <code>SucursalCode</code> <code>FG_GEB</code> <code>FgGeb</code> <code>DCR_TIP_OPER</code> <code>OperationDescription</code> <code>DS_ORIGEM</code> <code>OriginDescription</code>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#depara-defaults-e-rastreabilidade-como-o-registro-e-carimbado","title":"De/Para \u2014 Defaults e rastreabilidade (como o registro \u00e9 \u201ccarimbado\u201d)","text":"Campo interno Como \u00e9 preenchido no c\u00f3digo <code>Status</code> <code>PENDING</code> <code>FileName</code> nome do arquivo (<code>key.split(\"/\").last()</code>) <code>FileId</code> <code>\"{etagSemAspas}_{RecordNo}\"</code>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#depara-entidade-bcp-payment-como-o-recebido-e-operacionalizado","title":"De/Para \u2014 Entidade \u2192 BCP Payment (como o \u201crecebido\u201d \u00e9 operacionalizado)","text":"Origem Campo Destino BCP <code>CnsPremReceb</code> <code>DocumentValue</code> <code>Payment.amount</code> e <code>PaymentDetail.amount</code> <code>CnsPremReceb</code> <code>BankNumber</code> <code>Payment.bankCode</code> <code>CnsPremReceb</code> <code>OurNumber</code> <code>Payment.bankAccountNo</code> <code>CnsPremReceb</code> <code>AgencyNumber</code> <code>Payment.insurerAccountCode</code> <code>CnsPremReceb</code> <code>TicketNumber</code> <code>Payment.paymentNo</code> <code>Certificate Policy</code> <code>policyNo</code> <code>Payment.policyNo</code> <code>Endorsement</code> <code>endoNo</code> <code>Payment.endoNo</code> Constante <code>\"70\"</code> <code>Payment.paymentMethod</code> (boleto) Constante <code>\"3\"</code> <code>Payment.paymentStatus</code> (Paid) Constante <code>\"1\"</code> <code>Payment.paymentType</code> (Direct Billing) Constante <code>\"BRL\"</code> <code>Payment.currencyCode</code> / <code>PaymentDetail.currencyCode</code>"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#tabelas-de-decisao-resumo-do-motor-premreceb","title":"Tabelas de decis\u00e3o (resumo do motor PREMRECEB)","text":""},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#a-pre-condicoes-para-registrar-pagamento","title":"A) Pr\u00e9-condi\u00e7\u00f5es para registrar pagamento","text":"Condi\u00e7\u00e3o A\u00e7\u00e3o Resultado Master Policy n\u00e3o encontrada <code>processAsError(ERROR)</code> N\u00e3o registra no BCP Certificate emitida n\u00e3o existe <code>processAsError(ERROR)</code> N\u00e3o registra no BCP Certificate n\u00e3o carregou <code>processAsError(ERROR)</code> N\u00e3o registra no BCP Tudo OK Monta <code>Payment</code> e chama BCP Registra <code>Payment</code> como Paid"},{"location":"coinsurance/apolice/fluxos/recebimento-premio-premreceb/#pontos-pendentesincompletos-no-codigo-impacto-direto-no-negocio","title":"Pontos pendentes/incompletos no c\u00f3digo (impacto direto no neg\u00f3cio)","text":"<p>1) Lookup de ap\u00f3lice com valores hardcoded (TODO) - Master/Certificate/Endorsement ainda n\u00e3o usam plenamente a chave do arquivo (<code>BranchCode</code>, <code>PolicyNumber</code>, <code>EndorsementNumber</code>, <code>ProposalNumber</code>).</p> <p>2) Status do registro n\u00e3o \u00e9 atualizado - <code>updatePremReceb(entity)</code> est\u00e1 comentado, ent\u00e3o o registro pode permanecer <code>PENDING</code> e reprocessar indefinidamente.</p> <p>3) Marca\u00e7\u00e3o de sucesso do arquivo pode ser inconsistente - A decis\u00e3o de mover para <code>processed/</code> ou <code>error/</code> pode n\u00e3o refletir corretamente um arquivo com linhas mistas (v\u00e1lidas e inv\u00e1lidas).</p>"},{"location":"coinsurance/apolice/mapeamentos/mapeamentos-internos/","title":"Ap\u00f3lice \u2014 Mapeamentos internos (Policy / CoinsuranceInfo / Coverage)","text":"<p>Origem: <code>CoinsurancePremRecService.groovy</code> (m\u00e9todos de montagem de ap\u00f3lice/endosso)</p>"},{"location":"coinsurance/apolice/mapeamentos/mapeamentos-internos/#a-policyinfo-campos-adicionais-no-policyendosso","title":"A) PolicyInfo (campos adicionais no Policy/Endosso)","text":"Chave no PolicyInfo Origem (entidade) Destino AdjustedPremium entity.FractionalSurchargeValue Policy/Endosso (campos adicionais no PolicyInfo). DuePremium entity.IssuedPremium Policy/Endosso (campos adicionais no PolicyInfo). GrossPremium entity.PolicyCostValue Policy/Endosso (campos adicionais no PolicyInfo). Commission entity.CoinsuranceCommissionAmount Policy/Endosso (campos adicionais no PolicyInfo). CommissionLocal entity.BrokerageCommissionAmount Policy/Endosso (campos adicionais no PolicyInfo). OriginalFileName entity.FileName Policy/Endosso (campos adicionais no PolicyInfo). EffectiveDate entity.EffectiveDate Policy/Endosso (campos adicionais no PolicyInfo). ExpiryDate entity.EndDate Policy/Endosso (campos adicionais no PolicyInfo). IssueDate entity.IssueDate Policy/Endosso (campos adicionais no PolicyInfo). TipoMov entity.MovementType Policy/Endosso (campos adicionais no PolicyInfo). DtBase entity.BaseDate Policy/Endosso (campos adicionais no PolicyInfo). CdProduto entity.ProductCode Policy/Endosso (campos adicionais no PolicyInfo). DsProduto entity.ProductDescription Policy/Endosso (campos adicionais no PolicyInfo). CdBu entity.BusinessUnitCode Policy/Endosso (campos adicionais no PolicyInfo). DsBu entity.BusinessUnitDescription Policy/Endosso (campos adicionais no PolicyInfo). CdOperacao entity.OperationCode Policy/Endosso (campos adicionais no PolicyInfo). CdCarteira entity.WalletCode Policy/Endosso (campos adicionais no PolicyInfo). DsCarteira entity.WalletDescription Policy/Endosso (campos adicionais no PolicyInfo). CdSucursal entity.SucursalCode Policy/Endosso (campos adicionais no PolicyInfo). FgGeb entity.FgGeb Policy/Endosso (campos adicionais no PolicyInfo). DcrTipOper entity.OperationDescription Policy/Endosso (campos adicionais no PolicyInfo). DsOrigem entity.OriginDescription Policy/Endosso (campos adicionais no PolicyInfo). DsGrupoRamo entity.BranchGroupDescription Policy/Endosso (campos adicionais no PolicyInfo). UFDep entity.IssuingState Policy/Endosso (campos adicionais no PolicyInfo). UFRisco entity.RiskStates Policy/Endosso (campos adicionais no PolicyInfo). CodCiaLider entity.CompanyCode Policy/Endosso (campos adicionais no PolicyInfo). NumProcLider entity.Protocol Policy/Endosso (campos adicionais no PolicyInfo)."},{"location":"coinsurance/apolice/mapeamentos/mapeamentos-internos/#b-coinsuranceinfo-lista","title":"B) CoinsuranceInfo (lista)","text":"Chave no CoinsuranceInfo Origem (entidade) Destino"},{"location":"coinsurance/apolice/mapeamentos/mapeamentos-internos/#c-coverage-coberturas","title":"C) Coverage (coberturas)","text":"Campo no Coverage Origem (entidade) Destino SumInsured entity.IsValue Coverage (itens/coberturas no endorsement). SequenceNumber entity.Sequence Coverage (itens/coberturas no endorsement). SequenceBMG entity.RecordNo Coverage (itens/coberturas no endorsement). OverrideBeforeVatPremium entity.IssuedPremium Coverage (itens/coberturas no endorsement). OverrideVat entity.TaxAmount Coverage (itens/coberturas no endorsement). OverrideCommission entity.BrokerageCommissionAmount Coverage (itens/coberturas no endorsement). AdFracLider entity.FractionalSurchargeValue Coverage (itens/coberturas no endorsement). CustApol entity.PolicyCostValue Coverage (itens/coberturas no endorsement). LaborAmountLider entity.ProLaboreValue Coverage (itens/coberturas no endorsement). PrCosCed entity.CededCoinsurancePremium Coverage (itens/coberturas no endorsement). ComisCoss entity.CoinsuranceCommissionAmount Coverage (itens/coberturas no endorsement). <p>Note</p> <p>Esses mapeamentos s\u00e3o internos (n\u00e3o v\u00eam diretamente do CSV). Eles s\u00e3o gerados no processamento do PREMREC ao montar ap\u00f3lice/endosso.</p>"},{"location":"coinsurance/apolice/mapeamentos/policy/","title":"Mapeamento \u2014 Arquivos SUSEP (Coinsurance) \u2192 Policy (Estrutura Definitiva)","text":"<p>Objetivo: mapear, de forma operacional, onde cada campo dos arquivos (PREMIT/PREMREC/PREMRECEB/RESPREM) aparece na Policy (estrutura definitiva) no InsureMO.</p> <p>Refer\u00eancias de c\u00f3digo (core):</p> <ul> <li> <p><code>CoinsurancePremitService.groovy</code> (ingest\u00e3o/valida\u00e7\u00e3o/persist\u00eancia do PREMIT)</p> </li> <li> <p><code>CoinsurancePremRecService.groovy</code> (motor de emiss\u00e3o/endosso e montagem da Policy)</p> </li> <li> <p><code>CoinsurancePremRecebService.groovy</code> (recebimento do pr\u00eamio)</p> </li> <li> <p><code>CoinsuranceResPremService.groovy</code> (reserva/compet\u00eancia \u2013 PPNG)</p> </li> </ul>"},{"location":"coinsurance/apolice/mapeamentos/policy/#1-policy-root-campos-de-cabecalho","title":"1) Policy (root) \u2014 campos de cabe\u00e7alho","text":"<p>Esses campos ficam diretamente no objeto <code>Policy</code> (n\u00edvel raiz) e normalmente v\u00eam do PREMIT (e em alguns casos do fluxo de emiss\u00e3o do motor).</p> Campo no arquivo Significado (neg\u00f3cio) Onde fica na Policy (JSON path) Fonte principal <code>COD_CIA</code> C\u00f3digo SUSEP da cia (l\u00edder no arquivo) <code>Policy.CodCiaLider</code> PREMIT <code>NUM_PROC</code> N\u00famero de processo SUSEP <code>Policy.NumProcLider</code> PREMIT <code>DT_BASE</code> Compet\u00eancia/m\u00eas base <code>Policy.DtBase</code> PREMIT <code>TIPO_MOV</code> Tipo de movimento SUSEP <code>Policy.TipoMov</code> PREMIT <code>UF_DEP</code> UF de depend\u00eancia/origem <code>Policy.UFDep</code> PREMIT <code>UF_RISCO</code> UF de risco <code>Policy.UFRisco</code> PREMIT <code>DS_GRUPO_RAMO</code> Identifica\u00e7\u00e3o do grupo de ramo <code>Policy.DsGrupoRamo</code> PREMIT/PREMREC <code>CD_PRODUTO</code> C\u00f3digo do produto <code>Policy.CdProduto</code> PREMIT/PREMREC <code>DS_PRODUTO</code> Descri\u00e7\u00e3o do produto <code>Policy.DsProduto</code> PREMIT/PREMREC <code>CD_BU</code> BU/canal <code>Policy.CdBu</code> PREMIT/PREMREC <code>DS_BU</code> Descri\u00e7\u00e3o BU/canal <code>Policy.DsBu</code> PREMIT/PREMREC <code>CD_OPERACAO</code> Opera\u00e7\u00e3o <code>Policy.CdOperacao</code> PREMIT/PREMREC <code>CD_CARTEIRA</code> Carteira <code>Policy.CdCarteira</code> PREMIT/PREMREC <code>DS_CARTEIRA</code> Nome carteira <code>Policy.DsCarteira</code> PREMIT/PREMREC <code>CD_SUCURSAL</code> Sucursal <code>Policy.CdSucursal</code> PREMIT/PREMREC <code>FG_GEB</code> Flag GEB <code>Policy.FgGeb</code> PREMIT/PREMREC <code>DCR_TIP_OPER</code> Descri\u00e7\u00e3o tipo opera\u00e7\u00e3o <code>Policy.DcrTipOper</code> PREMIT/PREMREC <code>DS_ORIGEM</code> Origem/canal <code>Policy.DsOrigem</code> PREMIT/PREMREC"},{"location":"coinsurance/apolice/mapeamentos/policy/#datas-principais-do-risco-vigencia-emissao","title":"Datas \u201cprincipais\u201d do risco (vig\u00eancia / emiss\u00e3o)","text":"Campo no arquivo Significado Onde fica na Policy Fonte principal <code>DT_INI_VIG</code> In\u00edcio de vig\u00eancia do risco <code>Policy.EffectiveDate</code> PREMIT/PREMREC/RESPREM <code>DT_FIM_VIG</code> Fim de vig\u00eancia do risco <code>Policy.ExpiryDate</code> PREMIT/PREMREC/RESPREM <code>DT_EMIS</code> / <code>DT_EMIS_PR</code> Data de emiss\u00e3o (ap\u00f3lice / parcela) <code>Policy.IssueDate</code> (quando aplic\u00e1vel) PREMIT/PREMREC <p>Observa\u00e7\u00e3o pr\u00e1tica: <code>MasterPolicyNo</code>, <code>PolicyNo</code>, <code>PolicyId</code>, <code>MasterPolicyId</code> e afins n\u00e3o v\u00eam do arquivo \u2014 s\u00e3o gerados pelo motor de emiss\u00e3o (InsureMO) e retornam na Policy.</p>"},{"location":"coinsurance/apolice/mapeamentos/policy/#2-coinsuranceinfolist-amarracao-do-cosseguro","title":"2) CoInsuranceInfoList \u2014 amarra\u00e7\u00e3o do cosseguro","text":"<p>A Policy guarda as informa\u00e7\u00f5es de cosseguro em <code>CoInsuranceInfoList</code>.</p>"},{"location":"coinsurance/apolice/mapeamentos/policy/#21-chaves-do-lider-apoliceendossoproposta","title":"2.1 Chaves do l\u00edder (ap\u00f3lice/endosso/proposta)","text":"Campo no arquivo Significado Onde fica na Policy Fonte <code>NUM_APOL</code> Ap\u00f3lice no l\u00edder <code>Policy.CoInsuranceInfoList[0].LeaderPolicyNo</code> PREMIT/PREMREC <code>NUM_END</code> Endosso no l\u00edder <code>Policy.CoInsuranceInfoList[0].LeaderEndorsementNo</code> PREMIT/PREMREC <code>NUM_PROP</code> Proposta no l\u00edder <code>Policy.CoInsuranceInfoList[0].LeaderProposalNo</code> PREMIT/PREMREC <code>DT_PROP</code> Data da proposta <code>Policy.CoInsuranceInfoList[0].LeaderProposalDate</code> PREMIT/PREMREC"},{"location":"coinsurance/apolice/mapeamentos/policy/#22-participacao-da-aceita-coseguradora","title":"2.2 Participa\u00e7\u00e3o da aceita (Coseguradora)","text":"Campo no arquivo Significado Onde fica na Policy Fonte <code>PERC_COSS</code> Percentual do cosseguro <code>Policy.CoInsuranceInfoList[0].PercCoss</code> PREMREC <code>OFER</code> Oferta/indicador operacional <code>Policy.CoInsuranceInfoList[0].Ofer</code> PREMREC <code>COLET</code> Colet/indicador operacional <code>Policy.CoInsuranceInfoList[0].Colet</code> PREMREC (fixo no c\u00f3digo) C\u00f3digo do cossegurador l\u00edder (refer\u00eancia) <code>Policy.CoInsuranceInfoList[0].CodCoss</code> Hardcoded"},{"location":"coinsurance/apolice/mapeamentos/policy/#23-coinsuranceinsurerlist-lista-de-seguradoras-lideraceita","title":"2.3 CoInsuranceInsurerList \u2014 lista de seguradoras (l\u00edder/aceita)","text":"<p>No JSON de Policy, os dados SUSEP das seguradoras aparecem dentro de <code>CoInsuranceInsurerList[*]</code>.</p> Campo no arquivo Onde fica Interpreta\u00e7\u00e3o <code>COD_CIA</code> / <code>NUM_PROC</code> <code>...CoInsuranceInsurerList[*].CodCia</code> / <code>...NumProc</code> No fluxo, normalmente alimenta o registro da seguradora l\u00edder. (fixo / cadastro) <code>...CoInsuranceInsurerList[*]</code> do cossegurador A seguradora aceita costuma ser definida por configura\u00e7\u00e3o/cadastro (ex.: <code>03417</code> + processo espec\u00edfico)."},{"location":"coinsurance/apolice/mapeamentos/policy/#3-policycustomerlist-segurado-tomador-estipulante","title":"3) PolicyCustomerList \u2014 segurado, tomador, estipulante","text":"<p>O arquivo ancora principalmente documentos (CPF/CNPJ) e alguns indicadores. Dados como nome, endere\u00e7o, sexo, data de nascimento geralmente v\u00eam do cadastro/party (lookup no fluxo).</p> Campo no arquivo Significado Onde fica na Policy Fonte <code>CPF_SEG</code> Documento do segurado (CPF/CNPJ) <code>Policy.PolicyCustomerList[*].IdNo</code> (para o customer com <code>IsInsured=Y</code>) PREMIT <code>QTD_SEG</code> Quantidade de segurados (quando aplic\u00e1vel) <code>Policy.PolicyCustomerList[*].QtdSeg</code> PREMIT <code>QTD_TOM</code> Indicador de tomador (quando aplic\u00e1vel) <code>Policy.PolicyCustomerList[*].QtdTom</code> PREMIT <code>CPF_ESTIP</code> (se usado) Documento do estipulante <code>Policy.PolicyCustomerList[*].IdNo</code> (para o policy holder) PREMIT <p>Nota: no seu OPA do PREMIT, as regras de <code>CPF_ESTIP</code> est\u00e3o comentadas \u2014 ent\u00e3o pode ser um campo opcional no momento.</p>"},{"location":"coinsurance/apolice/mapeamentos/policy/#4-policyloblist-policyrisklist-policycoveragelist-coberturas-e-valores","title":"4) PolicyLobList \u2192 PolicyRiskList \u2192 PolicyCoverageList (coberturas e valores)","text":"<p>A estrutura de coberturas (<code>PolicyCoverageList</code>) carrega tanto:</p> <ul> <li> <p>identidade da cobertura (ramo, sequ\u00eancia)</p> </li> <li> <p>valores financeiros (pr\u00eamio, IOF, comiss\u00e3o, pr\u00f3-labore, etc.)</p> </li> </ul>"},{"location":"coinsurance/apolice/mapeamentos/policy/#41-identidade-e-ramo","title":"4.1 Identidade e ramo","text":"Campo no arquivo Significado Onde fica na Policy Fonte <code>SEQUENCIA</code> Identificador do registro no arquivo <code>Policy...PolicyCoverageList[*].SequenceNumber</code> PREMIT/PREMREC/RESPREM <code>COD_RAMO</code> Ramo SUSEP <code>Policy...PolicyCoverageList[*].CodRamo</code> PREMIT/PREMREC/RESPREM <code>IS</code> Import\u00e2ncia segurada <code>Policy...PolicyCoverageList[*].SumInsured</code> PREMIT"},{"location":"coinsurance/apolice/mapeamentos/policy/#42-totalizadoresvalores-lado-lider","title":"4.2 Totalizadores/valores (lado l\u00edder)","text":"Campo no arquivo Significado Onde fica na Policy Fonte <code>PR_EMIT</code> Pr\u00eamio emitido do movimento <code>...PolicyCoverageList[*].OverrideBeforeVatPremium</code> PREMIT/PREMREC <code>IOF</code> Imposto <code>...PolicyCoverageList[*].OverrideVat</code> PREMIT/PREMREC <code>COMIS</code> Comiss\u00e3o (l\u00edder) <code>...PolicyCoverageList[*].OverrideCommission</code> PREMIT <code>AD_FRAC</code> Adicional fracionamento <code>...PolicyCoverageList[*].AdFracLider</code> PREMIT/PREMREC <code>CUST_APOL</code> Custo de ap\u00f3lice <code>...PolicyCoverageList[*].CustApol</code> PREMIT/PREMREC <code>PRO_LAB</code> Pr\u00f3-labore (l\u00edder) <code>...PolicyCoverageList[*].LaborAmountLider</code> PREMIT"},{"location":"coinsurance/apolice/mapeamentos/policy/#43-valores-do-cosseguro-lado-aceito-cedido","title":"4.3 Valores do cosseguro (lado aceito / cedido)","text":"Campo no arquivo Significado Onde fica na Policy Fonte <code>PR_COS_CED</code> Pr\u00eamio cedido no cosseguro <code>...PolicyCoverageList[*].PrCosCed</code> PREMIT <code>COMIS_COSS</code> Comiss\u00e3o cosseguro <code>...PolicyCoverageList[*].ComisCoss</code> PREMIT <p>Observa\u00e7\u00e3o: no JSON da Policy aparecem campos como <code>PrCossAc</code>, <code>ComCosAc</code>, <code>Cofee</code>, <code>PrNGanho*</code> etc. Esses tendem a ser preenchidos por c\u00e1lculos/rotinas de cosseguro (ex.: PREMAC/PREMRECAC/RESPREMC) e/ou regras do motor.</p>"},{"location":"coinsurance/apolice/mapeamentos/policy/#5-policypaymentinfolist-installmentlist-parcelas-cobranca","title":"5) PolicyPaymentInfoList \u2192 InstallmentList (parcelas / cobran\u00e7a)","text":"<p>Essa parte \u00e9 predominantemente PREMREC (parcelamento, dados banc\u00e1rios e cronograma de parcelas).</p>"},{"location":"coinsurance/apolice/mapeamentos/policy/#51-cabecalho-de-pagamento","title":"5.1 Cabe\u00e7alho de pagamento","text":"Campo no arquivo (PREMREC) Significado Onde fica na Policy Fonte <code>QTDE_PREST</code> Qtde total de parcelas <code>Policy.PolicyPaymentInfoList[0].InstallmentPeriodCount</code> PREMREC <code>NUM_BAN</code> Banco <code>Policy.PolicyPaymentInfoList[0].NumBan</code> PREMREC <code>CNPJ_BAN</code> CNPJ do banco/benefici\u00e1rio (layout) <code>Policy.PolicyPaymentInfoList[0].CNPJBan</code> PREMREC <code>NUM_BOL</code> N\u00famero do boleto <code>Policy.PolicyPaymentInfoList[0].NumBol</code> PREMREC <code>NUM_DOC</code> N\u00famero do documento <code>Policy.PolicyPaymentInfoList[0].NumDoc</code> PREMREC <code>NUM_AGE</code> Ag\u00eancia <code>Policy.PolicyPaymentInfoList[0].NumAge</code> PREMREC <code>NUM_NOS</code> Nosso n\u00famero <code>Policy.PolicyPaymentInfoList[0].NumNos</code> PREMREC"},{"location":"coinsurance/apolice/mapeamentos/policy/#52-parcela-installmentlist","title":"5.2 Parcela (InstallmentList)","text":"Campo no arquivo (PREMREC) Significado Onde fica na Policy Fonte <code>PRESTACAO</code> N\u00famero da parcela <code>...InstallmentList[*].InstallmentPeriodSeq</code> PREMREC <code>DT_VENCTO</code> (ou data de parcela no layout) Vencimento <code>...InstallmentList[*].InstallmentDate</code> PREMREC <code>DT_EMIS_PR</code> Data emiss\u00e3o da parcela <code>...InstallmentList[*].DtEmisPre</code> PREMREC <p>Valores como <code>ValDoc</code>, <code>ValDesc</code>, <code>ValMul</code>, <code>ValCob</code> aparecem no JSON e tendem a ser populados pelo fluxo/c\u00e1lculo de cobran\u00e7a.</p>"},{"location":"coinsurance/apolice/mapeamentos/policy/#6-premreceb-recebimento-do-premio-importante-destino-nao-e-policy","title":"6) PREMRECEB \u2014 recebimento do pr\u00eamio (importante: destino n\u00e3o \u00e9 \u201cPolicy\u201d)","text":"<p>No desenho de neg\u00f3cio, o PREMRECEB representa o realizado/recebido.</p>"},{"location":"coinsurance/apolice/mapeamentos/policy/#o-que-voce-deve-documentar-como-destino","title":"O que voc\u00ea deve documentar como destino","text":"<ul> <li>Regra pr\u00e1tica (estado atual do c\u00f3digo): o <code>CoinsurancePremRecebService.groovy</code> faz ingest\u00e3o/valida\u00e7\u00e3o/persist\u00eancia e depois tenta encaminhar/registrar a baixa (pagamento) no m\u00f3dulo apropriado.</li> <li>Ou seja: PREMRECEB \u00e9 fluxo de recebimento e n\u00e3o um \u201catualizador direto\u201d da Policy.</li> </ul> <p>Mesmo assim, os campos do PREMRECEB costumam espelhar chaves do movimento e podem ser usados para: - localizar <code>PolicyPaymentInfo/Installment</code> (por chaves e compet\u00eancia) - registrar quita\u00e7\u00e3o/baixa - concilia\u00e7\u00e3o com o parcelado (PREMREC)</p> <p>Campos t\u00edpicos a mapear (por chave/consulta):</p> Campo no arquivo (PREMRECEB) Uso no fluxo Observa\u00e7\u00e3o <code>COD_CIA</code>, <code>NUM_PROC</code> Amarra SUSEP/companhia Mesma sem\u00e2ntica do PREMIT <code>DT_BASE</code>, <code>TIPO_MOV</code> Compet\u00eancia e tipo Usado para conciliar lote <code>COD_RAMO</code>, <code>NUM_APOL</code>, <code>NUM_END</code>, <code>NUM_PROP</code> Chave do contrato/movimento Usado para localizar Policy/CoInsuranceInfo <code>DT_INI_VIG</code>, <code>DT_FIM_VIG</code> Vig\u00eancia Pode refor\u00e7ar consist\u00eancia <code>VAL_DOC</code> / valores de recebimento Baixa/quitado Normalmente vai para m\u00f3dulo de pagamentos/baixa"},{"location":"coinsurance/apolice/mapeamentos/policy/#7-resprem-competencia-ppng-reserva-de-premio-nao-ganho","title":"7) RESPREM \u2014 compet\u00eancia / PPNG (reserva de pr\u00eamio n\u00e3o ganho)","text":"<p>O RESPREM se relaciona com vig\u00eancia + compet\u00eancia e alimenta c\u00e1lculo/registro de pr\u00eamio ganho/n\u00e3o ganho.</p>"},{"location":"coinsurance/apolice/mapeamentos/policy/#estado-do-codigo","title":"Estado do c\u00f3digo","text":"<ul> <li>No fluxo atual, o <code>CoinsuranceResPremService.groovy</code> possui partes pendentes/TODO (em implementa\u00e7\u00f5es t\u00edpicas, ele persiste o arquivo e depois gera registros cont\u00e1beis/gerenciais).</li> <li>Ent\u00e3o, o que d\u00e1 para afirmar com seguran\u00e7a \u00e9:</li> <li>RESPREM refor\u00e7a/consome <code>DT_BASE</code>, <code>DT_INI_VIG</code>, <code>DT_FIM_VIG</code>, <code>COD_RAMO</code>, e chaves do contrato.</li> <li>O destino pode ser <code>PolicyCoverage.PrNGanho*</code> / campos de \u201cearned/unearned premium\u201d, mas isso depende da implementa\u00e7\u00e3o completa.</li> </ul> <p>Campos que aparecem no JSON e costumam ser alvo do RESPREM:</p> Conceito Onde aparece na Policy Observa\u00e7\u00e3o Pr\u00eamio n\u00e3o ganho (l\u00edder) <code>...PolicyCoverageList[*].PrNGanhoLider</code> Pode ser calculado a partir de RESPREM Pr\u00eamio n\u00e3o ganho (cosseguro) <code>...PolicyCoverageList[*].PrNGanhoCoss</code> Mesma l\u00f3gica, lado aceito"},{"location":"coinsurance/apolice/mapeamentos/policy/#8-notas-de-consistencia-para-seu-repositorio","title":"8) Notas de consist\u00eancia para seu reposit\u00f3rio","text":""},{"location":"coinsurance/apolice/mapeamentos/policy/#81-fonte-do-dado-padrao-recomendado","title":"8.1 \u201cFonte do dado\u201d (padr\u00e3o recomendado)","text":"<p>Para cada campo, mantenha sempre: - origem: PREMIT / PREMREC / PREMRECEB / RESPREM - destino: <code>Policy</code> (path) ou \u201cm\u00f3dulo externo\u201d (pagamentos/baixa/cont\u00e1bil) - coment\u00e1rio: \u201chardcoded\u201d, \u201clookup cadastro/party\u201d, \u201cgerado pelo motor\u201d, \u201cTODO no c\u00f3digo\u201d</p>"},{"location":"coinsurance/apolice/mapeamentos/policy/#82-campos-gerados-pelo-motor-nao-mapeiam-do-arquivo","title":"8.2 Campos gerados pelo motor (n\u00e3o mapeiam do arquivo)","text":"<p>Alguns exemplos comuns: - <code>PolicyId</code>, <code>PolicyNo</code>, <code>MasterPolicyId</code>, <code>MasterPolicyNo</code> - <code>OrgCode</code>, <code>PolicyStatus</code>, <code>PolicyType</code> - <code>ProductId</code>, <code>TechProductId</code>, <code>BusinessObjectId</code></p>"},{"location":"coinsurance/apolice/mapeamentos/policy/#apendice-exemplos-de-paths-uteis-no-json","title":"Ap\u00eandice \u2014 exemplos de paths \u00fateis no JSON","text":"<ul> <li><code>Policy.EffectiveDate</code>, <code>Policy.ExpiryDate</code>, <code>Policy.IssueDate</code></li> <li><code>Policy.CoInsuranceInfoList[0].LeaderPolicyNo</code>, <code>LeaderEndorsementNo</code>, <code>LeaderProposalNo</code></li> <li><code>Policy.PolicyCustomerList[*].IdNo</code>, <code>IsInsured</code>, <code>IsPolicyHolder</code></li> <li><code>Policy.PolicyLobList[0].PolicyRiskList[0].PolicyCoverageList[*].OverrideBeforeVatPremium</code></li> <li><code>Policy.PolicyPaymentInfoList[0].InstallmentList[*].InstallmentDate</code>, <code>InstallmentPeriodSeq</code></li> </ul>"},{"location":"coinsurance/apolice/mapeamentos/premit/","title":"PREMIT \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremitService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremit</code></p>"},{"location":"coinsurance/apolice/mapeamentos/premit/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_premit</code></li> </ul>"},{"location":"coinsurance/apolice/mapeamentos/premit/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode NUM_PROC Protocol DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). UF_DEP IssuingState UF_RISCO RiskStates COD_RAMO BranchCode NUM_APOL PolicyNumber NUM_END EndorsementNumber NUM_PROP ProposalNumber DT_PROP ProposalDate CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_TOM BorrowerDocumentId QTD_TOM BorrowersQuantity DT_EMIS IssueDate DT_INI_VIG EffectiveDate DT_FIM_VIG EndDate PR_EMIT IssuedPremium PR_COS_CED CededCoinsurancePremium AD_FRAC FractionalSurchargeValue CUST_APOL PolicyCostValue IOF TaxAmount COMIS BrokerageCommissionAmount COMIS_COSS CoinsuranceCommissionAmount PRO_LAB ProLaboreValue CPF_ESTIP StipulatorDocumentId IS IsValue DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/apolice/mapeamentos/premit/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/apolice/mapeamentos/premrec/","title":"PREMREC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremRecService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremRec</code></p>"},{"location":"coinsurance/apolice/mapeamentos/premrec/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_premrec</code></li> </ul>"},{"location":"coinsurance/apolice/mapeamentos/premrec/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_APOL PolicyNumber NUM_END EndorsementNumber NUM_PROP ProposalNumber DT_PROP ProposalDate PRESTACAO InstallmentNumber QTDE_PREST InstallmentQuantity DT_EMIS_PR InstallmentIssueDate DT_VEN_PRE InstallmentDueDate DT_INI_VIG EffectiveDate DT_FIM_VIG EndDate PR_EMIT IssuedPremium PERC_COSS InstallmentPremiumIssued AD_FRAC FractionalSurchargeValue CUS_APOL PolicyCostValue IOF TaxAmount OFER Ofer DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/apolice/mapeamentos/premrec/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/","title":"PREMRECEB \u2014 Estruturas usadas no processamento e como recuperar os JSONs","text":"<p>Objetivo: documentar quais estruturas o fluxo de PREMRECEB usa (entrada, Policy/Endorsement e BCP Payment) e quais JSONs voc\u00ea precisa recuperar para montar o mapeamento dos campos do arquivo na estrutura definitiva.</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#visao-geral-em-linguagem-de-negocio","title":"Vis\u00e3o geral (em linguagem de neg\u00f3cio)","text":"<ul> <li>PREMRECEB representa o recebimento do pr\u00eamio (baixa/recebido) no contexto de cosseguro.</li> <li>No fluxo atual, ele n\u00e3o \u201cgrava recebimento\u201d dentro do JSON da Policy diretamente.</li> <li>Ele localiza a ap\u00f3lice/certificado correspondente e registra um Payment no BCP, usando os dados do arquivo (valores e dados banc\u00e1rios) + <code>policyNo</code> / <code>endoNo</code>.</li> </ul> <p>Consequ\u00eancia pr\u00e1tica para mapeamento: - O mapeamento de PREMRECEB se divide em:   1) Arquivo \u2192 <code>CnsPremReceb</code> (persist\u00eancia espelho)   2) <code>CnsPremReceb</code> \u2192 Policy/Endorsement (lookup) (para obter <code>policyNo</code> / <code>endoNo</code>)   3) <code>CnsPremReceb</code> \u2192 <code>Payment</code> (BCP) (onde o \u201crecebido\u201d efetivamente vira dado operacional)</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#1-estrutura-de-entradapersistencia-espelho-do-arquivo","title":"1) Estrutura de entrada/persist\u00eancia (espelho do arquivo)","text":""},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#11-entidade-gravada-cnspremreceb","title":"1.1 Entidade gravada: <code>CnsPremReceb</code>","text":"<p>Papel: \u00e9 o espelho do CSV dentro do sistema. Tudo come\u00e7a por aqui.</p> <p>Onde aparece: - Classe/entidade: <code>CnsPremReceb</code> (camada de repository) - Inser\u00e7\u00e3o/atualiza\u00e7\u00e3o: m\u00e9todos do service de ingest\u00e3o e persist\u00eancia.</p> <p>O que voc\u00ea recupera em JSON aqui: - Um registro de <code>CnsPremReceb</code> (ou o DTO equivalente do service) contendo:   - chaves: <code>cod_cia</code>, <code>dt_base</code>, <code>tipo_mov</code>, <code>cod_ramo</code>, <code>num_apol</code>, <code>num_end</code>, <code>num_prop</code>, <code>dt_prop</code>   - vig\u00eancia: <code>dt_ini_vig</code>, <code>dt_fim_vig</code>   - valores: <code>val_doc</code>, <code>val_desc</code>, <code>val_mul</code>, <code>val_cob</code>   - banc\u00e1rio/boleto: <code>num_ban</code>, <code>num_nos</code>, <code>num_bol</code>, <code>num_doc</code>, <code>num_age</code> (e eventuais varia\u00e7\u00f5es)   - controle: <code>status</code>, <code>fileId</code>, <code>originalFileName</code>, <code>recordNo/sequence</code></p> <p>Por que esse JSON \u00e9 obrigat\u00f3rio para o mapeamento? - Porque ele preserva os nomes de origem (layout) e a forma como o sistema \u201centendeu\u201d e armazenou o arquivo.</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#2-estruturas-usadas-para-localizar-a-apolice-definitiva-policyendorsement","title":"2) Estruturas usadas para localizar a ap\u00f3lice definitiva (Policy/Endorsement)","text":""},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#21-policy-master-e-certificate","title":"2.1 <code>Policy</code> (Master e Certificate)","text":"<p>Papel: o fluxo precisa descobrir o <code>policyNo</code> do Certificate (e, \u00e0s vezes, o endosso) para registrar o pagamento.</p> <p>Como \u00e9 obtido no fluxo (alto n\u00edvel): 1) Query (descobrir <code>policyId</code>) 2) Load Core (carregar JSON completo da ap\u00f3lice)</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#a-master-policy-quando-o-fluxo-tenta-localizar","title":"A) Master Policy (quando o fluxo tenta localizar)","text":"<ul> <li>Usado quando o c\u00f3digo precisa do contexto de Master.</li> <li>Nem sempre \u00e9 obrigat\u00f3rio para o pagamento \u2014 o cr\u00edtico costuma ser o Certificate.</li> </ul> <p>JSON a recuperar (se necess\u00e1rio): - <code>Policy Core</code> do Master (<code>PolicyType = MASTER</code>).</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#b-certificate-policy-o-mais-importante","title":"B) Certificate Policy (o mais importante)","text":"<ul> <li>\u00c9 o Certificate que cont\u00e9m o <code>policyNo</code> usado no Payment.</li> </ul> <p>JSON a recuperar (obrigat\u00f3rio): - Policy Core do Certificate (JSON completo).</p> <p>Campos normalmente usados/observ\u00e1veis nesse JSON: - <code>PolicyNo</code>, <code>MasterPolicyNo</code>, <code>MasterPolicyId</code> - <code>EffectiveDate</code>, <code>ExpiryDate</code>, <code>IssueDate</code> - <code>TipoMov</code>, <code>DtBase</code>, <code>UFDep</code>, <code>UFRisco</code> - <code>CoInsuranceInfoList</code> (LeaderPolicyNo, LeaderEndorsementNo, LeaderProposalNo, ShareRate etc.) - (eventualmente) <code>PolicyPaymentInfoList</code> / <code>InstallmentList</code> (nem sempre \u00e9 \u201co\u201d destino do recebido)</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#22-endorsement-quando-aplicavel","title":"2.2 <code>Endorsement</code> (quando aplic\u00e1vel)","text":"<p>Papel: se o recebimento estiver associado a endosso, o fluxo obt\u00e9m <code>endoNo</code>.</p> <p>Como \u00e9 obtido no fluxo (alto n\u00edvel): 1) Query (descobrir <code>endorsementId</code>) 2) Load Core (carregar JSON completo do endosso)</p> <p>JSON a recuperar (quando aplic\u00e1vel): - Endorsement Core (JSON completo), principalmente para:   - <code>endoNo</code>   - datas/refer\u00eancias do endosso</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#3-estruturas-usadas-para-registrar-o-recebimento-bcp","title":"3) Estruturas usadas para registrar o recebimento (BCP)","text":""},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#31-payment-bcp-paymentdetail","title":"3.1 <code>Payment</code> (BCP) + <code>PaymentDetail</code>","text":"<p>Papel: \u00e9 aqui que o recebido \u00e9 efetivado operacionalmente.</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#a-payment-campos-tipicos","title":"A) <code>Payment</code> (campos t\u00edpicos)","text":"<p>Preenchimentos esperados a partir do <code>CnsPremReceb</code>:</p> <ul> <li><code>amount</code> \\u2190 <code>val_doc</code> (DocumentValue)</li> <li><code>bankCode</code> \\u2190 <code>num_ban</code></li> <li><code>paymentNo</code> \\u2190 <code>num_bol</code> ou <code>num_doc</code> (depende do que o c\u00f3digo escolhe)</li> <li><code>insurerAccountCode</code> \\u2190 <code>num_age</code></li> <li><code>bankAccountNo</code> \\u2190 <code>num_nos</code> (aten\u00e7\u00e3o: \u201cNosso N\u00famero\u201d pode estar sendo usado como \u201cAccountNo\u201d)</li> <li><code>policyNo</code> \\u2190 <code>certificatePolicy.policyNo</code></li> <li><code>endoNo</code> \\u2190 <code>endorsement.endoNo</code> (quando existir)</li> </ul> <p>Campos fixos comuns no c\u00f3digo: - <code>currencyCode = \"BRL\"</code> - <code>paymentMethod = \"70\"</code> (Boleto) - <code>paymentType = \"1\"</code> (Direct Billing) - <code>paymentStatus = \"3\"</code> (Paid) - <code>payerPayeeType = \"1\"</code></p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#b-paymentdetail","title":"B) <code>PaymentDetail</code>","text":"<ul> <li><code>amount</code> \\u2190 <code>val_doc</code></li> <li><code>currencyCode = \"BRL\"</code></li> <li><code>expenseType = \"1\"</code></li> <li><code>isExpense = \"N\"</code></li> </ul> <p>JSON a recuperar (obrigat\u00f3rio): - Request JSON do Payment (lista <code>payments</code>) \u2014 normalmente o service j\u00e1 serializa/loga.</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#32-resposta-do-bcp","title":"3.2 Resposta do BCP","text":"<p>Papel: confirma o registro do Payment.</p> <p>JSON a recuperar (recomendado): - Response do endpoint do BCP (sucesso/erro) \u2014 para evid\u00eancia e troubleshooting.</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#4-quais-jsons-recuperar-para-fazermos-o-mapeamento-checklist","title":"4) Quais JSONs recuperar para fazermos o mapeamento (checklist)","text":""},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#obrigatorios","title":"Obrigat\u00f3rios","text":"<p>1) <code>CnsPremReceb</code> (registro persistido do arquivo) 2) Policy Certificate (core) (para capturar <code>policyNo</code> e a estrutura definitiva) 3) Payment Request JSON (BCP) (onde o \u201crecebido\u201d efetivamente vira dado operacional)</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#condicionais","title":"Condicionais","text":"<p>4) Policy Master (core) (se voc\u00ea tamb\u00e9m quer mapear Master e regras/atributos adicionais) 5) Endorsement (core) (se o fluxo usa/precisa de <code>endoNo</code> no Payment) 6) Payment Response JSON (BCP) (auditoria e diagn\u00f3stico)</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#5-como-coletar-esses-jsons-na-pratica","title":"5) Como coletar esses JSONs na pr\u00e1tica","text":""},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#a-a-partir-de-logs-do-proprio-servico","title":"A) A partir de logs do pr\u00f3prio servi\u00e7o","text":"<ul> <li>Procure por logs onde o service serializa objetos (ex.: <code>toJSON(payments)</code> ou equivalente).</li> <li>Ideal para capturar:</li> <li>Payment request</li> <li>IDs utilizados (<code>policyId</code>, <code>endorsementId</code>)</li> </ul>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#b-a-partir-do-policyendorsement-core-load","title":"B) A partir do Policy/Endorsement Core (load)","text":"<ul> <li>Com o <code>policyId</code> do Certificate, fa\u00e7a o load e salve o JSON.</li> <li>Com o <code>endorsementId</code>, fa\u00e7a o load e salve o JSON.</li> </ul> <p>Dica operacional: se voc\u00ea j\u00e1 tem exemplos de chamadas como <code>/platform/proposal/core/proposal/v1/load?policyId=...</code>, salve o payload completo para usarmos como \u201cbase de mapeamento\u201d.</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#6-observacoes-importantes-para-orientar-o-mapeamento","title":"6) Observa\u00e7\u00f5es importantes (para orientar o mapeamento)","text":"<p>1) Destino do \u201crecebido\u201d - No fluxo atual, o destino prim\u00e1rio do recebido \u00e9 o BCP Payment, n\u00e3o necessariamente <code>PolicyPaymentInfoList.InstallmentList</code>.</p> <p>2) Campos banc\u00e1rios - H\u00e1 risco de \u201csem\u00e2ntica trocada\u201d (ex.: <code>Nosso N\u00famero</code> indo como <code>bankAccountNo</code>). - No mapeamento, registre explicitamente:   - campo do arquivo   - campo do <code>CnsPremReceb</code>   - campo do <code>Payment</code>   - observa\u00e7\u00e3o de sem\u00e2ntica</p> <p>3) Endorsement lookup - Se o c\u00f3digo est\u00e1 com hardcode/TODO (IDs fixos), isso pode afetar a coleta de JSON real. - Para mapeamento, foque primeiro no happy path (quando lookup funciona corretamente) e depois documente as lacunas.</p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb-estruturas-json/#7-proximo-passo-sugerido-para-o-seu-mapeamento","title":"7) Pr\u00f3ximo passo sugerido (para o seu mapeamento)","text":"<p>Quando voc\u00ea tiver os JSONs (1) <code>CnsPremReceb</code>, (2) Policy Certificate core e (3) Payment request, a gente monta a tabela:</p> Campo no arquivo (layout) Campo em <code>CnsPremReceb</code> Campo no JSON <code>Policy</code> (se existir) Campo no JSON <code>Payment</code> (BCP) Regra/observa\u00e7\u00e3o"},{"location":"coinsurance/apolice/mapeamentos/premreceb/","title":"PREMRECEB \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremRecebService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremReceb</code></p>"},{"location":"coinsurance/apolice/mapeamentos/premreceb/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_prereceb</code></li> </ul>"},{"location":"coinsurance/apolice/mapeamentos/premreceb/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_APOL PolicyNumber NUM_END EndorsementNumber NUM_PROP ProposalNumber DT_PROP ProposalDate PRESTACAO InstallmentNumber DT_REC_PRE InstallmentReceiptDate DT_VEN_PRE InstallmentDueDate NUM_BAN BankNumber CNPJ_BAN BankDocumentId NUM_BOL TicketNumber NUM_DOC DocumentNumber NUM_AGE AgencyNumber NUM_NOS OurNumber VAL_DOC DocumentValue VAL_DESC DiscountValue VAL_MUL FineValue VAL_COB ChargedValue DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/apolice/mapeamentos/premreceb/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/apolice/mapeamentos/resprem/","title":"RESPREM \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceResPremService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsResPrem</code></p>"},{"location":"coinsurance/apolice/mapeamentos/resprem/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_resprem</code></li> </ul>"},{"location":"coinsurance/apolice/mapeamentos/resprem/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_APOL PolicyNumber NUM_END EndorsementNumber NUM_PROP ProposalNumber DT_PROP ProposalDate DT_EMIS IssueDate DT_INI_VIG EffectiveDate DT_FIM_VIG EndDate PR_EMIT IssuedPremium PR_COS_CED CededCoinsurancePremium PR_N_GANHO UnwonPremiumValue COLET Collective DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/apolice/mapeamentos/resprem/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/retornos/","title":"Retornos (RO BMG) \u2014 Vis\u00e3o geral","text":"<p>Os arquivos RO s\u00e3o retornos/derivados gerados a partir do processamento interno, para consumo BMG/SUSEP.</p> <p>TODO: detalhar regra de gera\u00e7\u00e3o e chaves de correla\u00e7\u00e3o.</p>"},{"location":"coinsurance/retornos/premrecac/","title":"PREMRECAC \u2014 Retorno de parcelas (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/premrecebc/","title":"PREMRECEBC \u2014 Retorno de recebimento (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/sinavac/","title":"SINAVAC \u2014 Retorno de sinistro (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/sinpagac/","title":"SINPAGAC \u2014 Retorno pagamento (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/sinpendac/","title":"SINPENDAC \u2014 Retorno pend\u00eancias (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/depara/premac/","title":"PREMAC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremacService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremAc</code></p>"},{"location":"coinsurance/retornos/depara/premac/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_premac</code></li> </ul>"},{"location":"coinsurance/retornos/depara/premac/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es RecordNo SEQUENCIA CompanyCode COD_CIA Protocol NUM_PROC BaseDate DT_BASE MovementType TIPO_MOV IssuingState UF_DEP RiskStates UF_RISCO BranchCode COD_RAMO PolicyNumber NUM_APOL EndorsementNumber NUM_END InsuredQuantity QTD_SEG BorrowerDocumentId CPF_TOM BorrowersQuantity QTD_TOM IssueDate DT_EMIS EffectiveDate DT_INI_VIG EndDate DT_FIM_VIG ProposalNumber NUM_PROP ProposalDate DT_PROP InsuredDocumentId CPF_SEG IssuedPremium PR_EMIT CededCoinsurancePremium PR_COS_CED FractionalSurchargeValue AD_FRAC PolicyCostValue CUST_APOL TaxAmount IOF BrokerageCommissionAmount COMIS CoinsuranceCommissionAmount COMIS_COSS ProLaboreValue PRO_LAB StipulatorDocumentId CPF_ESTIP IsValue IS BranchGroupDescription DS_GRUPO_RAMO ProductCode CD_PRODUTO ProductDescription DS_PRODUTO BusinessUnitCode CD_BU BusinessUnitDescription DS_BU OperationCode CD_OPERACAO WalletCode CD_CARTEIRA WalletDescription DS_CARTEIRA SucursalCode CD_SUCURSAL FgGeb FG_GEB OperationDescription DCR_TIP_OPER OriginDescription DS_ORIGEM"},{"location":"coinsurance/retornos/depara/premac/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/retornos/depara/premrecac/","title":"PREMRECAC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremRecacService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremRecAc</code></p>"},{"location":"coinsurance/retornos/depara/premrecac/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_premrecac</code></li> </ul>"},{"location":"coinsurance/retornos/depara/premrecac/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es RecordNo RecordNo N\u00ba do registro no arquivo (SEQUENCIA). CompanyCode CompanyCode BaseDate BaseDate Data base (compet\u00eancia). MovementType MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). BranchCode BranchCode PolicyNumber PolicyNumber EndorsementNumber EndorsementNumber ProposalNumber ProposalNumber ProposalDate ProposalDate InstallmentNumber InstallmentNumber InstallmentQuantity InstallmentQuantity InstallmentIssueDate InstallmentIssueDate InstallmentDueDate InstallmentDueDate EffectiveDate EffectiveDate EndDate EndDate IssuedPremium IssuedPremium InstallmentPremiumIssued InstallmentPremiumIssued FractionalSurchargeValue FractionalSurchargeValue PolicyCostValue PolicyCostValue TaxAmount TaxAmount Ofer Ofer BranchGroupDescription BranchGroupDescription ProductCode ProductCode ProductDescription ProductDescription BusinessUnitCode BusinessUnitCode BusinessUnitDescription BusinessUnitDescription OperationCode OperationCode WalletCode WalletCode WalletDescription WalletDescription SucursalCode SucursalCode FgGeb FgGeb OperationDescription OperationDescription OriginDescription OriginDescription"},{"location":"coinsurance/retornos/depara/premrecac/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/retornos/depara/premrecebc/","title":"PREMRECEBC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremRecebcService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremRecebC</code></p>"},{"location":"coinsurance/retornos/depara/premrecebc/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_premrecebc</code></li> </ul>"},{"location":"coinsurance/retornos/depara/premrecebc/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es RecordNo RecordNo N\u00ba do registro no arquivo (SEQUENCIA). CompanyCode CompanyCode BaseDate BaseDate Data base (compet\u00eancia). MovementType MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). BranchCode BranchCode PolicyNumber PolicyNumber EndorsementNumber EndorsementNumber ProposalNumber ProposalNumber ProposalDate ProposalDate InstallmentNumber InstallmentNumber InstallmentReceiptDate InstallmentReceiptDate InstallmentDueDate InstallmentDueDate BankNumber BankNumber BankDocumentId BankDocumentId TicketNumber TicketNumber DocumentNumber DocumentNumber AgencyNumber AgencyNumber OurNumber OurNumber DocumentValue DocumentValue DiscountValue DiscountValue FineValue FineValue ChargedValue ChargedValue BranchGroupDescription BranchGroupDescription ProductCode ProductCode ProductDescription ProductDescription BusinessUnitCode BusinessUnitCode BusinessUnitDescription BusinessUnitDescription OperationCode OperationCode WalletCode WalletCode WalletDescription WalletDescription SucursalCode SucursalCode FgGeb FgGeb OperationDescription OperationDescription OriginDescription OriginDescription"},{"location":"coinsurance/retornos/depara/premrecebc/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/retornos/depara/sinpagac/","title":"SINPAGAC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceSinpagacService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsSinPagAc</code></p>"},{"location":"coinsurance/retornos/depara/sinpagac/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_sinpagac</code></li> </ul>"},{"location":"coinsurance/retornos/depara/sinpagac/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_SIN ClaimNumber NUM_APOL PolicyNumber NUM_END EndorsementNumber CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_BEN BeneficiaryDocumentId QTD_BEN BeneficiaryQuantity DT_REG RegistrationDate DT_AVISO NoticeDate DT_OCOR OccurrenceDate VR_COS_CED CededCoinsuranceValue VR_MOV MovementValue DT_MOV MovementDate TP_SIN ClaimType TIPO_REC ReceiptType NUM_BAN_SE InsurerBankNumber NUM_AGE_SE InsurerAgencyNumber NUM_CON_SE InsurerAccountNumber NUM_TRANSA TransactionNumber NUM_BAN InsuredBankNumber NUM_AGE InsuredAgencyNumber NUM_CON InsuredAccountNumber DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/retornos/depara/sinpagac/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/retornos/depara/sinpendac/","title":"SINPENDAC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceSinpendacService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsSinPendAc</code></p>"},{"location":"coinsurance/retornos/depara/sinpendac/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_sinpendac</code></li> </ul>"},{"location":"coinsurance/retornos/depara/sinpendac/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_SIN ClaimNumber NUM_APOL PolicyNumber NUM_END EndorsementNumber CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_BEN BeneficiaryDocumentId QTD_BEN BeneficiaryQuantity DT_REG RegistrationDate DT_AVISO NoticeDate DT_OCOR OccurrenceDate VR_COS_CED CededCoinsuranceValue VR_PENDENT PendingValue VR_TOT TotalValue TP_SIN ClaimType DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/retornos/depara/sinpendac/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/","title":"Documenta\u00e7\u00e3o Funcional: Gera\u00e7\u00e3o do Arquivo PREMAC","text":"<p>Processo: Exporta\u00e7\u00e3o Mensal de Pr\u00eamios de Cosseguro Aceito (SUSEP)</p> <p>Contexto: Opera\u00e7\u00e3o BMG Seguridade (Cosseguradora Aceita) &amp; Generali (Seguradora L\u00edder)</p> <p>Frequ\u00eancia: Mensal (Fechamento)</p>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#1-objetivo-do-processo","title":"1. Objetivo do Processo","text":"<p>Este processo tem como objetivo gerar e disponibilizar o arquivo regulat\u00f3rio PREMAC. Este arquivo reporta \u00e0 SUSEP toda a movimenta\u00e7\u00e3o financeira de pr\u00eamios onde a BMG Seguridade atua como \"Cosseguradora Aceita\" (participante), recebendo riscos repassados pela Generali (Seguradora L\u00edder).</p> <p>O sistema deve varrer a base de dados de ap\u00f3lices, identificar as movimenta\u00e7\u00f5es do m\u00eas de refer\u00eancia e calcular a participa\u00e7\u00e3o da BMG nos valores.</p>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#2-criterios-de-selecao-quem-entra-no-arquivo","title":"2. Crit\u00e9rios de Sele\u00e7\u00e3o (Quem entra no arquivo?)","text":"<p>Para que uma ap\u00f3lice ou endosso conste neste arquivo, o sistema aplica os seguintes filtros de neg\u00f3cio:</p> <ol> <li>Empresa: A ap\u00f3lice deve pertencer \u00e0 opera\u00e7\u00e3o da BMG.</li> <li>Seguradora L\u00edder: A ap\u00f3lice deve ter a Generali (C\u00f3digo SUSEP 05908) identificada como a Seguradora L\u00edder.</li> <li>Compet\u00eancia: A data de registro da movimenta\u00e7\u00e3o (Data Base) deve pertencer ao m\u00eas e ano selecionados para a execu\u00e7\u00e3o (ex: Janeiro de 2026).</li> </ol>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#3-regras-de-negocio-e-calculos","title":"3. Regras de Neg\u00f3cio e C\u00e1lculos","text":"<p>O sistema processa cada ap\u00f3lice individualmente e aplica as seguintes regras para compor os valores do relat\u00f3rio:</p>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#31-consolidacao-de-valores","title":"3.1. Consolida\u00e7\u00e3o de Valores","text":"<p>Uma ap\u00f3lice pode ter diversas coberturas (ex: Morte, Invalidez, Assist\u00eancia Funeral). O arquivo PREMAC exige o valor total do movimento.</p> <ul> <li>Regra: O sistema soma os valores de todas as coberturas da ap\u00f3lice para chegar ao montante total.</li> </ul>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#32-aplicacao-da-participacao-cosseguro","title":"3.2. Aplica\u00e7\u00e3o da Participa\u00e7\u00e3o (Cosseguro)","text":"<p>Os valores originais na ap\u00f3lice representam o contrato total (100%) fechado pela L\u00edder.</p> <ul> <li>Regra: O sistema aplica o percentual de 40% (Participa\u00e7\u00e3o BMG) sobre os valores da L\u00edder para determinar o montante a ser reportado no arquivo.</li> <li>Pr\u00eamio Aceito = Pr\u00eamio L\u00edquido da L\u00edder x 40%</li> <li>Comiss\u00e3o Aceita = Comiss\u00e3o da L\u00edder x 40%</li> <li>Adicional Aceito = Adicional da L\u00edder x 40%</li> </ul>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#33-tratamento-da-taxa-de-custo-cofee","title":"3.3. Tratamento da Taxa de Custo (COFEE)","text":"<p>O Custo de Ap\u00f3lice (conhecido como COFEE) tem tratamento espec\u00edfico:</p> <ul> <li>Valor Monet\u00e1rio: O sistema captura o valor exato de custo j\u00e1 calculado e gravado na ap\u00f3lice.</li> <li>Percentual: O sistema reporta a taxa utilizada (ex: 6,8%), priorizando a taxa espec\u00edfica gravada no momento do endosso, se houver.</li> </ul>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#34-regra-de-emissao-vs-endosso","title":"3.4. Regra de Emiss\u00e3o vs. Endosso","text":"<p>Para identificar corretamente o documento na SUSEP:</p> <ul> <li>Emiss\u00f5es (Movimento 101): O n\u00famero do endosso \u00e9 preenchido com zeros, pois \u00e9 uma ap\u00f3lice nova.</li> <li>Demais Movimentos: O n\u00famero do endosso original da L\u00edder \u00e9 mantido.</li> </ul>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#4-estrutura-do-arquivo-gerado-visao-geral","title":"4. Estrutura do Arquivo Gerado (Vis\u00e3o Geral)","text":"<p>Com base no c\u00f3digo final validado e no arquivo gerado (<code>PREMAC_202601_20260120_190410.csv</code>), detalhei a estrutura t\u00e9cnica do arquivo PREMAC.</p> <p>Esta especifica\u00e7\u00e3o define exatamente como cada coluna \u00e9 formatada e qual o seu significado.</p>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#41-layout-do-arquivo-premac-premios-de-cosseguro-aceito","title":"4.1 Layout do Arquivo: PREMAC (Pr\u00eamios de Cosseguro Aceito)","text":"<p>Nome do Arquivo: <code>PREMAC_{YYYYMM}_{TIMESTAMP}.csv</code></p> <p>Formato: Texto (CSV)</p> <p>Delimitador: Pipe (<code>|</code>)</p> <p>Encoding: UTF-8</p> <p>Separador Decimal: Ponto (<code>.</code>)</p> <p>Formato de Data: <code>DDMMAAAA</code></p>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#42-detalhe-das-colunas","title":"4.2 Detalhe das Colunas","text":"Ordem Nome da Coluna Tipo Formato / Tamanho Descri\u00e7\u00e3o e Regra de Preenchimento 01 SEQUENCIA Num\u00e9rico 10 d\u00edgitos (com zeros) Contador sequencial \u00fanico por linha no arquivo (Ex: <code>0000000001</code>). 02 COD_CIA Texto 5 caracteres C\u00f3digo SUSEP da Seguradora (BMG). Valor Fixo: <code>03417</code>. 03 NUM_PROC Texto Vari\u00e1vel N\u00famero do Processo SUSEP do produto (Ex: <code>15414.901147/2014-38</code>). Vem da ap\u00f3lice l\u00edder. 04 DT_BASE Data AAAAMM Ano e M\u00eas da compet\u00eancia cont\u00e1bil (Ex: <code>202601</code>). 05 TIPO_MOV Num\u00e9rico 3 d\u00edgitos C\u00f3digo do tipo de movimento (Ex: <code>101</code> para Emiss\u00e3o, <code>102</code> para Endosso). 06 UF_DEP Texto 2 caracteres Sigla da UF do Departamento/Emiss\u00e3o (Ex: <code>SP</code>). 07 UF_RISCO Texto 2 caracteres Sigla da UF de localiza\u00e7\u00e3o do Risco (Ex: <code>AM</code>). 08 COD_RAMO Texto 4 caracteres C\u00f3digo do Ramo SUSEP (Ex: <code>0993</code>). 09 NUM_APOL Texto Vari\u00e1vel N\u00famero da Ap\u00f3lice na Seguradora L\u00edder. 10 NUM_END Texto Vari\u00e1vel N\u00famero do Endosso na L\u00edder.\u26a0\ufe0f Regra: Se <code>TIPO_MOV</code> for <code>101</code>, preenche com 20 zeros. Caso contr\u00e1rio, usa o n\u00famero real. 11 COD_COSS Texto 5 caracteres C\u00f3digo SUSEP da Seguradora L\u00edder (Generali). Valor Fixo: <code>05908</code>. 12 DT_EMIS Data DDMMAAAA Data de Emiss\u00e3o da Ap\u00f3lice/Endosso (Ex: <code>20012026</code>). 13 DT_INI_VIG Data DDMMAAAA Data de In\u00edcio de Vig\u00eancia (Ex: <code>02012026</code>). 14 DT_FIM_VIG Data DDMMAAAA Data de Fim de Vig\u00eancia (Ex: <code>02122026</code>). 15 PR_COSS_AC Valor 0.00 Pr\u00eamio de Cosseguro Aceito.Valor da participa\u00e7\u00e3o da BMG. Soma do campo <code>PrCossAc</code> de todas as coberturas. 16 COM_COSS_AC Valor 0.00 Comiss\u00e3o de Cosseguro Aceito.Valor da comiss\u00e3o sobre a parte aceita. Soma do campo <code>ComCosAc</code>. 17 PR_EMIT Valor 0.00 Pr\u00eamio Emitido Total (L\u00edder).Valor total l\u00edquido da ap\u00f3lice na l\u00edder (100%), sem impostos. 18 AD_FRAC Valor 0.00 Adicional de Fracionamento Aceito.Soma do campo <code>AdFracCoss</code>. 19 COFEE Valor 0.00 Custo de Ap\u00f3lice (Aceito).Valor monet\u00e1rio do custo de emiss\u00e3o (taxa Cofee) proporcional \u00e0 BMG. 20 PRO_LAB Valor 0.00 Pr\u00f3-Labore.Valor de administra\u00e7\u00e3o. Soma do campo <code>LaborAmountCoss</code>. 21 CD_PRODUTO Texto Vari\u00e1vel C\u00f3digo interno do produto no sistema (Ex: <code>93911</code>). 22 DS_PRODUTO Texto Vari\u00e1vel Descri\u00e7\u00e3o/Nome comercial do produto. 23 NUM_PROP Texto Vari\u00e1vel N\u00famero da Proposta na Seguradora L\u00edder. 24 DT_PROP Data DDMMAAAA Data da Proposta na L\u00edder. 25 CPF_SEG Texto Vari\u00e1vel CPF ou CNPJ do Segurado principal. 26 PRC_COMISS_COFEE Valor 0.00#### Percentual utilizado para c\u00e1lculo do COFEE (Ex: <code>0.068</code> para 6.8%)."},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#exemplo-de-linha-raw-data","title":"Exemplo de Linha (Raw Data)","text":"<pre><code>SEQUENCIA|COD_CIA|NUM_PROC|DT_BASE|TIPO_MOV|UF_DEP|UF_RISCO|COD_RAMO|NUM_APOL|NUM_END|COD_COSS|DT_EMIS|DT_INI_VIG|DT_FIM_VIG|PR_COSS_AC|COM_COSS_AC|PR_EMIT|AD_FRAC|COFEE|PRO_LAB|CD_PRODUTO|DS_PRODUTO|NUM_PROP|DT_PROP|CPF_SEG|PRC_COMISS_COFEE\n0000000001|03417|15414.901147/2014-38|202601|101|SP|AM|0993|789322900007005|00000000000000000000|05908|20012026|02012026|02122026|0.34|0.00|0.85|0.00|0.02|0.00|93911|BMG 2.0 Vida Cart\u00e3o Consignado INSS|20260120|01012026|12345678912|0.068\n</code></pre>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#regras-de-negocio-aplicadas-na-geracao","title":"Regras de Neg\u00f3cio Aplicadas na Gera\u00e7\u00e3o","text":"<ol> <li>Soma de Coberturas: Os valores monet\u00e1rios (colunas 15 a 20) s\u00e3o resultantes da soma de todas as coberturas da ap\u00f3lice. O arquivo n\u00e3o quebra por cobertura, apenas por Ap\u00f3lice/Movimento.</li> <li>Valores L\u00edquidos: O campo <code>PR_EMIT</code> refere-se ao Pr\u00eamio L\u00edquido (<code>BeforeVatPremium</code>), ou seja, desconta-se o IOF/Impostos.</li> <li>Origem dos Dados:</li> <li>Campos com sufixo <code>_AC</code> ou <code>Coss</code> v\u00eam dos campos calculados de Cosseguro Aceito.</li> <li> <p>Campos como <code>PR_EMIT</code> v\u00eam dos valores originais (100%) da L\u00edder.</p> </li> <li> <p>Chave \u00danica: A chave \u00fanica l\u00f3gica de neg\u00f3cio de cada linha \u00e9 composta por <code>COD_RAMO + NUM_APOL + NUM_END</code>.</p> </li> </ol>"},{"location":"coinsurance/retornos/premac/premac-especificacao-funcional/#5-resultados-esperados","title":"5. Resultados Esperados","text":"<p>Ao final da execu\u00e7\u00e3o do processo mensal:</p> <ol> <li>Sucesso: Um arquivo nomeado como <code>PREMAC_AAAAMM_DataHora.csv</code> ser\u00e1 depositado na \u00e1rea de exporta\u00e7\u00e3o para envio \u00e0 SUSEP/Contabilidade.</li> <li>Exce\u00e7\u00f5es: Caso alguma ap\u00f3lice tenha dados incompletos (ex: falta de cadastro do L\u00edder), ela n\u00e3o ser\u00e1 inclu\u00edda no arquivo final e um relat\u00f3rio de erros separado ser\u00e1 gerado para an\u00e1lise da equipe operacional.</li> </ol>"},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/","title":"Especifica\u00e7\u00e3o T\u00e9cnica: Gera\u00e7\u00e3o Arquivo PREMAC","text":"<p>M\u00f3dulo: Coinsurance (Cosseguro Aceito)</p> <p>Entidade Origem: <code>Policy</code> (Plataforma InsureMO)</p> <p>Formato de Sa\u00edda: CSV (<code>|</code> delimitado)</p> <p>Frequ\u00eancia: Mensal (Fechamento Cont\u00e1bil)</p>"},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#1-objetivo","title":"1. Objetivo","text":"<p>Gerar o arquivo regulat\u00f3rio contendo os dados de Pr\u00eamios de Cosseguro Aceito para a opera\u00e7\u00e3o onde a BMG (03417) atua como Cosseguradora Aceita e a Generali (05908) atua como Seguradora L\u00edder.</p> <p>O arquivo consolida as movimenta\u00e7\u00f5es (Emiss\u00f5es, Endossos, Cancelamentos) ocorridas na compet\u00eancia, baseando-se nos dados processados e persistidos na entidade definitiva de Ap\u00f3lice.</p>"},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#2-estrategia-de-extracao-e-performance","title":"2. Estrat\u00e9gia de Extra\u00e7\u00e3o e Performance","text":""},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#21-fonte-de-dados","title":"2.1 Fonte de Dados","text":"<p>A extra\u00e7\u00e3o n\u00e3o utiliza tabelas tempor\u00e1rias. Os dados s\u00e3o consumidos diretamente das APIs definitivas:</p> <ul> <li>Busca (Search): <code>ProposalSdkClient</code> (\u00cdndice <code>Policy</code>).</li> <li>Detalhamento (Load): <code>PolicySdkClient</code> (Carregamento do <code>Policy Core</code> completo).</li> </ul>"},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#22-paginacao-keyset-pagination","title":"2.2 Pagina\u00e7\u00e3o (Keyset Pagination)","text":"<p>Devido ao alto volume de dados, a extra\u00e7\u00e3o utiliza pagina\u00e7\u00e3o por cursor para evitar limites de offset do Elasticsearch (m\u00e1ximo 10.000 registros):</p> <ul> <li>Cursor: Campo <code>entity_id</code> (Num\u00e9rico sequencial \u00fanico).</li> <li>L\u00f3gica: Busca lotes de 1.000 registros onde <code>entity_id &gt; ultimo_cursor_processado</code>.</li> </ul>"},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#23-criterios-de-selecao-filtros","title":"2.3 Crit\u00e9rios de Sele\u00e7\u00e3o (Filtros)","text":"<p>Para compor o arquivo, s\u00e3o selecionados registros que atendam a todas as condi\u00e7\u00f5es:</p> <ol> <li>Tenant: <code>FullOrgCode</code> = <code>bmg</code>.</li> <li>L\u00edder: <code>CodCoss</code> = <code>05908</code> (Generali).</li> <li>Compet\u00eancia: <code>BaseDate</code> = Data inicial do m\u00eas de refer\u00eancia (formato <code>YYYY-MM-01</code>).</li> <li>Exemplo: Para compet\u00eancia <code>202601</code>, filtra-se por <code>2026-01-01</code>.</li> </ol>"},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#3-mapeamento-de-campos-de-para","title":"3. Mapeamento de Campos (De-Para)","text":"<p>Abaixo, a rela\u00e7\u00e3o entre as colunas do arquivo CSV e os campos no JSON da entidade <code>Policy</code>.</p>"},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#31-cabecalho-e-identificacao","title":"3.1 Cabe\u00e7alho e Identifica\u00e7\u00e3o","text":"Coluna CSV Origem (JSON Policy) Regra de Neg\u00f3cio / Transforma\u00e7\u00e3o SEQUENCIA Gerado Contador sequencial incremental iniciando em 1. Formatado em 10 d\u00edgitos com zeros \u00e0 esquerda. COD_CIA Fixo Valor fixo: <code>03417</code> (BMG). NUM_PROC <code>NumProcLider</code> N\u00famero do Processo SUSEP. Se vazio na raiz, busca no objeto da L\u00edder em <code>CoInsuranceInsurerList</code>. DT_BASE Par\u00e2metro Ano e M\u00eas da compet\u00eancia (ex: <code>202601</code>). TIPO_MOV <code>TipoMov</code> Tipo de movimento (ex: 101, 102). Formatado com 3 d\u00edgitos. UF_DEP <code>UFDep</code> UF do Departamento/Emiss\u00e3o. UF_RISCO <code>UFRisco</code> UF do Risco. COD_RAMO <code>CodRamoProduto</code> C\u00f3digo do Ramo SUSEP. NUM_APOL <code>CoInsuranceInfoList[0].LeaderPolicyNo</code> N\u00famero da Ap\u00f3lice na Seguradora L\u00edder. NUM_END <code>CoInsuranceInfoList[0].LeaderEndorsementNo</code> N\u00famero do Endosso na L\u00edder.Regra: Se <code>TIPO_MOV == 101</code>, preencher com 20 zeros (<code>000...</code>). Caso contr\u00e1rio, usar o valor original. COD_COSS Fixo Valor fixo: <code>05908</code> (Generali). DT_EMIS <code>IssueDate</code> Data de Emiss\u00e3o. Formato <code>DDMMYYYY</code>. DT_INI_VIG <code>EffectiveDate</code> In\u00edcio de Vig\u00eancia. Formato <code>DDMMYYYY</code>. DT_FIM_VIG <code>ExpiryDate</code> Fim de Vig\u00eancia. Formato <code>DDMMYYYY</code>."},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#32-valores-financeiros","title":"3.2 Valores Financeiros","text":"<p>Os valores devem ser consolidados por movimento. O sistema varre toda a estrutura de <code>PolicyLobList -&gt; PolicyRiskList -&gt; PolicyCoverageList</code> e soma os valores encontrados nas coberturas.</p> Coluna CSV Origem (JSON Policy Coverage) Descri\u00e7\u00e3o PR_COSS_AC Soma de <code>PrCossAc</code> Pr\u00eamio de Cosseguro Aceito (Valor j\u00e1 calculado na persist\u00eancia). COM_COSS_AC Soma de <code>ComCosAc</code> Comiss\u00e3o de Cosseguro Aceito. PR_EMIT <code>BeforeVatPremium</code> (Raiz) Pr\u00eamio L\u00edquido Total (L\u00edder) sem impostos. AD_FRAC Soma de <code>AdFracCoss</code> Adicional de Fracionamento (Parcela Aceita). COFEE Soma de <code>Cofee</code> Valor monet\u00e1rio da taxa de Cofee (Custo de ap\u00f3lice). PRO_LAB Soma de <code>LaborAmountCoss</code> Valor de Pr\u00f3-Labore (Parcela Aceita). <p>Nota: Formata\u00e7\u00e3o num\u00e9rica utilizada: <code>0.00</code> (Ponto como separador decimal).</p>"},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#33-identificacao-complementar-campos-novos","title":"3.3 Identifica\u00e7\u00e3o Complementar (Campos Novos)","text":"Coluna CSV Origem (JSON Policy) Regra de Neg\u00f3cio CD_PRODUTO <code>CdProduto</code> C\u00f3digo interno do produto. DS_PRODUTO <code>DsProduto</code> Descri\u00e7\u00e3o do produto. NUM_PROP <code>CoInsuranceInfoList[0].LeaderProposalNo</code> N\u00famero da proposta na L\u00edder. DT_PROP <code>CoInsuranceInfoList[0].LeaderProposalDate</code> Data da proposta na L\u00edder. Formato <code>DDMMYYYY</code>. CPF_SEG <code>PolicyCustomerList</code> Busca o <code>IdNo</code> (CPF/CNPJ) do cliente onde <code>IsInsured</code> for <code>Y</code> ou <code>true</code>. PRC_COMISS_COFEE <code>CoInsuranceInfoList[0].PrcComissCofee</code> Percentual de comiss\u00e3o de Cofee. <p>Prioridade: Tenta <code>PrcComissCofee102</code>, se nulo usa <code>PrcComissCofee</code>. Formata com at\u00e9 4 casas decimais. |</p>"},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#4-regras-de-negocio-implementadas","title":"4. Regras de Neg\u00f3cio Implementadas","text":"<ol> <li>Agrega\u00e7\u00e3o por Movimento: O arquivo gera **uma linha por <code>PolicyId**</code>. N\u00e3o h\u00e1 quebra por cobertura. Todos os valores financeiros das coberturas s\u00e3o somados para compor o total do movimento.</li> <li>C\u00e1lculos Pr\u00e9-Existentes: O script n\u00e3o recalcula percentuais (como 40% de participa\u00e7\u00e3o ou 6.8% de Cofee). Ele confia que os valores persistidos no JSON da Ap\u00f3lice (<code>PrCossAc</code>, <code>Cofee</code>, etc.) j\u00e1 foram calculados corretamente pelo motor de c\u00e1lculo no momento da emiss\u00e3o/endosso.</li> <li>Tratamento de Endosso de Emiss\u00e3o (101): Para movimentos do tipo 101, o campo <code>NUM_END</code> \u00e9 for\u00e7ado para uma string de zeros, conforme padr\u00e3o de arquivos regulat\u00f3rios que n\u00e3o esperam n\u00famero de endosso na emiss\u00e3o original.</li> <li>Sanitiza\u00e7\u00e3o: Todos os campos de texto t\u00eam quebras de linha (<code>\\n</code>, <code>\\r</code>) e o caractere delimitador (<code>|</code>) removidos para n\u00e3o quebrar o layout do CSV.</li> </ol>"},{"location":"coinsurance/retornos/premac/premac-especificacao-tecnica/#5-especificacao-do-arquivo-fisico","title":"5. Especifica\u00e7\u00e3o do Arquivo F\u00edsico","text":"<ul> <li>Nome do Arquivo: <code>PREMAC_{YYYYMM}_{timestamp}.csv</code></li> <li> <p>Exemplo: <code>PREMAC_202601_20260120_143000.csv</code></p> </li> <li> <p>Encoding: UTF-8</p> </li> <li>Delimitador: Pipe (<code>|</code>)</li> <li>Destino: Bucket S3, pasta <code>export</code>.</li> <li>Log de Erros: Caso ocorra falha no processamento de linhas espec\u00edficas, um arquivo <code>LOG_PREMAC_{YYYYMM}_{timestamp}.csv</code> \u00e9 gerado na pasta <code>error</code> contendo o ID da ap\u00f3lice e a mensagem de erro.</li> </ul>"},{"location":"coinsurance/retornos/premac/premac/","title":"PREMAC \u2014 Vis\u00e3o geral (RO BMG)","text":"<p>O que \u00e9 (neg\u00f3cio): PREMAC \u00e9 o arquivo de retorno (RO) que materializa, para fins regulat\u00f3rios/cont\u00e1beis, os valores do cosseguro aceito (BMG = 03417) para um conjunto de ap\u00f3lices (Master/Certificate) j\u00e1 persistidas na estrutura definitiva (Policy/PolicyCore).</p> <p>Como este projeto gera: a exporta\u00e7\u00e3o n\u00e3o l\u00ea o PREMIT f\u00edsico; ela consulta o \u00edndice de Policy e carrega o PolicyCore para montar 1 linha por Policy, aplicando regras de c\u00e1lculo de valores aceitos (participa\u00e7\u00e3o) e campos fixos (COD_CIA/COD_COSS).</p>"},{"location":"coinsurance/retornos/premac/premac/#escopo","title":"Escopo","text":"<ul> <li>Arquivo/RO: <code>PREMAC</code></li> <li>\u00c1rea: Retornos (ROs) \u2192 Ap\u00f3lice / Pr\u00eamio</li> <li>Entrada do motor: Policy index + PolicyCore (estrutura definitiva)</li> <li>Sa\u00edda: <code>PREMAC_YYYYMM_&lt;timestamp&gt;.csv</code> (delimitador <code>|</code>)</li> <li>Regras SUSEP / espec: usadas como refer\u00eancia de campos e f\u00f3rmulas, mas a origem dos dados \u00e9 a estrutura definitiva.</li> </ul>"},{"location":"coinsurance/retornos/premac/premac/#gatilho-e-periodicidade","title":"Gatilho e periodicidade","text":"<ul> <li>Gatilho: execu\u00e7\u00e3o do job de export do per\u00edodo (DT_BASE = YYYYMM) no fechamento.</li> <li>Per\u00edodo (DT_BASE): normalmente vem do orquestrador como <code>YYYYMM</code> (ex.: <code>202512</code>).</li> <li>Filtro por compet\u00eancia (BaseDate no \u00edndice):</li> <li>quando habilitado, o per\u00edodo <code>YYYYMM</code> \u00e9 convertido para <code>YYYY-MM-01</code> para filtrar <code>BaseDate</code> no \u00edndice.</li> </ul>"},{"location":"coinsurance/retornos/premac/premac/#fonte-de-dados-estrutura-definitiva","title":"Fonte de dados (estrutura definitiva)","text":""},{"location":"coinsurance/retornos/premac/premac/#1-indice-policy","title":"1) \u00cdndice (Policy)","text":"<p>Consulta por lotes com pagina\u00e7\u00e3o por <code>entity_id</code> (keyset):</p> <ul> <li><code>FullOrgCode.multiLineExact = \"bmg\"</code></li> <li><code>CodCoss.multiLineExact = \"05908\"</code></li> <li><code>BaseDate = \"YYYY-MM-01\"</code> (quando habilitado)</li> </ul> <p>O resultado do \u00edndice entrega o documento m\u00ednimo (incluindo <code>PolicyId</code>/<code>entity_id</code>) para carregarmos o PolicyCore.</p>"},{"location":"coinsurance/retornos/premac/premac/#2-policycore-load","title":"2) PolicyCore (load)","text":"<p>Para cada <code>policyId</code> retornado do \u00edndice, o servi\u00e7o faz <code>load</code> do core e monta a linha PREMAC.</p>"},{"location":"coinsurance/retornos/premac/premac/#campos-do-premac-e-origem-no-policycore","title":"Campos do PREMAC e origem no PolicyCore","text":""},{"location":"coinsurance/retornos/premac/premac/#identificacao-regulatorio","title":"Identifica\u00e7\u00e3o (regulat\u00f3rio)","text":"Campo PREMAC Origem (Policy/PolicyCore) Regra <code>SEQUENCIA</code> contador local inicia em 1; formatado/padded <code>COD_CIA</code> constante sempre <code>03417</code> <code>NUM_PROC</code> <code>NumProcLider</code> (ou l\u00edder em <code>CoInsuranceInsurerList</code>) obrigat\u00f3rio <code>DT_BASE</code> per\u00edodo do job (<code>YYYYMM</code>) ou <code>DtBase</code> do core padronizar para <code>YYYYMM</code> <code>TIPO_MOV</code> <code>TipoMov</code> obrigat\u00f3rio <code>UF_DEP</code> <code>UFDep</code> obrigat\u00f3rio <code>UF_RISCO</code> <code>UFRisco</code> obrigat\u00f3rio <code>COD_RAMO</code> <code>CodRamoProduto</code> (padr\u00e3o) (alternativa: <code>PolicyCoverage[].CodRamo</code>) <code>NUM_APOL</code> <code>CoInsuranceInfoList[0].LeaderPolicyNo</code> obrigat\u00f3rio <code>NUM_END</code> <code>LeaderEndorsementNo</code> (ou zeros se emiss\u00e3o) se <code>TipoMov=101</code> \u2192 <code>000...0</code> <code>COD_COSS</code> constante sempre <code>05908</code> (l\u00edder) <code>DT_EMIS</code> <code>IssueDate</code> formato SUSEP <code>YYYYMMDD</code> <code>DT_INI_VIG</code> <code>EffectiveDate</code> <code>YYYYMMDD</code> <code>DT_FIM_VIG</code> <code>ExpiryDate</code> <code>YYYYMMDD</code>"},{"location":"coinsurance/retornos/premac/premac/#valores-regulatorio-gerencial","title":"Valores (regulat\u00f3rio + gerencial)","text":"<p>O PolicyCore geralmente j\u00e1 carrega valores por cobertura com vers\u00f5es \u201cLider\u201d e \u201cCosseguro (Ac)\u201d (ex.: <code>PrCossAc</code>, <code>ComCosAc</code>, <code>AdFracCoss</code>, <code>LaborAmountCoss</code>). O PREMAC exporta totalizadores por Policy, ent\u00e3o faz soma em <code>PolicyCoverageList</code>.</p> Campo PREMAC Prefer\u00eancia (Core) Fallback (regra) <code>PR_EMIT</code> <code>GrossPremium</code> ou <code>BeforeVatPremium</code> (\u00faltimo recurso) somar <code>OverrideBeforeVatPremium</code> <code>PR_COSS_AC</code> soma <code>PolicyCoverage[].PrCossAc</code> <code>PR_EMIT * 0,40</code> <code>COM_COSS_AC</code> soma <code>PolicyCoverage[].ComCosAc</code> <code>Commission * 0,40</code> <code>AD_FRAC</code> soma <code>PolicyCoverage[].AdFracCoss</code> soma <code>AdFracLider * 0,40</code> <code>PRO_LAB</code> soma <code>PolicyCoverage[].LaborAmountCoss</code> soma <code>LaborAmountLider * 0,40</code> <code>PRC_COMISS_COFEE</code> <code>CoInsuranceInfoList[0].PrcComissCofee</code> default <code>0,068</code> (6,8%) <code>COFEE</code> <code>PR_COSS_AC * PRC_COMISS_COFEE</code> idem"},{"location":"coinsurance/retornos/premac/premac/#pontos-de-atencao-para-ajuste-do-gerador","title":"Pontos de aten\u00e7\u00e3o (para ajuste do gerador)","text":"<p>1) Filtro de BaseDate - Evite desabilitar <code>baseDateIndex</code> \u201cna m\u00e3o\u201d, sen\u00e3o o export pode trazer todo o tenant.</p> <p>2) COD_RAMO - Defina qual \u00e9 o \u201cramo do PREMAC\u201d: <code>CodRamoProduto</code> (produto) vs <code>CodRamo</code> por cobertura. - Se houver m\u00faltiplos ramos por cobertura, o \u201cpor Policy\u201d vira uma decis\u00e3o (ex.: pegar o principal ou quebrar por ramo).</p> <p>3) Movimentos 103\u2013108 (cofee) - A regra de \u201cbuscar percentual da emiss\u00e3o original\u201d pode ser feita via:   - <code>PrcComissCofee</code> j\u00e1 persistido no core ou   - busca em PREMAC anterior (se voc\u00eas decidirem persistir essa refer\u00eancia) - Como combinamos: a origem \u00e9 Policy/PolicyCore; a especifica\u00e7\u00e3o \u00e9 s\u00f3 refer\u00eancia.</p>"},{"location":"coinsurance/retornos/premac/premac/#referencias","title":"Refer\u00eancias","text":"<ul> <li>Especifica\u00e7\u00e3o funcional: <code>premac/premac-especificacao-funcional.md</code></li> <li>Especifica\u00e7\u00e3o t\u00e9cnica: <code>premac/premac-especificacao-tecnica.md</code></li> <li>C\u00f3digo (service): <code>CoinsurancePremacService.groovy</code></li> </ul>"},{"location":"coinsurance/sinistro/","title":"Sinistro \u2014 Vis\u00e3o geral","text":"<p>Nesta etapa, o objetivo \u00e9 registrar e acompanhar o sinistro no ciclo:</p> <ul> <li>SINAV: aviso/abertura e altera\u00e7\u00f5es do sinistro</li> <li>SINPEND: saldo pendente (posi\u00e7\u00e3o financeira do sinistro)</li> <li>SINPAG: pagamento efetivo (liquida\u00e7\u00e3o) do sinistro</li> </ul> <p>Cada arquivo entra como registros PENDING e \u00e9 processado para relacionar com ap\u00f3lice/certificado e com o sinistro existente.</p>"},{"location":"coinsurance/sinistro/sinav/","title":"SINAV \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>TODO: detalhar aviso/abertura, reavalia\u00e7\u00e3o, cancelamento, reabertura, e como isso impacta o estado do sinistro.</p>"},{"location":"coinsurance/sinistro/sinpag/","title":"SINPAG \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>SINPAG trata o pagamento efetivo do sinistro (informa\u00e7\u00f5es banc\u00e1rias, recebimento/transa\u00e7\u00e3o) e deve refletir a liquida\u00e7\u00e3o (parcial/final).</p> <p>TODO: complementar com o fluxo final de settlement quando a implementa\u00e7\u00e3o estiver conclu\u00edda.</p>"},{"location":"coinsurance/sinistro/sinpend/","title":"SINPEND \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>TODO: detalhar posi\u00e7\u00e3o pendente do sinistro e como cruza com sinistro/ap\u00f3lice.</p>"},{"location":"coinsurance/sinistro/depara/sinav/","title":"SINAV \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceSinAvService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsSinAv</code></p>"},{"location":"coinsurance/sinistro/depara/sinav/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_sinav</code></li> </ul>"},{"location":"coinsurance/sinistro/depara/sinav/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_SIN ClaimNumber NUM_APOL PolicyNumber NUM_END EndorsementNumber CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_BEN BeneficiaryDocumentId QTD_BEN BeneficiaryQuantity DT_REG RegistrationDate DT_AVISO NoticeDate DT_OCOR OccurrenceDate VR_COS_CED CededCoinsuranceValue VR_MOV MovementValue DT_MOV MovementDate TP_SIN ClaimType COD_PRD CodPrd IND_CPF IndCpf DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/sinistro/depara/sinav/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/sinistro/depara/sinpag/","title":"SINPAG \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceSinPagService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsSinPag</code></p>"},{"location":"coinsurance/sinistro/depara/sinpag/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_sinpag</code></li> </ul>"},{"location":"coinsurance/sinistro/depara/sinpag/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_SIN ClaimNumber NUM_APOL PolicyNumber NUM_END EndorsementNumber CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_BEN BeneficiaryDocumentId QTD_BEN BeneficiaryQuantity DT_REG RegistrationDate DT_AVISO NoticeDate DT_OCOR OccurrenceDate VR_COS_CED CededCoinsuranceValue VR_MOV MovementValue DT_MOV MovementDate TP_SIN ClaimType TIPO_REC ReceiptType NUM_BAN_SE InsurerBankNumber NUM_AGE_SE InsurerAgencyNumber NUM_CON_SE InsurerAccountNumber NUM_TRANSA TransactionNumber NUM_BAN InsuredBankNumber NUM_AGE InsuredAgencyNumber NUM_CON InsuredAccountNumber DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/sinistro/depara/sinpag/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/sinistro/depara/sinpend/","title":"SINPEND \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceSinPendService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsSinPend</code></p>"},{"location":"coinsurance/sinistro/depara/sinpend/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_sinpend</code></li> </ul>"},{"location":"coinsurance/sinistro/depara/sinpend/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_SIN ClaimNumber NUM_APOL PolicyNumber NUM_END EndorsementNumber CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_BEN BeneficiaryDocumentId QTD_BEN BeneficiaryQuantity DT_REG RegistrationDate DT_AVISO NoticeDate DT_OCOR OccurrenceDate VR_COS_CED CededCoinsuranceValue VR_PENDENT PendingValue VR_TOT TotalValue TP_SIN ClaimType DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/sinistro/depara/sinpend/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."}]}