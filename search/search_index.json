{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Documenta\u00e7\u00e3o \u2014 Coinsurance (BMG)","text":"<p>Bem-vindo(a) ao reposit\u00f3rio de documenta\u00e7\u00e3o do fluxo de Coinsurance.</p>"},{"location":"#onde-comecar","title":"Onde come\u00e7ar","text":"<ul> <li>Coinsurance \u2192 Vis\u00e3o geral do fluxo: vis\u00e3o macro dos arquivos e etapas</li> <li>Coinsurance \u2192 Ap\u00f3lice: emiss\u00e3o/endosso (PREMIT, PREMREC, PREMRECEB, RESPREM)</li> <li>Coinsurance \u2192 Sinistro: aviso, pend\u00eancia e pagamento (SINAV, SINPEND, SINPAG)</li> </ul>"},{"location":"#convencoes-do-repositorio","title":"Conven\u00e7\u00f5es do reposit\u00f3rio","text":"<ul> <li>Este reposit\u00f3rio n\u00e3o inclui os validadores OPA/Velora (mantidos em outro repo).</li> <li>Sempre que poss\u00edvel, o De/Para \u00e9 gerado a partir do c\u00f3digo-fonte (services + entities).</li> </ul>"},{"location":"coinsurance/","title":"Coinsurance \u2014 Vis\u00e3o geral do fluxo","text":""},{"location":"coinsurance/#estrutura-macro-dos-arquivos","title":"Estrutura macro dos arquivos","text":"<ul> <li>Ap\u00f3lice: PREMIT, PREMREC, PREMRECEB, RESPREM</li> <li>Sinistro: SINAV, SINPEND, SINPAG</li> <li>Retornos (RO BMG): PREMAC, PREMRECAC, PREMRECEBC, SINAVAC, SINPENDAC, SINPAGAC</li> </ul>"},{"location":"coinsurance/#estados-de-processamento-padrao-no-codigo","title":"Estados de processamento (padr\u00e3o no c\u00f3digo)","text":"<ul> <li><code>PENDING</code>: registro ingerido e ainda n\u00e3o processado</li> <li><code>COMPLETED</code>: processado com sucesso</li> <li><code>ERROR</code>: erro no processamento (em alguns servi\u00e7os o update est\u00e1 marcado como TODO)</li> <li><code>DUPLICATED</code>: duplicado (h\u00e1 trechos comentados/TODO)</li> </ul>"},{"location":"coinsurance/#identificacao-tecnica-fileid","title":"Identifica\u00e7\u00e3o t\u00e9cnica (FileId)","text":"<p>Nos servi\u00e7os de ingest\u00e3o, cada linha do CSV vira um registro com <code>FileId</code> derivado:</p> <ul> <li><code>FileId = &lt;etag_do_arquivo_no_S3&gt;_&lt;SEQUENCIA&gt;</code></li> </ul> <p>Isso garante unicidade por arquivo + linha.</p> <p>Note</p> <p>A chave do arquivo (S3 key) tamb\u00e9m \u00e9 salva como <code>FileName</code> (apenas o nome do arquivo).</p>"},{"location":"coinsurance/apolice/","title":"Ap\u00f3lice \u2014 Vis\u00e3o geral (Coinsurance)","text":"<p>Esta se\u00e7\u00e3o descreve o ciclo de Pr\u00eamio do cosseguro, do ponto de vista do aceito, desde a emiss\u00e3o/endosso at\u00e9 recebimento e reserva mensal.</p>"},{"location":"coinsurance/apolice/#o-que-entra-e-o-que-sai","title":"O que entra e o que sai","text":""},{"location":"coinsurance/apolice/#entradas-do-lider","title":"Entradas (do l\u00edder)","text":"<ul> <li>PREMIT: movimento \u201cmacro\u201d (emiss\u00e3o/endosso) com valores consolidados</li> <li>PREMREC: detalhamento por parcelas (cronograma / valores por parcela)</li> <li>PREMRECEB: recebimento efetivo (baixa banc\u00e1ria)</li> <li>RESPREM: reserva/PPNG do m\u00eas (posi\u00e7\u00e3o de fechamento)</li> </ul>"},{"location":"coinsurance/apolice/#saidas-bmg-aceito","title":"Sa\u00eddas (BMG / aceito)","text":"<ul> <li>Retornos/RO com vis\u00e3o proporcional e enriquecida (ex.: PREMRECEBC, RESPREMC)</li> </ul>"},{"location":"coinsurance/apolice/#fluxos-do-dominio-apolice","title":"Fluxos do dom\u00ednio (Ap\u00f3lice)","text":""},{"location":"coinsurance/apolice/#emissao-e-endosso-apolice-definitiva-no-modulo-policy","title":"Emiss\u00e3o e Endosso (Ap\u00f3lice Definitiva no m\u00f3dulo Policy)","text":"<p>Este \u00e9 o fluxo central do bloco Ap\u00f3lice, respons\u00e1vel por criar/atualizar a ap\u00f3lice definitiva (Master Policy + Certificate Policy) a partir dos arquivos SUSEP:</p> <ul> <li>PREMIT (pai): registro mestre do movimento</li> <li>PREMREC (motor): parcelas e execu\u00e7\u00e3o operacional (emiss\u00e3o/endosso)</li> </ul> <p>\u27a1\ufe0f Leia o fluxo completo aqui: Emiss\u00e3o da Ap\u00f3lice (Master/Certificate) \u2014 PREMIT + PREMREC</p>"},{"location":"coinsurance/apolice/#papel-de-cada-arquivo-no-negocio","title":"Papel de cada arquivo no neg\u00f3cio","text":"<ul> <li>PREMIT (pai)   Registro mestre do movimento. Responde:</li> <li>\u201cO que aconteceu com a ap\u00f3lice/certificado?\u201d</li> <li> <p>\u201cQuais os totalizadores e a vig\u00eancia do movimento?\u201d</p> </li> <li> <p>PREMREC (motor)   Detalha parcelas e viabiliza a execu\u00e7\u00e3o operacional. Responde:</p> </li> <li>\u201cComo o pr\u00eamio foi parcelado?\u201d</li> <li> <p>\u201cQuais vencimentos/valores por parcela?\u201d</p> </li> <li> <p>PREMRECEB (caixa)   Confirma recebimento efetivo. Responde:</p> </li> <li> <p>\u201cQuais parcelas foram pagas, quando e por qual valor?\u201d</p> </li> <li> <p>RESPREM (compet\u00eancia/PPNG)   Controla reserva no fechamento mensal. Responde:</p> </li> <li>\u201cQuanto do pr\u00eamio ainda n\u00e3o foi ganho (risco n\u00e3o decorrido) no m\u00eas?\u201d</li> </ul>"},{"location":"coinsurance/apolice/#como-usar-esta-documentacao","title":"Como usar esta documenta\u00e7\u00e3o","text":"<p>1) Leia o fluxo de emiss\u00e3o (Master/Certificate) para entender a l\u00f3gica principal de cria\u00e7\u00e3o/atualiza\u00e7\u00e3o.</p> <p>2) Em seguida, v\u00e1 arquivo a arquivo:   - PREMIT / PREMREC / PREMRECEB / RESPREM</p> <p>3) Depois, consulte o De/Para para ver:   - campo do arquivo f\u00edsico \u2192 campo persistido   - normaliza\u00e7\u00f5es e tipos</p> <p>4) Use as p\u00e1ginas para:   - troubleshooting de diverg\u00eancias (chaves, status, duplicidade)   - entendimento do ciclo ponta-a-ponta</p>"},{"location":"coinsurance/apolice/premit/","title":"PREMIT \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>Defini\u00e7\u00e3o curta: PREMIT \u00e9 o cabe\u00e7alho/espelho do movimento de emiss\u00e3o/endosso do pr\u00eamio (consolidado), no contexto de cosseguro.</p>"},{"location":"coinsurance/apolice/premit/#o-que-ele-representa-no-negocio","title":"O que ele representa no neg\u00f3cio","text":"<p>O PREMIT representa o movimento de pr\u00eamio emitido relacionado a uma ap\u00f3lice/certificado, trazendo:</p> <ul> <li>Chaves principais (ramo, ap\u00f3lice, endosso, proposta, cia)</li> <li>Datas de refer\u00eancia (base/compet\u00eancia, proposta, emiss\u00e3o, in\u00edcio e fim de vig\u00eancia)</li> <li>Valores consolidados do movimento (pr\u00eamio emitido, pr\u00eamio cedido, comiss\u00f5es, IOF, custos, adicional fracionamento, pr\u00f3-labore etc.)</li> </ul>"},{"location":"coinsurance/apolice/premit/#para-que-serve-no-fluxo-operacional","title":"Para que serve no fluxo operacional","text":"<ul> <li>D\u00e1 rastreabilidade do evento: \u201co que aconteceu\u201d com a ap\u00f3lice naquele ciclo.</li> <li>Serve como registro pai para correlacionar o detalhamento (PREMREC) e suportar concilia\u00e7\u00e3o.</li> </ul>"},{"location":"coinsurance/apolice/premit/#como-ele-se-complementa-com-premrec","title":"Como ele se complementa com PREMREC","text":"<ul> <li>PREMIT (pai): 1 registro por movimento com o consolidado.</li> <li>PREMREC (filhos): N registros por movimento, tipicamente por parcela, e \u00e9 o que viabiliza o processamento real.</li> </ul> <p>Note</p> <p>No fluxo interno, o PREMIT costuma entrar como PENDING e n\u00e3o \u201cemite ap\u00f3lice\u201d sozinho \u2014 quem executa a emiss\u00e3o/altera\u00e7\u00e3o \u00e9 o PREMREC.</p>"},{"location":"coinsurance/apolice/premrec/","title":"PREMREC \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>Defini\u00e7\u00e3o curta: PREMREC \u00e9 o detalhe operacional do movimento: desdobra o pr\u00eamio em parcelas e viabiliza o processamento real de emiss\u00e3o/endosso.</p>"},{"location":"coinsurance/apolice/premrec/#o-que-ele-representa-no-negocio","title":"O que ele representa no neg\u00f3cio","text":"<p>O PREMREC descreve, para o mesmo movimento da ap\u00f3lice/certificado:</p> <ul> <li>Parcelamento (n\u00ba da parcela, quantidade total, datas relevantes)</li> <li>Valores por parcela (pr\u00eamio, IOF, custos, adicionais, comiss\u00e3o etc.)</li> </ul>"},{"location":"coinsurance/apolice/premrec/#para-que-serve-no-fluxo-operacional","title":"Para que serve no fluxo operacional","text":"<ul> <li>Materializa o plano de cobran\u00e7a do movimento.</li> <li>Permite que o sistema monte as estruturas internas de ap\u00f3lice/certificado/endosso, incluindo:</li> <li>valida\u00e7\u00f5es de segurado (party) e produto</li> <li>cria\u00e7\u00e3o de Master Policy e Certificate Policy</li> <li>processamento de endossos conforme tipo de movimento</li> </ul>"},{"location":"coinsurance/apolice/premrec/#complementaridade-com-premreceb","title":"Complementaridade com PREMRECEB","text":"<p>O PREMRECEB chega depois informando o recebimento (baixa) e \u00e9 cruzado com o parcelamento definido aqui.</p>"},{"location":"coinsurance/apolice/premreceb/","title":"PREMRECEB \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>Defini\u00e7\u00e3o curta: PREMRECEB registra o recebimento/liquida\u00e7\u00e3o do pr\u00eamio (por parcela/documento), viabilizando concilia\u00e7\u00e3o financeira e baixa.</p>"},{"location":"coinsurance/apolice/premreceb/#o-que-ele-representa-no-negocio","title":"O que ele representa no neg\u00f3cio","text":"<p>No neg\u00f3cio, o PREMRECEB materializa o fato financeiro:</p> <ul> <li>\u201co valor foi recebido\u201d (data de recebimento, valor do documento, desconto/multa/cobran\u00e7a)</li> <li>por qual documento/parcela (n\u00ba de boleto, nosso n\u00famero, documento, parcela, vencimento)</li> <li>com quais dados banc\u00e1rios (banco/ag\u00eancia/conta, identificadores)</li> </ul>"},{"location":"coinsurance/apolice/premreceb/#para-que-serve-no-fluxo-operacional","title":"Para que serve no fluxo operacional","text":"<ul> <li>Concilia emitido (PREMREC) vs recebido.</li> <li>Alimenta (ou deveria alimentar) a baixa/liquida\u00e7\u00e3o no downstream financeiro (ex.: BCP), conforme implementa\u00e7\u00e3o.</li> </ul> <p>Warning</p> <p>No c\u00f3digo atual, existem TODOs e valores hardcoded em partes do processamento (ex.: busca de master policy). Isso indica fluxo ainda em evolu\u00e7\u00e3o.</p>"},{"location":"coinsurance/apolice/resprem/","title":"RESPREM \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>Defini\u00e7\u00e3o curta: RESPREM \u00e9 a resposta/resumo do que foi processado para pr\u00eamio (emiss\u00e3o/endosso), usado para concilia\u00e7\u00e3o e retorno.</p>"},{"location":"coinsurance/apolice/resprem/#o-que-ele-representa-no-negocio","title":"O que ele representa no neg\u00f3cio","text":"<p>O RESPREM costuma consolidar:</p> <ul> <li>Identifica\u00e7\u00e3o do movimento (ramo, ap\u00f3lice, endosso, proposta)</li> <li>Datas de emiss\u00e3o e vig\u00eancia</li> <li>Totais de pr\u00eamio e indicadores relevantes para reconciliar com o que foi ingerido</li> </ul>"},{"location":"coinsurance/apolice/resprem/#para-que-serve-no-fluxo-operacional","title":"Para que serve no fluxo operacional","text":"<ul> <li>Funciona como \u201cespelho de resultado\u201d (o que o sistema reconheceu/registrou como processado).</li> <li>Suporta concilia\u00e7\u00e3o e auditoria do ciclo: emitido \u2192 parcelado \u2192 recebido.</li> </ul> <p>Note</p> <p>O formato exato e a sem\u00e2ntica podem variar conforme acordos operacionais/integra\u00e7\u00e3o.</p>"},{"location":"coinsurance/apolice/depara/mapeamentos-internos/","title":"Ap\u00f3lice \u2014 Mapeamentos internos (Policy / CoinsuranceInfo / Coverage)","text":"<p>Origem: <code>CoinsurancePremRecService.groovy</code> (m\u00e9todos de montagem de ap\u00f3lice/endosso)</p>"},{"location":"coinsurance/apolice/depara/mapeamentos-internos/#a-policyinfo-campos-adicionais-no-policyendosso","title":"A) PolicyInfo (campos adicionais no Policy/Endosso)","text":"Chave no PolicyInfo Origem (entidade) Destino AdjustedPremium entity.FractionalSurchargeValue Policy/Endosso (campos adicionais no PolicyInfo). DuePremium entity.IssuedPremium Policy/Endosso (campos adicionais no PolicyInfo). GrossPremium entity.PolicyCostValue Policy/Endosso (campos adicionais no PolicyInfo). Commission entity.CoinsuranceCommissionAmount Policy/Endosso (campos adicionais no PolicyInfo). CommissionLocal entity.BrokerageCommissionAmount Policy/Endosso (campos adicionais no PolicyInfo). OriginalFileName entity.FileName Policy/Endosso (campos adicionais no PolicyInfo). EffectiveDate entity.EffectiveDate Policy/Endosso (campos adicionais no PolicyInfo). ExpiryDate entity.EndDate Policy/Endosso (campos adicionais no PolicyInfo). IssueDate entity.IssueDate Policy/Endosso (campos adicionais no PolicyInfo). TipoMov entity.MovementType Policy/Endosso (campos adicionais no PolicyInfo). DtBase entity.BaseDate Policy/Endosso (campos adicionais no PolicyInfo). CdProduto entity.ProductCode Policy/Endosso (campos adicionais no PolicyInfo). DsProduto entity.ProductDescription Policy/Endosso (campos adicionais no PolicyInfo). CdBu entity.BusinessUnitCode Policy/Endosso (campos adicionais no PolicyInfo). DsBu entity.BusinessUnitDescription Policy/Endosso (campos adicionais no PolicyInfo). CdOperacao entity.OperationCode Policy/Endosso (campos adicionais no PolicyInfo). CdCarteira entity.WalletCode Policy/Endosso (campos adicionais no PolicyInfo). DsCarteira entity.WalletDescription Policy/Endosso (campos adicionais no PolicyInfo). CdSucursal entity.SucursalCode Policy/Endosso (campos adicionais no PolicyInfo). FgGeb entity.FgGeb Policy/Endosso (campos adicionais no PolicyInfo). DcrTipOper entity.OperationDescription Policy/Endosso (campos adicionais no PolicyInfo). DsOrigem entity.OriginDescription Policy/Endosso (campos adicionais no PolicyInfo). DsGrupoRamo entity.BranchGroupDescription Policy/Endosso (campos adicionais no PolicyInfo). UFDep entity.IssuingState Policy/Endosso (campos adicionais no PolicyInfo). UFRisco entity.RiskStates Policy/Endosso (campos adicionais no PolicyInfo). CodCiaLider entity.CompanyCode Policy/Endosso (campos adicionais no PolicyInfo). NumProcLider entity.Protocol Policy/Endosso (campos adicionais no PolicyInfo)."},{"location":"coinsurance/apolice/depara/mapeamentos-internos/#b-coinsuranceinfo-lista","title":"B) CoinsuranceInfo (lista)","text":"Chave no CoinsuranceInfo Origem (entidade) Destino"},{"location":"coinsurance/apolice/depara/mapeamentos-internos/#c-coverage-coberturas","title":"C) Coverage (coberturas)","text":"Campo no Coverage Origem (entidade) Destino SumInsured entity.IsValue Coverage (itens/coberturas no endorsement). SequenceNumber entity.Sequence Coverage (itens/coberturas no endorsement). SequenceBMG entity.RecordNo Coverage (itens/coberturas no endorsement). OverrideBeforeVatPremium entity.IssuedPremium Coverage (itens/coberturas no endorsement). OverrideVat entity.TaxAmount Coverage (itens/coberturas no endorsement). OverrideCommission entity.BrokerageCommissionAmount Coverage (itens/coberturas no endorsement). AdFracLider entity.FractionalSurchargeValue Coverage (itens/coberturas no endorsement). CustApol entity.PolicyCostValue Coverage (itens/coberturas no endorsement). LaborAmountLider entity.ProLaboreValue Coverage (itens/coberturas no endorsement). PrCosCed entity.CededCoinsurancePremium Coverage (itens/coberturas no endorsement). ComisCoss entity.CoinsuranceCommissionAmount Coverage (itens/coberturas no endorsement). <p>Note</p> <p>Esses mapeamentos s\u00e3o internos (n\u00e3o v\u00eam diretamente do CSV). Eles s\u00e3o gerados no processamento do PREMREC ao montar ap\u00f3lice/endosso.</p>"},{"location":"coinsurance/apolice/depara/premit/","title":"PREMIT \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremitService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremit</code></p>"},{"location":"coinsurance/apolice/depara/premit/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_premit</code></li> </ul>"},{"location":"coinsurance/apolice/depara/premit/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode NUM_PROC Protocol DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). UF_DEP IssuingState UF_RISCO RiskStates COD_RAMO BranchCode NUM_APOL PolicyNumber NUM_END EndorsementNumber NUM_PROP ProposalNumber DT_PROP ProposalDate CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_TOM BorrowerDocumentId QTD_TOM BorrowersQuantity DT_EMIS IssueDate DT_INI_VIG EffectiveDate DT_FIM_VIG EndDate PR_EMIT IssuedPremium PR_COS_CED CededCoinsurancePremium AD_FRAC FractionalSurchargeValue CUST_APOL PolicyCostValue IOF TaxAmount COMIS BrokerageCommissionAmount COMIS_COSS CoinsuranceCommissionAmount PRO_LAB ProLaboreValue CPF_ESTIP StipulatorDocumentId IS IsValue DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/apolice/depara/premit/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/apolice/depara/premrec/","title":"PREMREC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremRecService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremRec</code></p>"},{"location":"coinsurance/apolice/depara/premrec/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_premrec</code></li> </ul>"},{"location":"coinsurance/apolice/depara/premrec/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_APOL PolicyNumber NUM_END EndorsementNumber NUM_PROP ProposalNumber DT_PROP ProposalDate PRESTACAO InstallmentNumber QTDE_PREST InstallmentQuantity DT_EMIS_PR InstallmentIssueDate DT_VEN_PRE InstallmentDueDate DT_INI_VIG EffectiveDate DT_FIM_VIG EndDate PR_EMIT IssuedPremium PERC_COSS InstallmentPremiumIssued AD_FRAC FractionalSurchargeValue CUS_APOL PolicyCostValue IOF TaxAmount OFER Ofer DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/apolice/depara/premrec/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/apolice/depara/premreceb/","title":"PREMRECEB \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremRecebService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremReceb</code></p>"},{"location":"coinsurance/apolice/depara/premreceb/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_prereceb</code></li> </ul>"},{"location":"coinsurance/apolice/depara/premreceb/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_APOL PolicyNumber NUM_END EndorsementNumber NUM_PROP ProposalNumber DT_PROP ProposalDate PRESTACAO InstallmentNumber DT_REC_PRE InstallmentReceiptDate DT_VEN_PRE InstallmentDueDate NUM_BAN BankNumber CNPJ_BAN BankDocumentId NUM_BOL TicketNumber NUM_DOC DocumentNumber NUM_AGE AgencyNumber NUM_NOS OurNumber VAL_DOC DocumentValue VAL_DESC DiscountValue VAL_MUL FineValue VAL_COB ChargedValue DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/apolice/depara/premreceb/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/apolice/depara/resprem/","title":"RESPREM \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceResPremService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsResPrem</code></p>"},{"location":"coinsurance/apolice/depara/resprem/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_resprem</code></li> </ul>"},{"location":"coinsurance/apolice/depara/resprem/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_APOL PolicyNumber NUM_END EndorsementNumber NUM_PROP ProposalNumber DT_PROP ProposalDate DT_EMIS IssueDate DT_INI_VIG EffectiveDate DT_FIM_VIG EndDate PR_EMIT IssuedPremium PR_COS_CED CededCoinsurancePremium PR_N_GANHO UnwonPremiumValue COLET Collective DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/apolice/depara/resprem/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/","title":"Emiss\u00e3o da Ap\u00f3lice (Master/Certificate) \u2014 PREMIT + PREMREC (Coinsurance)","text":"<p>Escopo: fluxo de cria\u00e7\u00e3o/atualiza\u00e7\u00e3o da Ap\u00f3lice Definitiva no m\u00f3dulo Policy (Master Policy + Certificate Policy), a partir de PREMIT (pai) e PREMREC (parcelas/motor). Refer\u00eancias de c\u00f3digo: <code>CoinsurancePremitService.groovy</code>, <code>CoinsurancePremRecService.groovy</code> Entidades: <code>CnsPremit</code>, <code>CnsPremRec</code> Links r\u00e1pidos: PREMIT \u00b7 PREMREC \u00b7 De/Para PREMIT \u00b7 De/Para PREMREC</p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#visao-geral","title":"Vis\u00e3o geral","text":"<ul> <li>PREMIT entra como registro \u201cpai\u201d (fotografia da emiss\u00e3o/movimento) e fica PENDING.</li> <li>PREMREC entra como filho/parcelas e \u00e9 o motor operacional que:</li> <li>Cria/atualiza Master Policy e Certificate Policy (ap\u00f3lice definitiva no m\u00f3dulo Policy)</li> <li>Processa endossos</li> <li>Dispara integra\u00e7\u00e3o BCP no p\u00f3s-emiss\u00e3o</li> <li>Atualiza status para COMPLETED quando sucesso</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#31-premit-registro-mestre-do-movimento-base-da-emissao","title":"3.1 PREMIT \u2014 Registro mestre do movimento (base da emiss\u00e3o)","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#codigo-e-entidade","title":"C\u00f3digo e entidade","text":"<ul> <li>Service: <code>CoinsurancePremitService.groovy</code></li> <li>Entidade: <code>CnsPremit</code></li> <li>Campos principais (exemplos):</li> <li><code>BaseDate</code>, <code>MovementType</code>, <code>BranchCode</code></li> <li><code>PolicyNumber</code>, <code>EndorsementNumber</code>, <code>ProposalNumber</code></li> <li>datas de vig\u00eancia</li> <li>pr\u00eamios, comiss\u00f5es etc.</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#fluxo-real-no-codigo","title":"Fluxo real no c\u00f3digo","text":"<p>1) Ingest\u00e3o do arquivo - L\u00ea <code>PREMIT.CSV</code> em <code>uploaded/</code></p> <p>2) Valida\u00e7\u00e3o - Valida\u00e7\u00e3o de entrada (OPA/Velora) \u2014 fora deste reposit\u00f3rio</p> <p>3) Persist\u00eancia - <code>insertPremit()</code> com <code>Status = PENDING</code></p> <p>Comportamento importante</p> <p>O PREMIT n\u00e3o emite ap\u00f3lice sozinho. Ele funciona como registro mestre (pai) para correlacionar e orientar o processamento do PREMREC, que \u00e9 quem efetivamente cria/atualiza a ap\u00f3lice definitiva (Master/Certificate).</p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#papel-negocial-susep-operacional","title":"Papel negocial (SUSEP / operacional)","text":"<ul> <li>PREMIT representa a \u201cfotografia\u201d do movimento macro (emiss\u00e3o/endosso) com totalizadores e vig\u00eancia.</li> <li>No fluxo interno, \u00e9 a refer\u00eancia pai para o processamento de emiss\u00e3o/endosso no m\u00f3dulo Policy via PREMREC.</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#32-premrec-motor-de-emissao-mastercertificate-e-endosso","title":"3.2 PREMREC \u2014 Motor de emiss\u00e3o (Master/Certificate) e endosso","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#codigo-e-entidade_1","title":"C\u00f3digo e entidade","text":"<ul> <li>Service: <code>CoinsurancePremRecService.groovy</code></li> <li>Entidade: <code>CnsPremRec</code> (parcelas)</li> <li>Campos principais (exemplos):</li> <li><code>InstallmentNumber</code>, <code>InstallmentQuantity</code></li> <li>datas e valores por parcela</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#a-ingestao-do-premrec","title":"A) Ingest\u00e3o do PREMREC","text":"<p>1) Leitura - L\u00ea <code>PREMREC.CSV</code></p> <p>2) Valida\u00e7\u00e3o - Valida\u00e7\u00e3o de entrada (OPA/Velora) \u2014 fora deste reposit\u00f3rio</p> <p>3) Persist\u00eancia - Persiste <code>CnsPremRec</code> com <code>Status = PENDING</code></p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#b-processamento-criacaoalteracao-da-apolice-definitiva","title":"B) Processamento (cria\u00e7\u00e3o/altera\u00e7\u00e3o da ap\u00f3lice definitiva)","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#b1-selecao-do-pai-premit-e-dos-filhos-premrec","title":"B.1 Sele\u00e7\u00e3o do \u201cpai\u201d (PREMIT) e dos \u201cfilhos\u201d (PREMREC)","text":"<p>O service busca PREMIT pendentes e, para cada pai, busca os PREMREC pendentes correspondentes usando a chave:</p> <ul> <li>Chave de correla\u00e7\u00e3o (no pr\u00f3prio c\u00f3digo):</li> <li><code>MovementType + PolicyNumber + EndorsementNumber + ProposalNumber + Status = PENDING</code></li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#validacoes-e-decisoes-como-o-codigo-decide","title":"Valida\u00e7\u00f5es e decis\u00f5es (como o c\u00f3digo decide)","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#1-segurado-party-precisa-existir","title":"1) Segurado (Party) precisa existir","text":"<ul> <li>Antes de emitir, o fluxo busca party no cadastro por documento (CPF/CNPJ).</li> <li>Se n\u00e3o existir: falha (gera erro no fluxo).</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#2-produto-precisa-existir-na-rate-table","title":"2) Produto precisa existir na rate table","text":"<ul> <li>Lookup em <code>BMG_PolicyProduct</code> por:</li> <li><code>LeaderPolicyNo (PolicyNumber)</code> + <code>CdProduto (ProductCode)</code></li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#3-master-policy-apolice-master-pre-condicao-para-o-certificate","title":"3) Master Policy (ap\u00f3lice master) \u2014 pr\u00e9-condi\u00e7\u00e3o para o Certificate","text":"<ul> <li><code>fetchMasterPolicy(leaderPolicyNo)</code> busca <code>Policy</code> no m\u00f3dulo \u201cPolicy\u201d por:</li> <li><code>LeaderPolicyNo</code></li> <li><code>PolicyType = MASTER</code></li> <li><code>PolicyStatus = ISSUED</code></li> <li><code>FullOrgCode = tenant</code></li> <li>Se movimento for de emiss\u00e3o e master n\u00e3o existir: cria master (issuance)</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#4-certificate-policy-certificado-apolice-definitiva-emitida-para-o-segurado","title":"4) Certificate Policy (certificado) \u2014 ap\u00f3lice definitiva emitida para o segurado","text":"<ul> <li>Checa se certificado j\u00e1 existe: <code>existPolicyIssued(...)</code></li> <li>Se existe: trata como duplicado</li> <li>Se n\u00e3o existe: cria certificate e integra BCP</li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#5-endosso","title":"5) Endosso","text":"<ul> <li>Para <code>MovementType &gt; 102</code>, usa <code>processEndorsementIssuance(...)</code></li> <li>Mapeamento de movimentos (101\u2013108) para <code>endoType</code> via <code>CnsPremRec.getEndoType()</code>:</li> </ul> MovementType (TIPO_MOV) Descri\u00e7\u00e3o (SUSEP / Layout) O que significa na pr\u00e1tica endoType (se aplic\u00e1vel) 101 Emiss\u00e3o de Ap\u00f3lice Cria\u00e7\u00e3o da ap\u00f3lice/certificado (emiss\u00e3o inicial) \u2014 102 Endosso de cobran\u00e7a adicional de pr\u00eamio Endosso que aumenta pr\u00eamio (cobran\u00e7a complementar) \u2014 103 Endosso de restitui\u00e7\u00e3o de pr\u00eamio Endosso que reduz pr\u00eamio e gera restitui\u00e7\u00e3o 37 104 Cancelamento de Ap\u00f3lice com restitui\u00e7\u00e3o de pr\u00eamio Cancela a ap\u00f3lice e devolve pr\u00eamio 51 105 Cancelamento de Endosso com restitui\u00e7\u00e3o de pr\u00eamio Cancela um endosso e devolve pr\u00eamio 17 106 Cancelamento de Ap\u00f3lice sem restitui\u00e7\u00e3o de pr\u00eamio Cancela a ap\u00f3lice sem devolu\u00e7\u00e3o de pr\u00eamio 50 107 Cancelamento de Endosso sem restitui\u00e7\u00e3o de pr\u00eamio Cancela um endosso sem devolu\u00e7\u00e3o de pr\u00eamio 3 108 Endosso sem movimenta\u00e7\u00e3o de pr\u00eamio Endosso que altera condi\u00e7\u00f5es sem mexer no pr\u00eamio 20 109 Transfer\u00eancia de carteira Movimenta\u00e7\u00e3o para transfer\u00eancia de carteira (quando aplic\u00e1vel no layout) \u2014 <p>Nota importante (layout x implementa\u00e7\u00e3o)</p> <p>A tabela acima reflete a leitura negocial (layout SUSEP). O <code>endoType</code> reflete o que o c\u00f3digo implementa em <code>getEndoType()</code> e pode n\u00e3o cobrir todos os cen\u00e1rios como o layout descreve.</p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#integracao-com-bcp-pos-emissao","title":"Integra\u00e7\u00e3o com BCP (p\u00f3s-emiss\u00e3o)","text":"<p>Ap\u00f3s emiss\u00e3o, executa <code>integrateBcpAfterPolicyIssuance(policy)</code>:</p> <p>1) Gera taxa/fee: <code>GenerateFeeService</code> 2) Carrega <code>PolicyFeeInfo</code> 3) Monta payload 4) Envia via <code>DirectPostFeeReceiver</code></p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#atualizacao-de-status-sucesso-vs-erro","title":"Atualiza\u00e7\u00e3o de status (sucesso vs erro)","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#sucesso","title":"Sucesso","text":"<ul> <li>Se processou OK:</li> <li>Atualiza PREMREC e PREMIT relacionados para <code>COMPLETED</code></li> </ul>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#erro","title":"Erro","text":"<ul> <li><code>processParentAndChildrenAsError(...)</code> monta erro e grava <code>CnsError</code></li> <li>Ponto cr\u00edtico: as linhas que atualizariam PREMREC/PREMIT para <code>ERROR/DUPLICATED</code> est\u00e3o comentadas (TODO)</li> </ul> <p>Risco operacional</p> <p>Se o update para <code>ERROR/DUPLICATED</code> est\u00e1 comentado, registros podem ficar eternamente <code>PENDING</code> e serem reprocessados continuamente.</p>"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#tabelas-de-decisao-resumo-do-motor-premrec","title":"Tabelas de decis\u00e3o (resumo do motor PREMREC)","text":""},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#a-emissao-master-certificate","title":"A) Emiss\u00e3o / Master / Certificate","text":"Condi\u00e7\u00e3o A\u00e7\u00e3o principal Resultado esperado Party n\u00e3o existe Bloqueia emiss\u00e3o Erro registrado (<code>CnsError</code>) Produto n\u00e3o existe em rate table Bloqueia emiss\u00e3o Erro registrado (<code>CnsError</code>) Emiss\u00e3o + Master n\u00e3o existe Criar Master <code>Policy (MASTER)</code> emitida Certificate j\u00e1 existe (ISSUED) Tratar como duplicado (deveria marcar DUPLICATED, mas pode ficar PENDING) Certificate n\u00e3o existe Criar Certificate + integrar BCP Ap\u00f3lice emitida + fee/p\u00f3s-issue"},{"location":"coinsurance/apolice/fluxos/emissao-apolice-master-certificate.md/#b-endosso","title":"B) Endosso","text":"Condi\u00e7\u00e3o A\u00e7\u00e3o principal <code>MovementType &gt; 102</code> <code>processEndorsementIssuance(...)</code> <code>MovementType 101\u2013108</code> <code>getEndoType()</code> define <code>endoType</code>"},{"location":"coinsurance/retornos/","title":"Retornos (RO BMG) \u2014 Vis\u00e3o geral","text":"<p>Os arquivos RO s\u00e3o retornos/derivados gerados a partir do processamento interno, para consumo BMG/SUSEP.</p> <p>TODO: detalhar regra de gera\u00e7\u00e3o e chaves de correla\u00e7\u00e3o.</p>"},{"location":"coinsurance/retornos/premac/","title":"PREMAC \u2014 Retorno de ap\u00f3lice (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/premrecac/","title":"PREMRECAC \u2014 Retorno de parcelas (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/premrecebc/","title":"PREMRECEBC \u2014 Retorno de recebimento (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/sinavac/","title":"SINAVAC \u2014 Retorno de sinistro (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/sinpagac/","title":"SINPAGAC \u2014 Retorno pagamento (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/sinpendac/","title":"SINPENDAC \u2014 Retorno pend\u00eancias (BMG)","text":"<p>TODO: detalhar.</p>"},{"location":"coinsurance/retornos/depara/premac/","title":"PREMAC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremacService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremAc</code></p>"},{"location":"coinsurance/retornos/depara/premac/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_premac</code></li> </ul>"},{"location":"coinsurance/retornos/depara/premac/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es RecordNo SEQUENCIA CompanyCode COD_CIA Protocol NUM_PROC BaseDate DT_BASE MovementType TIPO_MOV IssuingState UF_DEP RiskStates UF_RISCO BranchCode COD_RAMO PolicyNumber NUM_APOL EndorsementNumber NUM_END InsuredQuantity QTD_SEG BorrowerDocumentId CPF_TOM BorrowersQuantity QTD_TOM IssueDate DT_EMIS EffectiveDate DT_INI_VIG EndDate DT_FIM_VIG ProposalNumber NUM_PROP ProposalDate DT_PROP InsuredDocumentId CPF_SEG IssuedPremium PR_EMIT CededCoinsurancePremium PR_COS_CED FractionalSurchargeValue AD_FRAC PolicyCostValue CUST_APOL TaxAmount IOF BrokerageCommissionAmount COMIS CoinsuranceCommissionAmount COMIS_COSS ProLaboreValue PRO_LAB StipulatorDocumentId CPF_ESTIP IsValue IS BranchGroupDescription DS_GRUPO_RAMO ProductCode CD_PRODUTO ProductDescription DS_PRODUTO BusinessUnitCode CD_BU BusinessUnitDescription DS_BU OperationCode CD_OPERACAO WalletCode CD_CARTEIRA WalletDescription DS_CARTEIRA SucursalCode CD_SUCURSAL FgGeb FG_GEB OperationDescription DCR_TIP_OPER OriginDescription DS_ORIGEM"},{"location":"coinsurance/retornos/depara/premac/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/retornos/depara/premrecac/","title":"PREMRECAC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremRecacService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremRecAc</code></p>"},{"location":"coinsurance/retornos/depara/premrecac/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_premrecac</code></li> </ul>"},{"location":"coinsurance/retornos/depara/premrecac/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es RecordNo RecordNo N\u00ba do registro no arquivo (SEQUENCIA). CompanyCode CompanyCode BaseDate BaseDate Data base (compet\u00eancia). MovementType MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). BranchCode BranchCode PolicyNumber PolicyNumber EndorsementNumber EndorsementNumber ProposalNumber ProposalNumber ProposalDate ProposalDate InstallmentNumber InstallmentNumber InstallmentQuantity InstallmentQuantity InstallmentIssueDate InstallmentIssueDate InstallmentDueDate InstallmentDueDate EffectiveDate EffectiveDate EndDate EndDate IssuedPremium IssuedPremium InstallmentPremiumIssued InstallmentPremiumIssued FractionalSurchargeValue FractionalSurchargeValue PolicyCostValue PolicyCostValue TaxAmount TaxAmount Ofer Ofer BranchGroupDescription BranchGroupDescription ProductCode ProductCode ProductDescription ProductDescription BusinessUnitCode BusinessUnitCode BusinessUnitDescription BusinessUnitDescription OperationCode OperationCode WalletCode WalletCode WalletDescription WalletDescription SucursalCode SucursalCode FgGeb FgGeb OperationDescription OperationDescription OriginDescription OriginDescription"},{"location":"coinsurance/retornos/depara/premrecac/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/retornos/depara/premrecebc/","title":"PREMRECEBC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsurancePremRecebcService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsPremRecebC</code></p>"},{"location":"coinsurance/retornos/depara/premrecebc/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_premrecebc</code></li> </ul>"},{"location":"coinsurance/retornos/depara/premrecebc/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es RecordNo RecordNo N\u00ba do registro no arquivo (SEQUENCIA). CompanyCode CompanyCode BaseDate BaseDate Data base (compet\u00eancia). MovementType MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). BranchCode BranchCode PolicyNumber PolicyNumber EndorsementNumber EndorsementNumber ProposalNumber ProposalNumber ProposalDate ProposalDate InstallmentNumber InstallmentNumber InstallmentReceiptDate InstallmentReceiptDate InstallmentDueDate InstallmentDueDate BankNumber BankNumber BankDocumentId BankDocumentId TicketNumber TicketNumber DocumentNumber DocumentNumber AgencyNumber AgencyNumber OurNumber OurNumber DocumentValue DocumentValue DiscountValue DiscountValue FineValue FineValue ChargedValue ChargedValue BranchGroupDescription BranchGroupDescription ProductCode ProductCode ProductDescription ProductDescription BusinessUnitCode BusinessUnitCode BusinessUnitDescription BusinessUnitDescription OperationCode OperationCode WalletCode WalletCode WalletDescription WalletDescription SucursalCode SucursalCode FgGeb FgGeb OperationDescription OperationDescription OriginDescription OriginDescription"},{"location":"coinsurance/retornos/depara/premrecebc/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/retornos/depara/sinpagac/","title":"SINPAGAC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceSinpagacService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsSinPagAc</code></p>"},{"location":"coinsurance/retornos/depara/sinpagac/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_sinpagac</code></li> </ul>"},{"location":"coinsurance/retornos/depara/sinpagac/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_SIN ClaimNumber NUM_APOL PolicyNumber NUM_END EndorsementNumber CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_BEN BeneficiaryDocumentId QTD_BEN BeneficiaryQuantity DT_REG RegistrationDate DT_AVISO NoticeDate DT_OCOR OccurrenceDate VR_COS_CED CededCoinsuranceValue VR_MOV MovementValue DT_MOV MovementDate TP_SIN ClaimType TIPO_REC ReceiptType NUM_BAN_SE InsurerBankNumber NUM_AGE_SE InsurerAgencyNumber NUM_CON_SE InsurerAccountNumber NUM_TRANSA TransactionNumber NUM_BAN InsuredBankNumber NUM_AGE InsuredAgencyNumber NUM_CON InsuredAccountNumber DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/retornos/depara/sinpagac/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/retornos/depara/sinpendac/","title":"SINPENDAC \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceSinpendacService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsSinPendAc</code></p>"},{"location":"coinsurance/retornos/depara/sinpendac/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_sinpendac</code></li> </ul>"},{"location":"coinsurance/retornos/depara/sinpendac/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_SIN ClaimNumber NUM_APOL PolicyNumber NUM_END EndorsementNumber CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_BEN BeneficiaryDocumentId QTD_BEN BeneficiaryQuantity DT_REG RegistrationDate DT_AVISO NoticeDate DT_OCOR OccurrenceDate VR_COS_CED CededCoinsuranceValue VR_PENDENT PendingValue VR_TOT TotalValue TP_SIN ClaimType DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/retornos/depara/sinpendac/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/sinistro/","title":"Sinistro \u2014 Vis\u00e3o geral","text":"<p>Nesta etapa, o objetivo \u00e9 registrar e acompanhar o sinistro no ciclo:</p> <ul> <li>SINAV: aviso/abertura e altera\u00e7\u00f5es do sinistro</li> <li>SINPEND: saldo pendente (posi\u00e7\u00e3o financeira do sinistro)</li> <li>SINPAG: pagamento efetivo (liquida\u00e7\u00e3o) do sinistro</li> </ul> <p>Cada arquivo entra como registros PENDING e \u00e9 processado para relacionar com ap\u00f3lice/certificado e com o sinistro existente.</p>"},{"location":"coinsurance/sinistro/sinav/","title":"SINAV \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>TODO: detalhar aviso/abertura, reavalia\u00e7\u00e3o, cancelamento, reabertura, e como isso impacta o estado do sinistro.</p>"},{"location":"coinsurance/sinistro/sinpag/","title":"SINPAG \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>SINPAG trata o pagamento efetivo do sinistro (informa\u00e7\u00f5es banc\u00e1rias, recebimento/transa\u00e7\u00e3o) e deve refletir a liquida\u00e7\u00e3o (parcial/final).</p> <p>TODO: complementar com o fluxo final de settlement quando a implementa\u00e7\u00e3o estiver conclu\u00edda.</p>"},{"location":"coinsurance/sinistro/sinpend/","title":"SINPEND \u2014 Descri\u00e7\u00e3o negocial (Coinsurance)","text":"<p>TODO: detalhar posi\u00e7\u00e3o pendente do sinistro e como cruza com sinistro/ap\u00f3lice.</p>"},{"location":"coinsurance/sinistro/depara/sinav/","title":"SINAV \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceSinAvService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsSinAv</code></p>"},{"location":"coinsurance/sinistro/depara/sinav/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_sinav</code></li> </ul>"},{"location":"coinsurance/sinistro/depara/sinav/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_SIN ClaimNumber NUM_APOL PolicyNumber NUM_END EndorsementNumber CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_BEN BeneficiaryDocumentId QTD_BEN BeneficiaryQuantity DT_REG RegistrationDate DT_AVISO NoticeDate DT_OCOR OccurrenceDate VR_COS_CED CededCoinsuranceValue VR_MOV MovementValue DT_MOV MovementDate TP_SIN ClaimType COD_PRD CodPrd IND_CPF IndCpf DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/sinistro/depara/sinav/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/sinistro/depara/sinpag/","title":"SINPAG \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceSinPagService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsSinPag</code></p>"},{"location":"coinsurance/sinistro/depara/sinpag/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_sinpag</code></li> </ul>"},{"location":"coinsurance/sinistro/depara/sinpag/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_SIN ClaimNumber NUM_APOL PolicyNumber NUM_END EndorsementNumber CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_BEN BeneficiaryDocumentId QTD_BEN BeneficiaryQuantity DT_REG RegistrationDate DT_AVISO NoticeDate DT_OCOR OccurrenceDate VR_COS_CED CededCoinsuranceValue VR_MOV MovementValue DT_MOV MovementDate TP_SIN ClaimType TIPO_REC ReceiptType NUM_BAN_SE InsurerBankNumber NUM_AGE_SE InsurerAgencyNumber NUM_CON_SE InsurerAccountNumber NUM_TRANSA TransactionNumber NUM_BAN InsuredBankNumber NUM_AGE InsuredAgencyNumber NUM_CON InsuredAccountNumber DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/sinistro/depara/sinpag/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."},{"location":"coinsurance/sinistro/depara/sinpend/","title":"SINPEND \u2014 De/Para (arquivo f\u00edsico \u2192 persist\u00eancia)","text":"<p>Service: <code>CoinsuranceSinPendService.groovy</code>  &gt; Entidade: <code>CoinsuranceRepository.CnsSinPend</code></p>"},{"location":"coinsurance/sinistro/depara/sinpend/#origem-arquivo-fisico","title":"Origem (arquivo f\u00edsico)","text":"<ul> <li>Separador CSV: <code>|</code> (pipe)</li> <li>Leitura: arquivo pendente no S3 \u2192 parse em mapa de campos</li> <li>Valida\u00e7\u00e3o Velora: <code>bmg_sinpend</code></li> </ul>"},{"location":"coinsurance/sinistro/depara/sinpend/#depara-dos-campos-csv-entidade","title":"De/Para dos campos (CSV \u2192 Entidade)","text":"Campo no arquivo (CSV) Campo persistido (Entidade) Observa\u00e7\u00f5es SEQUENCIA RecordNo N\u00ba do registro no arquivo (SEQUENCIA). COD_CIA CompanyCode DT_BASE BaseDate Data base (compet\u00eancia). TIPO_MOV MovementType Tipo de movimento (ex.: emiss\u00e3o/endosso). COD_RAMO BranchCode NUM_SIN ClaimNumber NUM_APOL PolicyNumber NUM_END EndorsementNumber CPF_SEG InsuredDocumentId QTD_SEG InsuredQuantity CPF_BEN BeneficiaryDocumentId QTD_BEN BeneficiaryQuantity DT_REG RegistrationDate DT_AVISO NoticeDate DT_OCOR OccurrenceDate VR_COS_CED CededCoinsuranceValue VR_PENDENT PendingValue VR_TOT TotalValue TP_SIN ClaimType DS_GRUPO_RAMO BranchGroupDescription CD_PRODUTO ProductCode DS_PRODUTO ProductDescription CD_BU BusinessUnitCode DS_BU BusinessUnitDescription CD_OPERACAO OperationCode CD_CARTEIRA WalletCode DS_CARTEIRA WalletDescription CD_SUCURSAL SucursalCode FG_GEB FgGeb DCR_TIP_OPER OperationDescription DS_ORIGEM OriginDescription"},{"location":"coinsurance/sinistro/depara/sinpend/#campos-tecnicos-e-derivados","title":"Campos t\u00e9cnicos e derivados","text":"Campo l\u00f3gico Campo persistido Como \u00e9 preenchido FileId FileId Derivado: <code>${etag}_${RecordNo}</code> (etag do S3 sem aspas). FileName FileName Derivado: nome do arquivo (\u00faltima parte da key no S3). Status Status Default: <code>PENDING</code> na ingest\u00e3o. Em erro, pode virar <code>ERROR</code> (h\u00e1 TODOs de update em alguns servi\u00e7os). Sequence Sequence Derivado: PK interna gerada (<code>PrimaryKeyUtils.getSequenceId()</code>) no insert."}]}